[0m21:10:06.165798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD133B390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD133B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD133B950>]}


============================== 21:10:06.172882 | a25e069a-b4d7-4ef8-b318-f2247699abe7 ==============================
[0m21:10:06.172882 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:10:06.172882 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:10:06.184965 [info ] [MainThread]: dbt version: 1.11.5
[0m21:10:06.186477 [info ] [MainThread]: python version: 3.11.0
[0m21:10:06.186477 [info ] [MainThread]: python path: C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\ingestion\venv\Scripts\python.exe
[0m21:10:06.186477 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m21:10:06.260113 [info ] [MainThread]: Using profiles dir at C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project
[0m21:10:06.263046 [info ] [MainThread]: Using profiles.yml file at C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\profiles.yml
[0m21:10:06.263046 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\dbt_project.yml
[0m21:10:06.265554 [info ] [MainThread]: adapter type: duckdb
[0m21:10:06.265554 [info ] [MainThread]: adapter version: 1.10.0
[0m21:10:06.337586 [info ] [MainThread]: Configuration:
[0m21:10:06.337586 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:10:06.337586 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:10:06.342283 [info ] [MainThread]: Required dependencies:
[0m21:10:06.342283 [debug] [MainThread]: Executing "git --help"
[0m21:10:06.444998 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:10:06.444998 [debug] [MainThread]: STDERR: "b''"
[0m21:10:06.444998 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:10:06.447823 [info ] [MainThread]: Connection:
[0m21:10:06.448428 [info ] [MainThread]:   database: olist
[0m21:10:06.449076 [info ] [MainThread]:   schema: main
[0m21:10:06.449076 [info ] [MainThread]:   path: ../ingestion/olist.db
[0m21:10:06.449076 [info ] [MainThread]:   config_options: None
[0m21:10:06.449076 [info ] [MainThread]:   extensions: None
[0m21:10:06.449076 [info ] [MainThread]:   settings: {}
[0m21:10:06.449076 [info ] [MainThread]:   external_root: .
[0m21:10:06.452873 [info ] [MainThread]:   use_credential_provider: None
[0m21:10:06.452873 [info ] [MainThread]:   attach: None
[0m21:10:06.452873 [info ] [MainThread]:   filesystems: None
[0m21:10:06.452873 [info ] [MainThread]:   remote: None
[0m21:10:06.452873 [info ] [MainThread]:   plugins: None
[0m21:10:06.452873 [info ] [MainThread]:   disable_transactions: False
[0m21:10:06.452873 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:10:06.666096 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m21:10:06.706614 [debug] [MainThread]: Using duckdb connection "debug"
[0m21:10:06.706614 [debug] [MainThread]: On debug: select 1 as id
[0m21:10:06.706614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:10:06.718036 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m21:10:06.718036 [debug] [MainThread]: On debug: Close
[0m21:10:06.718036 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:10:06.718036 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:10:06.718036 [debug] [MainThread]: Command `dbt debug` succeeded at 21:10:06.718036 after 0.62 seconds
[0m21:10:06.718036 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:10:06.718036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD2729850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FD2AD8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCA88CE50>]}
[0m21:10:06.718036 [debug] [MainThread]: Flushing usage events
[0m21:10:07.968687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:44.759743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB25F9F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB26013A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB26013990>]}


============================== 21:10:44.765637 | b50528a0-7d80-4cf1-ace4-bbf2473645c5 ==============================
[0m21:10:44.765637 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:10:44.768062 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:10:45.024527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b50528a0-7d80-4cf1-ace4-bbf2473645c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB2601C8D0>]}
[0m21:10:45.075915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b50528a0-7d80-4cf1-ace4-bbf2473645c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB25D51150>]}
[0m21:10:45.075915 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:10:45.284983 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m21:10:45.286492 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:10:45.286492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b50528a0-7d80-4cf1-ace4-bbf2473645c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB2723C7D0>]}
[0m21:10:46.197418 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_analytics.marts
[0m21:10:46.206620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b50528a0-7d80-4cf1-ace4-bbf2473645c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB25F9E990>]}
[0m21:10:46.252610 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:10:46.254767 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:10:46.271737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b50528a0-7d80-4cf1-ace4-bbf2473645c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB2795B250>]}
[0m21:10:46.271737 [info ] [MainThread]: Found 2 models, 9 sources, 472 macros
[0m21:10:46.271737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b50528a0-7d80-4cf1-ace4-bbf2473645c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB25FB39D0>]}
[0m21:10:46.271737 [info ] [MainThread]: 
[0m21:10:46.271737 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:10:46.280034 [info ] [MainThread]: 
[0m21:10:46.280786 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:10:46.285356 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m21:10:46.335287 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m21:10:46.335865 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"olist"'
    
  
  
[0m21:10:46.335865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:46.344524 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m21:10:46.344524 [debug] [ThreadPool]: On list_olist: Close
[0m21:10:46.344524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_main_staging)
[0m21:10:46.344524 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "main_staging"
"
[0m21:10:46.351954 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:10:46.351954 [debug] [ThreadPool]: On create_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='olist'
        and type='sqlite'
    
  
[0m21:10:46.351954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:46.351954 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:10:46.360030 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:10:46.360838 [debug] [ThreadPool]: On create_olist_main_staging: BEGIN
[0m21:10:46.360838 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:10:46.360838 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:10:46.360838 [debug] [ThreadPool]: On create_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_staging"} */

    
    
        create schema if not exists "olist"."main_staging"
    
[0m21:10:46.360838 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:10:46.363586 [debug] [ThreadPool]: On create_olist_main_staging: COMMIT
[0m21:10:46.363586 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:10:46.363586 [debug] [ThreadPool]: On create_olist_main_staging: COMMIT
[0m21:10:46.365601 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:10:46.365601 [debug] [ThreadPool]: On create_olist_main_staging: Close
[0m21:10:46.368219 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_staging'
[0m21:10:46.368219 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:10:46.368219 [debug] [ThreadPool]: On list_olist_main_staging: BEGIN
[0m21:10:46.368219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:46.368219 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:10:46.368219 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:10:46.368219 [debug] [ThreadPool]: On list_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'olist'
  
[0m21:10:46.383784 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:10:46.384522 [debug] [ThreadPool]: On list_olist_main_staging: ROLLBACK
[0m21:10:46.385537 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_staging'
[0m21:10:46.385537 [debug] [ThreadPool]: On list_olist_main_staging: Close
[0m21:10:46.387050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b50528a0-7d80-4cf1-ace4-bbf2473645c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB27673AD0>]}
[0m21:10:46.387050 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:46.387050 [debug] [MainThread]: On master: BEGIN
[0m21:10:46.387050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:10:46.387050 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:10:46.389119 [debug] [MainThread]: On master: COMMIT
[0m21:10:46.389119 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:46.389119 [debug] [MainThread]: On master: COMMIT
[0m21:10:46.389119 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:10:46.389119 [debug] [MainThread]: On master: Close
[0m21:10:46.395364 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m21:10:46.395364 [debug] [Thread-2 (]: Began running node model.olist_analytics.stg_orders
[0m21:10:46.395364 [info ] [Thread-1 (]: 1 of 2 START sql view model main_staging.stg_customers ......................... [RUN]
[0m21:10:46.395364 [info ] [Thread-2 (]: 2 of 2 START sql view model main_staging.stg_orders ............................ [RUN]
[0m21:10:46.400727 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_customers'
[0m21:10:46.401831 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_orders'
[0m21:10:46.401831 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m21:10:46.401831 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.stg_orders
[0m21:10:46.401831 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m21:10:46.409068 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m21:10:46.412332 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m21:10:46.412332 [debug] [Thread-2 (]: Began executing node model.olist_analytics.stg_orders
[0m21:10:46.435114 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m21:10:46.436649 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m21:10:46.436649 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:10:46.436649 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: BEGIN
[0m21:10:46.436649 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:10:46.442340 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:10:46.442340 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: BEGIN
[0m21:10:46.442953 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:10:46.442953 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:10:46.442953 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:10:46.442953 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:10:46.442953 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:10:46.442953 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */

  
  create view "olist"."main_staging"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_customers"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );

[0m21:10:46.442953 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */

  
  create view "olist"."main_staging"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as order_purchase_at,
        order_approved_at,
        order_delivered_carrier_date as order_delivered_carrier_at,
        order_delivered_customer_date as order_delivered_customer_at,
        order_estimated_delivery_date as order_estimated_delivery_at
    from source
)

select * from renamed
  );

[0m21:10:46.442953 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:10:46.450656 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:10:46.450656 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:10:46.450656 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */
alter view "olist"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:10:46.450656 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:10:46.450656 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */
alter view "olist"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:10:46.450656 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:10:46.450656 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:10:46.465715 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: COMMIT
[0m21:10:46.465715 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: COMMIT
[0m21:10:46.467462 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:10:46.467462 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:10:46.468050 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: COMMIT
[0m21:10:46.468050 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: COMMIT
[0m21:10:46.468050 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:10:46.475973 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:10:46.475973 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m21:10:46.475973 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */

      drop view if exists "olist"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m21:10:46.475973 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:10:46.475973 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */

      drop view if exists "olist"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m21:10:46.475973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:10:46.475973 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: Close
[0m21:10:46.475973 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:10:46.485559 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: Close
[0m21:10:46.485559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b50528a0-7d80-4cf1-ace4-bbf2473645c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB275DFF90>]}
[0m21:10:46.485559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b50528a0-7d80-4cf1-ace4-bbf2473645c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB27C61650>]}
[0m21:10:46.487582 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main_staging.stg_customers .................... [[32mOK[0m in 0.08s]
[0m21:10:46.487582 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main_staging.stg_orders ....................... [[32mOK[0m in 0.08s]
[0m21:10:46.487582 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m21:10:46.487582 [debug] [Thread-2 (]: Finished running node model.olist_analytics.stg_orders
[0m21:10:46.487582 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:46.492332 [debug] [MainThread]: On master: BEGIN
[0m21:10:46.492911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:10:46.492911 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:10:46.492911 [debug] [MainThread]: On master: COMMIT
[0m21:10:46.492911 [debug] [MainThread]: Using duckdb connection "master"
[0m21:10:46.492911 [debug] [MainThread]: On master: COMMIT
[0m21:10:46.492911 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:10:46.492911 [debug] [MainThread]: On master: Close
[0m21:10:46.492911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:10:46.492911 [debug] [MainThread]: Connection 'create_olist_main_staging' was properly closed.
[0m21:10:46.492911 [debug] [MainThread]: Connection 'list_olist_main_staging' was properly closed.
[0m21:10:46.492911 [debug] [MainThread]: Connection 'model.olist_analytics.stg_customers' was properly closed.
[0m21:10:46.492911 [debug] [MainThread]: Connection 'model.olist_analytics.stg_orders' was properly closed.
[0m21:10:46.492911 [info ] [MainThread]: 
[0m21:10:46.492911 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m21:10:46.492911 [debug] [MainThread]: Command end result
[0m21:10:46.514091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:10:46.515597 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:10:46.517706 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\run_results.json
[0m21:10:46.517706 [info ] [MainThread]: 
[0m21:10:46.517706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:10:46.517706 [info ] [MainThread]: 
[0m21:10:46.525152 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m21:10:46.525152 [debug] [MainThread]: Command `dbt run` succeeded at 21:10:46.525152 after 1.83 seconds
[0m21:10:46.525152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB25FADC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB25D51450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB1F56C910>]}
[0m21:10:46.525152 [debug] [MainThread]: Flushing usage events
[0m21:10:47.793449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:39.135714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026158ABF190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026158AF6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026158AF5A50>]}


============================== 21:13:39.139349 | bde37307-a6ae-4754-88d2-4eb80ea234fb ==============================
[0m21:13:39.139349 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:13:39.139349 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:13:39.292205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026158B23050>]}
[0m21:13:39.342728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026157A92F10>]}
[0m21:13:39.342728 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:13:39.519433 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m21:13:39.594414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 10 files added, 0 files changed.
[0m21:13:39.594414 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models\marts\core\dim_products.sql
[0m21:13:39.602120 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models\marts\core\fct_orders.sql
[0m21:13:39.602120 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models\staging\stg_products.sql
[0m21:13:39.602120 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models\staging\stg_order_items.sql
[0m21:13:39.603965 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models\staging\stg_order_reviews.sql
[0m21:13:39.603965 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models\staging\stg_sellers.sql
[0m21:13:39.603965 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models\staging\stg_order_payments.sql
[0m21:13:39.603965 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models\marts\core\dim_customers.sql
[0m21:13:39.603965 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models\staging\stg_geolocation.sql
[0m21:13:39.603965 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models\staging\stg_product_category_translation.sql
[0m21:13:39.799163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026159FC3150>]}
[0m21:13:39.884063 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:13:39.886738 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:13:39.898682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026159FF07D0>]}
[0m21:13:39.898682 [info ] [MainThread]: Found 12 models, 9 sources, 472 macros
[0m21:13:39.898682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615A0A9110>]}
[0m21:13:39.903747 [info ] [MainThread]: 
[0m21:13:39.903747 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:13:39.903747 [info ] [MainThread]: 
[0m21:13:39.903747 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:13:39.909243 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m21:13:39.915644 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m21:13:39.956620 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m21:13:39.956620 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m21:13:39.956620 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"olist"'
    
  
  
[0m21:13:39.956620 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"olist"'
    
  
  
[0m21:13:39.959301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:39.959731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:39.972494 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:13:39.972494 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:13:39.972494 [debug] [ThreadPool]: On list_olist: Close
[0m21:13:39.972494 [debug] [ThreadPool]: On list_olist: Close
[0m21:13:39.976469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_main_staging)
[0m21:13:39.977336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_main_marts)
[0m21:13:39.977862 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "main_staging"
"
[0m21:13:39.978427 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "main_marts"
"
[0m21:13:39.980578 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:13:39.984001 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:13:39.984001 [debug] [ThreadPool]: On create_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='olist'
        and type='sqlite'
    
  
[0m21:13:39.984001 [debug] [ThreadPool]: On create_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='olist'
        and type='sqlite'
    
  
[0m21:13:39.984001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:39.986557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:39.986557 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:13:39.989437 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:13:39.989437 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:13:39.989437 [debug] [ThreadPool]: On create_olist_main_staging: BEGIN
[0m21:13:39.989437 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:13:39.989437 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:39.989437 [debug] [ThreadPool]: On create_olist_main_marts: BEGIN
[0m21:13:39.989437 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:13:39.989437 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:39.989437 [debug] [ThreadPool]: On create_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_staging"} */

    
    
        create schema if not exists "olist"."main_staging"
    
[0m21:13:39.989437 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:13:39.989437 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:39.989437 [debug] [ThreadPool]: On create_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_marts"} */

    
    
        create schema if not exists "olist"."main_marts"
    
[0m21:13:39.989437 [debug] [ThreadPool]: On create_olist_main_staging: COMMIT
[0m21:13:39.996679 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:39.997337 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:13:39.998004 [debug] [ThreadPool]: On create_olist_main_marts: COMMIT
[0m21:13:39.998004 [debug] [ThreadPool]: On create_olist_main_staging: COMMIT
[0m21:13:39.998004 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:13:39.998004 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:39.998004 [debug] [ThreadPool]: On create_olist_main_marts: COMMIT
[0m21:13:39.998004 [debug] [ThreadPool]: On create_olist_main_staging: Close
[0m21:13:39.998004 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:13:39.998004 [debug] [ThreadPool]: On create_olist_main_marts: Close
[0m21:13:40.005128 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_staging'
[0m21:13:40.005128 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_marts'
[0m21:13:40.009872 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:13:40.013402 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:13:40.013402 [debug] [ThreadPool]: On list_olist_main_staging: BEGIN
[0m21:13:40.013402 [debug] [ThreadPool]: On list_olist_main_marts: BEGIN
[0m21:13:40.013402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:40.013402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:40.015412 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:13:40.015412 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:13:40.015412 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:13:40.017421 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:13:40.017421 [debug] [ThreadPool]: On list_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_marts"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'olist'
  
[0m21:13:40.017421 [debug] [ThreadPool]: On list_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'olist'
  
[0m21:13:40.034108 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:13:40.034108 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:13:40.034108 [debug] [ThreadPool]: On list_olist_main_staging: ROLLBACK
[0m21:13:40.037681 [debug] [ThreadPool]: On list_olist_main_marts: ROLLBACK
[0m21:13:40.038276 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_staging'
[0m21:13:40.038276 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_marts'
[0m21:13:40.038276 [debug] [ThreadPool]: On list_olist_main_staging: Close
[0m21:13:40.038276 [debug] [ThreadPool]: On list_olist_main_marts: Close
[0m21:13:40.038276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026159F9E450>]}
[0m21:13:40.042167 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:40.042167 [debug] [MainThread]: On master: BEGIN
[0m21:13:40.042167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:40.042167 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:13:40.045050 [debug] [MainThread]: On master: COMMIT
[0m21:13:40.045050 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:40.045050 [debug] [MainThread]: On master: COMMIT
[0m21:13:40.046063 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:13:40.046063 [debug] [MainThread]: On master: Close
[0m21:13:40.049932 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m21:13:40.054126 [debug] [Thread-2 (]: Began running node model.olist_analytics.stg_geolocation
[0m21:13:40.054126 [debug] [Thread-3 (]: Began running node model.olist_analytics.stg_order_items
[0m21:13:40.054126 [debug] [Thread-4 (]: Began running node model.olist_analytics.stg_order_payments
[0m21:13:40.054126 [info ] [Thread-1 (]: 1 of 12 START sql view model main_staging.stg_customers ........................ [RUN]
[0m21:13:40.054126 [info ] [Thread-2 (]: 2 of 12 START sql view model main_staging.stg_geolocation ...................... [RUN]
[0m21:13:40.054126 [info ] [Thread-3 (]: 3 of 12 START sql view model main_staging.stg_order_items ...................... [RUN]
[0m21:13:40.054126 [info ] [Thread-4 (]: 4 of 12 START sql view model main_staging.stg_order_payments ................... [RUN]
[0m21:13:40.054126 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_customers'
[0m21:13:40.059247 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_geolocation'
[0m21:13:40.059854 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_order_items'
[0m21:13:40.059854 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_order_payments'
[0m21:13:40.059854 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m21:13:40.059854 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m21:13:40.059854 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.stg_order_items
[0m21:13:40.062420 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m21:13:40.067246 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m21:13:40.069259 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m21:13:40.070943 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m21:13:40.070943 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m21:13:40.070943 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m21:13:40.070943 [debug] [Thread-2 (]: Began executing node model.olist_analytics.stg_geolocation
[0m21:13:40.095366 [debug] [Thread-3 (]: Began executing node model.olist_analytics.stg_order_items
[0m21:13:40.096066 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m21:13:40.096066 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m21:13:40.096066 [debug] [Thread-4 (]: Began executing node model.olist_analytics.stg_order_payments
[0m21:13:40.103595 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m21:13:40.103595 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:13:40.109207 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m21:13:40.109819 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:13:40.109819 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: BEGIN
[0m21:13:40.109819 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:13:40.112341 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:13:40.112341 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: BEGIN
[0m21:13:40.112341 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:13:40.112341 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: BEGIN
[0m21:13:40.112341 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: BEGIN
[0m21:13:40.115383 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:13:40.115383 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:13:40.115383 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:13:40.117398 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:13:40.117398 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:13:40.117398 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:13:40.119410 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:13:40.119968 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */

  
  create view "olist"."main_staging"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_customers"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );

[0m21:13:40.120658 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:13:40.120658 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:13:40.120658 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:13:40.120658 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:13:40.120658 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */

  
  create view "olist"."main_staging"."stg_geolocation__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_geolocation"
),

renamed as (
    select
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed
  );

[0m21:13:40.120658 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.120658 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */

  
  create view "olist"."main_staging"."stg_order_items__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_items"
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_limit_at,
        price,
        freight_value
    from source
)

select * from renamed
  );

[0m21:13:40.120658 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */

  
  create view "olist"."main_staging"."stg_order_payments__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_payments"
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed
  );

[0m21:13:40.131352 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:13:40.131891 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m21:13:40.131891 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.131891 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */
alter view "olist"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:13:40.133942 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.136547 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:13:40.136547 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:13:40.144443 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:13:40.144443 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:13:40.145115 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */
alter view "olist"."main_staging"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m21:13:40.145115 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */
alter view "olist"."main_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m21:13:40.145115 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */
alter view "olist"."main_staging"."stg_order_payments__dbt_tmp" rename to "stg_order_payments"
[0m21:13:40.148555 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.148555 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.148555 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:13:40.148555 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.159207 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: COMMIT
[0m21:13:40.161015 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: COMMIT
[0m21:13:40.161015 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */
alter view "olist"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:13:40.161015 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: COMMIT
[0m21:13:40.161015 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:13:40.161015 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:13:40.165523 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:13:40.166054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.166054 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: COMMIT
[0m21:13:40.167223 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: COMMIT
[0m21:13:40.167735 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: COMMIT
[0m21:13:40.171575 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: COMMIT
[0m21:13:40.172084 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:13:40.173593 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:13:40.173593 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:13:40.173593 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:13:40.173593 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: COMMIT
[0m21:13:40.179738 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:13:40.183853 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:13:40.183853 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:13:40.186684 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */

      drop view if exists "olist"."main_staging"."stg_order_items__dbt_backup" cascade
    
[0m21:13:40.187190 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */

      drop view if exists "olist"."main_staging"."stg_geolocation__dbt_backup" cascade
    
[0m21:13:40.187190 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */

      drop view if exists "olist"."main_staging"."stg_order_payments__dbt_backup" cascade
    
[0m21:13:40.187190 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:13:40.187190 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.187190 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:13:40.187190 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:13:40.187190 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:13:40.194643 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: Close
[0m21:13:40.194643 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: Close
[0m21:13:40.196760 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: Close
[0m21:13:40.196760 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */

      drop view if exists "olist"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m21:13:40.196760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615A234C90>]}
[0m21:13:40.196760 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615A70B490>]}
[0m21:13:40.196760 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615A6F68D0>]}
[0m21:13:40.201911 [info ] [Thread-3 (]: 3 of 12 OK created sql view model main_staging.stg_order_items ................. [[32mOK[0m in 0.14s]
[0m21:13:40.204926 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:13:40.204003 [info ] [Thread-2 (]: 2 of 12 OK created sql view model main_staging.stg_geolocation ................. [[32mOK[0m in 0.14s]
[0m21:13:40.204926 [info ] [Thread-4 (]: 4 of 12 OK created sql view model main_staging.stg_order_payments .............. [[32mOK[0m in 0.14s]
[0m21:13:40.204926 [debug] [Thread-3 (]: Finished running node model.olist_analytics.stg_order_items
[0m21:13:40.204926 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: Close
[0m21:13:40.209310 [debug] [Thread-2 (]: Finished running node model.olist_analytics.stg_geolocation
[0m21:13:40.209310 [debug] [Thread-4 (]: Finished running node model.olist_analytics.stg_order_payments
[0m21:13:40.209310 [debug] [Thread-3 (]: Began running node model.olist_analytics.stg_order_reviews
[0m21:13:40.211058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261560A1E50>]}
[0m21:13:40.211590 [debug] [Thread-2 (]: Began running node model.olist_analytics.stg_orders
[0m21:13:40.211590 [debug] [Thread-4 (]: Began running node model.olist_analytics.stg_product_category_translation
[0m21:13:40.212603 [info ] [Thread-3 (]: 5 of 12 START sql view model main_staging.stg_order_reviews .................... [RUN]
[0m21:13:40.212603 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.16s]
[0m21:13:40.212603 [info ] [Thread-2 (]: 6 of 12 START sql view model main_staging.stg_orders ........................... [RUN]
[0m21:13:40.215407 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_reviews)
[0m21:13:40.212603 [info ] [Thread-4 (]: 7 of 12 START sql view model main_staging.stg_product_category_translation ..... [RUN]
[0m21:13:40.215407 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m21:13:40.215407 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_orders)
[0m21:13:40.215407 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m21:13:40.215407 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_product_category_translation)
[0m21:13:40.215407 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m21:13:40.215407 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.stg_orders
[0m21:13:40.220638 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m21:13:40.220638 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.stg_product_category_translation
[0m21:13:40.220638 [info ] [Thread-1 (]: 8 of 12 START sql view model main_staging.stg_products ......................... [RUN]
[0m21:13:40.227173 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m21:13:40.230711 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_translation"
[0m21:13:40.230711 [debug] [Thread-3 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m21:13:40.230711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_products)
[0m21:13:40.230711 [debug] [Thread-2 (]: Began executing node model.olist_analytics.stg_orders
[0m21:13:40.234025 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m21:13:40.234025 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m21:13:40.235716 [debug] [Thread-4 (]: Began executing node model.olist_analytics.stg_product_category_translation
[0m21:13:40.237331 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m21:13:40.237331 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m21:13:40.244046 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_translation"
[0m21:13:40.244046 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:13:40.246668 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:13:40.246668 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_reviews: BEGIN
[0m21:13:40.246668 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m21:13:40.246668 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: BEGIN
[0m21:13:40.246668 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:13:40.246668 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:40.252157 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m21:13:40.252157 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:40.252157 [debug] [Thread-4 (]: On model.olist_analytics.stg_product_category_translation: BEGIN
[0m21:13:40.253927 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:13:40.253927 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:13:40.253927 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:13:40.253927 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:40.253927 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:13:40.253927 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: BEGIN
[0m21:13:40.253927 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:13:40.259119 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */

  
  create view "olist"."main_staging"."stg_order_reviews__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_reviews"
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        review_creation_date as review_created_at,
        review_answer_timestamp as review_answered_at
    from source
)

select * from renamed
  );

[0m21:13:40.259119 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:13:40.259119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:40.259119 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */

  
  create view "olist"."main_staging"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as order_purchase_at,
        order_approved_at,
        order_delivered_carrier_date as order_delivered_carrier_at,
        order_delivered_customer_date as order_delivered_customer_at,
        order_estimated_delivery_date as order_estimated_delivery_at
    from source
)

select * from renamed
  );

[0m21:13:40.260666 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:13:40.260666 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.260666 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:13:40.260666 [debug] [Thread-4 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */

  
  create view "olist"."main_staging"."stg_product_category_translation__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_product_category_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );

[0m21:13:40.260666 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:13:40.265951 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:13:40.265951 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:13:40.268781 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:13:40.268781 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:13:40.268781 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */
alter view "olist"."main_staging"."stg_order_reviews__dbt_tmp" rename to "stg_order_reviews"
[0m21:13:40.268781 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */

  
  create view "olist"."main_staging"."stg_products__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_products"
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as product_name_length,
        product_description_lenght as product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from source
)

select * from renamed
  );

[0m21:13:40.270757 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */
alter view "olist"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:13:40.271409 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:13:40.271409 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.271409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.271409 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.277015 [debug] [Thread-4 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */
alter view "olist"."main_staging"."stg_product_category_translation__dbt_tmp" rename to "stg_product_category_translation"
[0m21:13:40.277015 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_reviews: COMMIT
[0m21:13:40.277015 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:13:40.277015 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:13:40.277015 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:13:40.284139 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.284139 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */
alter view "olist"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:13:40.284764 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */
alter view "olist"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:13:40.284764 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_reviews: COMMIT
[0m21:13:40.286778 [debug] [Thread-4 (]: On model.olist_analytics.stg_product_category_translation: COMMIT
[0m21:13:40.288232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.288232 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.288232 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.288232 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:13:40.291750 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: COMMIT
[0m21:13:40.291750 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: COMMIT
[0m21:13:40.294396 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:13:40.294396 [debug] [Thread-4 (]: On model.olist_analytics.stg_product_category_translation: COMMIT
[0m21:13:40.294396 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:13:40.294396 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:13:40.294396 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */

      drop view if exists "olist"."main_staging"."stg_order_reviews__dbt_backup" cascade
    
[0m21:13:40.294396 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: COMMIT
[0m21:13:40.294396 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: COMMIT
[0m21:13:40.294396 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.294396 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:13:40.294396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.301521 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:13:40.301521 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:13:40.301521 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_reviews: Close
[0m21:13:40.301521 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:13:40.301521 [debug] [Thread-4 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */

      drop view if exists "olist"."main_staging"."stg_product_category_translation__dbt_backup" cascade
    
[0m21:13:40.301521 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:13:40.309859 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615A78D010>]}
[0m21:13:40.309859 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */

      drop view if exists "olist"."main_staging"."stg_products__dbt_backup" cascade
    
[0m21:13:40.309859 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */

      drop view if exists "olist"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m21:13:40.309859 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.309859 [info ] [Thread-3 (]: 5 of 12 OK created sql view model main_staging.stg_order_reviews ............... [[32mOK[0m in 0.10s]
[0m21:13:40.312935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:13:40.312935 [debug] [Thread-4 (]: On model.olist_analytics.stg_product_category_translation: Close
[0m21:13:40.312935 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:13:40.312935 [debug] [Thread-3 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m21:13:40.315323 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: Close
[0m21:13:40.315323 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615A5A58D0>]}
[0m21:13:40.318047 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: Close
[0m21:13:40.318047 [debug] [Thread-3 (]: Began running node model.olist_analytics.stg_sellers
[0m21:13:40.318047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026159FF3950>]}
[0m21:13:40.320559 [info ] [Thread-4 (]: 7 of 12 OK created sql view model main_staging.stg_product_category_translation  [[32mOK[0m in 0.10s]
[0m21:13:40.320559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615A75E550>]}
[0m21:13:40.320559 [info ] [Thread-3 (]: 9 of 12 START sql view model main_staging.stg_sellers .......................... [RUN]
[0m21:13:40.320559 [debug] [Thread-4 (]: Finished running node model.olist_analytics.stg_product_category_translation
[0m21:13:40.320559 [info ] [Thread-1 (]: 8 of 12 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.09s]
[0m21:13:40.325803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_sellers)
[0m21:13:40.320559 [info ] [Thread-2 (]: 6 of 12 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.11s]
[0m21:13:40.325803 [debug] [Thread-4 (]: Began running node model.olist_analytics.dim_customers
[0m21:13:40.325803 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m21:13:40.325803 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.stg_sellers
[0m21:13:40.325803 [debug] [Thread-2 (]: Finished running node model.olist_analytics.stg_orders
[0m21:13:40.325803 [info ] [Thread-4 (]: 10 of 12 START sql table model main_marts.dim_customers ........................ [RUN]
[0m21:13:40.329667 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_products
[0m21:13:40.332835 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m21:13:40.333533 [debug] [Thread-2 (]: Began running node model.olist_analytics.fct_orders
[0m21:13:40.334047 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_translation, now model.olist_analytics.dim_customers)
[0m21:13:40.334047 [info ] [Thread-1 (]: 11 of 12 START sql table model main_marts.dim_products ......................... [RUN]
[0m21:13:40.334047 [info ] [Thread-2 (]: 12 of 12 START sql table model main_marts.fct_orders ........................... [RUN]
[0m21:13:40.334047 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.dim_customers
[0m21:13:40.336645 [debug] [Thread-3 (]: Began executing node model.olist_analytics.stg_sellers
[0m21:13:40.336645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.dim_products)
[0m21:13:40.336645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.fct_orders)
[0m21:13:40.336645 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m21:13:40.342880 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m21:13:40.342880 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_products
[0m21:13:40.342880 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.fct_orders
[0m21:13:40.349342 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m21:13:40.353971 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m21:13:40.353971 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:13:40.353971 [debug] [Thread-4 (]: Began executing node model.olist_analytics.dim_customers
[0m21:13:40.353971 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: BEGIN
[0m21:13:40.353971 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_products
[0m21:13:40.370621 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m21:13:40.370621 [debug] [Thread-2 (]: Began executing node model.olist_analytics.fct_orders
[0m21:13:40.375227 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:13:40.375227 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m21:13:40.375227 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m21:13:40.375227 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m21:13:40.375227 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:13:40.375227 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:13:40.383246 [debug] [Thread-4 (]: On model.olist_analytics.dim_customers: BEGIN
[0m21:13:40.383246 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:13:40.384254 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */

  
  create view "olist"."main_staging"."stg_sellers__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_sellers"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed
  );

[0m21:13:40.384254 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:13:40.384254 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:13:40.384254 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: BEGIN
[0m21:13:40.384254 [debug] [Thread-2 (]: On model.olist_analytics.fct_orders: BEGIN
[0m21:13:40.384254 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.387169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:40.387169 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:13:40.387169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:13:40.387169 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:13:40.391465 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:13:40.392032 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:13:40.392544 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */
alter view "olist"."main_staging"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m21:13:40.393312 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:13:40.393312 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:13:40.393312 [debug] [Thread-4 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    
    

    create  table
      "olist"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      with customers as (
    select * from "olist"."main_staging"."stg_customers"
),

geolocation as (
    select * from "olist"."main_staging"."stg_geolocation"
),

-- We might want to join exact location data later, but for now 
-- a simple dimension table from staging is a good start.
final as (
    select
        customer_id,
        customer_unique_id,
        zip_code,
        city,
        state
    from customers
)

select * from final
    );
  
  
[0m21:13:40.393312 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:13:40.395472 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.395979 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    
    

    create  table
      "olist"."main_marts"."dim_products__dbt_tmp"
  
    as (
      with products as (
    select * from "olist"."main_staging"."stg_products"
),

category_translation as (
    select * from "olist"."main_staging"."stg_product_category_translation"
),

final as (
    select
        p.product_id,
        p.product_category_name,
        t.product_category_name_english,
        
        -- Coalesce english name if available, otherwise fallback to original
        coalesce(t.product_category_name_english, p.product_category_name) as category_name,
        
        p.product_name_length,
        p.product_description_length,
        p.product_photos_qty,
        p.product_weight_g,
        p.product_length_cm,
        p.product_height_cm,
        p.product_width_cm
    from products p
    left join category_translation t 
        on p.product_category_name = t.product_category_name
)

select * from final
    );
  
  
[0m21:13:40.395979 [debug] [Thread-2 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    
    

    create  table
      "olist"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      with orders as (
    select * from "olist"."main_staging"."stg_orders"
),

order_items as (
    select * from "olist"."main_staging"."stg_order_items"
),

order_payments as (
    select * from "olist"."main_staging"."stg_order_payments"
),

-- Aggregating items per order
order_items_agg as (
    select
        order_id,
        count(order_item_id) as total_items,
        sum(price) as total_item_value,
        sum(freight_value) as total_freight_value
    from order_items
    group by 1
),

-- Aggregating payments per order
order_payments_agg as (
    select
        order_id,
        sum(payment_value) as total_payment_value,
        string_agg(distinct payment_type, ', ') as payment_types
    from order_payments
    group by 1
),

final as (
    select
        o.order_id,
        o.customer_id,
        o.order_status,
        o.order_purchase_at,
        o.order_approved_at,
        o.order_delivered_carrier_at,
        o.order_delivered_customer_at,
        o.order_estimated_delivery_at,
        
        -- Metrics from items
        coalesce(i.total_items, 0) as number_of_items,
        coalesce(i.total_item_value, 0) as item_value,
        coalesce(i.total_freight_value, 0) as freight_value,
        
        -- Metrics from payments
        coalesce(p.total_payment_value, 0) as total_amount,
        p.payment_types,
        
        -- Calculated fields
        (o.order_delivered_customer_at - o.order_purchase_at) as delivery_time_interval,
        case 
            when o.order_delivered_customer_at > o.order_estimated_delivery_at then true 
            else false 
        end as is_delayed
        
    from orders o
    left join order_items_agg i on o.order_id = i.order_id
    left join order_payments_agg p on o.order_id = p.order_id
)

select * from final
    );
  
  
[0m21:13:40.395979 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: COMMIT
[0m21:13:40.399561 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:13:40.399561 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: COMMIT
[0m21:13:40.399561 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.404388 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:13:40.404388 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */

      drop view if exists "olist"."main_staging"."stg_sellers__dbt_backup" cascade
    
[0m21:13:40.404388 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:13:40.408995 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: Close
[0m21:13:40.408995 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615A1C8CD0>]}
[0m21:13:40.408995 [info ] [Thread-3 (]: 9 of 12 OK created sql view model main_staging.stg_sellers ..................... [[32mOK[0m in 0.09s]
[0m21:13:40.413113 [debug] [Thread-3 (]: Finished running node model.olist_analytics.stg_sellers
[0m21:13:40.428035 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m21:13:40.433426 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:13:40.433931 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */
alter table "olist"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m21:13:40.433931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.449723 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: COMMIT
[0m21:13:40.451847 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:13:40.451847 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: COMMIT
[0m21:13:40.465582 [debug] [Thread-4 (]: SQL status: OK in 0.069 seconds
[0m21:13:40.470281 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:13:40.470281 [debug] [Thread-4 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */
alter table "olist"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m21:13:40.473287 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:13:40.474168 [debug] [Thread-4 (]: On model.olist_analytics.dim_customers: COMMIT
[0m21:13:40.474168 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:13:40.474168 [debug] [Thread-4 (]: On model.olist_analytics.dim_customers: COMMIT
[0m21:13:40.488537 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m21:13:40.491337 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:13:40.491337 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

      drop table if exists "olist"."main_marts"."dim_products__dbt_backup" cascade
    
[0m21:13:40.491337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:13:40.491337 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: Close
[0m21:13:40.491337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615B822710>]}
[0m21:13:40.491337 [info ] [Thread-1 (]: 11 of 12 OK created sql table model main_marts.dim_products .................... [[32mOK[0m in 0.15s]
[0m21:13:40.496764 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_products
[0m21:13:40.509632 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m21:13:40.515261 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:13:40.515261 [debug] [Thread-4 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

      drop table if exists "olist"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m21:13:40.515261 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:13:40.518794 [debug] [Thread-4 (]: On model.olist_analytics.dim_customers: Close
[0m21:13:40.518794 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615A5ABE90>]}
[0m21:13:40.521649 [info ] [Thread-4 (]: 10 of 12 OK created sql table model main_marts.dim_customers ................... [[32mOK[0m in 0.18s]
[0m21:13:40.522397 [debug] [Thread-4 (]: Finished running node model.olist_analytics.dim_customers
[0m21:13:40.574259 [debug] [Thread-2 (]: SQL status: OK in 0.175 seconds
[0m21:13:40.574259 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:13:40.579358 [debug] [Thread-2 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */
alter table "olist"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m21:13:40.579358 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:13:40.579358 [debug] [Thread-2 (]: On model.olist_analytics.fct_orders: COMMIT
[0m21:13:40.579358 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:13:40.579358 [debug] [Thread-2 (]: On model.olist_analytics.fct_orders: COMMIT
[0m21:13:40.615140 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m21:13:40.620382 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:13:40.620382 [debug] [Thread-2 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

      drop table if exists "olist"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m21:13:40.620382 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:13:40.620382 [debug] [Thread-2 (]: On model.olist_analytics.fct_orders: Close
[0m21:13:40.620382 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde37307-a6ae-4754-88d2-4eb80ea234fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615B8006D0>]}
[0m21:13:40.620382 [info ] [Thread-2 (]: 12 of 12 OK created sql table model main_marts.fct_orders ...................... [[32mOK[0m in 0.28s]
[0m21:13:40.620382 [debug] [Thread-2 (]: Finished running node model.olist_analytics.fct_orders
[0m21:13:40.620382 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:40.620382 [debug] [MainThread]: On master: BEGIN
[0m21:13:40.628221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:40.628221 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:13:40.628221 [debug] [MainThread]: On master: COMMIT
[0m21:13:40.628221 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:40.628221 [debug] [MainThread]: On master: COMMIT
[0m21:13:40.628221 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:13:40.628221 [debug] [MainThread]: On master: Close
[0m21:13:40.628221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:40.628221 [debug] [MainThread]: Connection 'create_olist_main_marts' was properly closed.
[0m21:13:40.628221 [debug] [MainThread]: Connection 'create_olist_main_staging' was properly closed.
[0m21:13:40.628221 [debug] [MainThread]: Connection 'list_olist_main_staging' was properly closed.
[0m21:13:40.628221 [debug] [MainThread]: Connection 'list_olist_main_marts' was properly closed.
[0m21:13:40.628221 [debug] [MainThread]: Connection 'model.olist_analytics.dim_products' was properly closed.
[0m21:13:40.633975 [debug] [MainThread]: Connection 'model.olist_analytics.fct_orders' was properly closed.
[0m21:13:40.634322 [debug] [MainThread]: Connection 'model.olist_analytics.stg_sellers' was properly closed.
[0m21:13:40.634322 [debug] [MainThread]: Connection 'model.olist_analytics.dim_customers' was properly closed.
[0m21:13:40.634322 [info ] [MainThread]: 
[0m21:13:40.634322 [info ] [MainThread]: Finished running 3 table models, 9 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m21:13:40.636851 [debug] [MainThread]: Command end result
[0m21:13:40.653127 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:13:40.653127 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:13:40.661263 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\run_results.json
[0m21:13:40.661263 [info ] [MainThread]: 
[0m21:13:40.661263 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:40.661263 [info ] [MainThread]: 
[0m21:13:40.661263 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m21:13:40.661263 [debug] [MainThread]: Command `dbt run` succeeded at 21:13:40.661263 after 1.60 seconds
[0m21:13:40.661263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026158ABDC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615209CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615209C910>]}
[0m21:13:40.661263 [debug] [MainThread]: Flushing usage events
[0m21:13:45.159505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:16:15.359173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A33F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A39B9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A33EE10>]}


============================== 21:16:15.367369 | ee170539-53c1-47cb-8c1c-ad237745aef6 ==============================
[0m21:16:15.367369 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:16:15.367369 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:16:15.370099 [warn ] [MainThread]: [[33mWARNING[0m][MissingPlusPrefixDeprecation]: Deprecated functionality
Missing '+' prefix on `schema` found at `olist_analytics.marts.schema` in file
`C:\Users\E.Gagan\OneDrive\Documents\DATA
ENGINEERING\dbt_project\dbt_project.yml`. Hierarchical config values without a
'+' prefix are deprecated in dbt_project.yml.
[0m21:16:15.370099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee170539-53c1-47cb-8c1c-ad237745aef6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A372350>]}
[0m21:16:15.467496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee170539-53c1-47cb-8c1c-ad237745aef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117B4A3550>]}
[0m21:16:15.484330 [debug] [MainThread]: Set downloads directory='C:\Users\ED040~1.GAG\AppData\Local\Temp\dbt-downloads-a9ra804t'
[0m21:16:15.484330 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:16:22.641128 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:16:22.643565 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:16:22.865463 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:16:22.874752 [info ] [MainThread]: Updating lock file in file path: C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project/package-lock.yml
[0m21:16:22.874752 [debug] [MainThread]: Set downloads directory='C:\Users\ED040~1.GAG\AppData\Local\Temp\dbt-downloads-la16zn0t'
[0m21:16:22.880403 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:16:23.628536 [info ] [MainThread]: Installed from version 1.1.1
[0m21:16:23.628536 [info ] [MainThread]: Updated version available: 1.3.3
[0m21:16:23.628536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee170539-53c1-47cb-8c1c-ad237745aef6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A33E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117B4251D0>]}
[0m21:16:23.628536 [info ] [MainThread]: 
[0m21:16:23.628536 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:16:23.632846 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingPlusPrefixDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:16:23.633851 [debug] [MainThread]: Command `dbt deps` succeeded at 21:16:23.633851 after 8.34 seconds
[0m21:16:23.633851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117389C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117389CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A1D8990>]}
[0m21:16:23.633851 [debug] [MainThread]: Flushing usage events
[0m21:16:25.840672 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:17:00.587215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CD18EA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CD17EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CD17FF50>]}


============================== 21:17:00.587215 | c59e2d76-b1f6-408e-8ed6-227176111116 ==============================
[0m21:17:00.587215 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:17:00.591987 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:17:00.759931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c59e2d76-b1f6-408e-8ed6-227176111116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CD267B50>]}
[0m21:17:00.809846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c59e2d76-b1f6-408e-8ed6-227176111116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150C99A8290>]}
[0m21:17:00.811852 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:17:01.003556 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m21:17:01.059392 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m21:17:01.062149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c59e2d76-b1f6-408e-8ed6-227176111116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CC17A810>]}
[0m21:17:02.060249 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_orders' in
package 'olist_analytics' (models\marts\core\schema.yml). Arguments to generic
tests should be nested under the `arguments` property.
[0m21:17:02.065283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c59e2d76-b1f6-408e-8ed6-227176111116', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CEAB1F50>]}
[0m21:17:02.273729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c59e2d76-b1f6-408e-8ed6-227176111116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CEB37F50>]}
[0m21:17:02.383883 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:17:02.383883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:17:02.400799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c59e2d76-b1f6-408e-8ed6-227176111116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CEA1AF50>]}
[0m21:17:02.409086 [info ] [MainThread]: Found 12 models, 25 data tests, 9 sources, 586 macros
[0m21:17:02.409086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59e2d76-b1f6-408e-8ed6-227176111116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CED41CD0>]}
[0m21:17:02.412112 [info ] [MainThread]: 
[0m21:17:02.412414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:02.412414 [info ] [MainThread]: 
[0m21:17:02.412414 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:17:02.420187 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_staging'
[0m21:17:02.420525 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_marts'
[0m21:17:02.466709 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:17:02.466709 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:17:02.466709 [debug] [ThreadPool]: On list_olist_main_staging: BEGIN
[0m21:17:02.466709 [debug] [ThreadPool]: On list_olist_main_marts: BEGIN
[0m21:17:02.469965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:02.469965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:02.483519 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:17:02.484093 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:17:02.484093 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:17:02.484093 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:17:02.484093 [debug] [ThreadPool]: On list_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'olist'
  
[0m21:17:02.484093 [debug] [ThreadPool]: On list_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_marts"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'olist'
  
[0m21:17:02.491566 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:17:02.498275 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:17:02.498275 [debug] [ThreadPool]: On list_olist_main_staging: ROLLBACK
[0m21:17:02.498275 [debug] [ThreadPool]: On list_olist_main_marts: ROLLBACK
[0m21:17:02.498275 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_staging'
[0m21:17:02.498275 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_marts'
[0m21:17:02.498275 [debug] [ThreadPool]: On list_olist_main_staging: Close
[0m21:17:02.503217 [debug] [ThreadPool]: On list_olist_main_marts: Close
[0m21:17:02.503217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59e2d76-b1f6-408e-8ed6-227176111116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CEB145D0>]}
[0m21:17:02.503217 [debug] [MainThread]: Using duckdb connection "master"
[0m21:17:02.503217 [debug] [MainThread]: On master: BEGIN
[0m21:17:02.503217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:17:02.503217 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:17:02.503217 [debug] [MainThread]: On master: COMMIT
[0m21:17:02.503217 [debug] [MainThread]: Using duckdb connection "master"
[0m21:17:02.503217 [debug] [MainThread]: On master: COMMIT
[0m21:17:02.509695 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:17:02.510333 [debug] [MainThread]: On master: Close
[0m21:17:02.514393 [debug] [Thread-1 (]: Began running node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:17:02.515398 [debug] [Thread-2 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:17:02.515398 [debug] [Thread-3 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:17:02.516680 [debug] [Thread-4 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:17:02.517200 [info ] [Thread-1 (]: 1 of 25 START test accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m21:17:02.518037 [info ] [Thread-2 (]: 2 of 25 START test dbt_utils_expression_is_true_fct_orders_item_value___0 ...... [RUN]
[0m21:17:02.518037 [info ] [Thread-3 (]: 3 of 25 START test dbt_utils_expression_is_true_stg_order_items_price___0 ...... [RUN]
[0m21:17:02.518037 [info ] [Thread-4 (]: 4 of 25 START test dbt_utils_expression_is_true_stg_order_payments_payment_value___0  [RUN]
[0m21:17:02.518037 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460'
[0m21:17:02.518037 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655'
[0m21:17:02.518037 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09'
[0m21:17:02.522419 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81'
[0m21:17:02.523066 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:17:02.523066 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:17:02.523066 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:17:02.523066 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:17:02.530622 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:17:02.533898 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:17:02.539690 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:17:02.539690 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:17:02.539690 [debug] [Thread-1 (]: Began executing node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:17:02.559057 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:17:02.559361 [debug] [Thread-3 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:17:02.559361 [debug] [Thread-4 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:17:02.559361 [debug] [Thread-2 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:17:02.559361 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:17:02.565673 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:17:02.566791 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:17:02.567442 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:17:02.570667 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: BEGIN
[0m21:17:02.570667 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:17:02.570667 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:17:02.570667 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:17:02.570667 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: BEGIN
[0m21:17:02.570667 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:17:02.570667 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.570667 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: BEGIN
[0m21:17:02.570667 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:17:02.570667 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: BEGIN
[0m21:17:02.570667 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:17:02.570667 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:17:02.570667 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:17:02.570667 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:17:02.570667 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "olist"."main_staging"."stg_orders"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
      
    ) dbt_internal_test
[0m21:17:02.570667 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:17:02.570667 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:17:02.570667 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:17:02.570667 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:17:02.570667 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_staging"."stg_order_items"

where not(price >= 0)


  
  
      
    ) dbt_internal_test
[0m21:17:02.582560 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:17:02.583318 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_staging"."stg_order_payments"

where not(payment_value >= 0)


  
  
      
    ) dbt_internal_test
[0m21:17:02.584167 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_marts"."fct_orders"

where not(item_value >= 0)


  
  
      
    ) dbt_internal_test
[0m21:17:02.584167 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.584167 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:17:02.586881 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.586881 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: ROLLBACK
[0m21:17:02.590203 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:17:02.590203 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: ROLLBACK
[0m21:17:02.590203 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: ROLLBACK
[0m21:17:02.590203 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09'
[0m21:17:02.590203 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: ROLLBACK
[0m21:17:02.590203 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460'
[0m21:17:02.590203 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81'
[0m21:17:02.590203 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: Close
[0m21:17:02.590203 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655'
[0m21:17:02.590203 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: Close
[0m21:17:02.590203 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: Close
[0m21:17:02.598921 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: Close
[0m21:17:02.598337 [info ] [Thread-3 (]: 3 of 25 PASS dbt_utils_expression_is_true_stg_order_items_price___0 ............ [[32mPASS[0m in 0.08s]
[0m21:17:02.600032 [info ] [Thread-1 (]: 1 of 25 PASS accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 0.08s]
[0m21:17:02.600032 [info ] [Thread-4 (]: 4 of 25 PASS dbt_utils_expression_is_true_stg_order_payments_payment_value___0 . [[32mPASS[0m in 0.08s]
[0m21:17:02.600032 [debug] [Thread-3 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:17:02.600032 [info ] [Thread-2 (]: 2 of 25 PASS dbt_utils_expression_is_true_fct_orders_item_value___0 ............ [[32mPASS[0m in 0.08s]
[0m21:17:02.600032 [debug] [Thread-1 (]: Finished running node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:17:02.600032 [debug] [Thread-4 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:17:02.600032 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:17:02.600032 [debug] [Thread-2 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:17:02.600032 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:17:02.606583 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:17:02.607359 [info ] [Thread-3 (]: 5 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m21:17:02.607863 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:17:02.607863 [info ] [Thread-1 (]: 6 of 25 START test not_null_dim_products_product_id ............................ [RUN]
[0m21:17:02.609391 [info ] [Thread-4 (]: 7 of 25 START test not_null_fct_orders_customer_id ............................. [RUN]
[0m21:17:02.610131 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09, now test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m21:17:02.610131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460, now test.olist_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m21:17:02.610131 [info ] [Thread-2 (]: 8 of 25 START test not_null_fct_orders_order_id ................................ [RUN]
[0m21:17:02.611999 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81, now test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b)
[0m21:17:02.611999 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:17:02.611999 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:17:02.611999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655, now test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0)
[0m21:17:02.611999 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:17:02.620952 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:17:02.622963 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:17:02.622963 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:17:02.634050 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:17:02.636660 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:17:02.641479 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:17:02.642277 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:17:02.642277 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:17:02.642277 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:17:02.642277 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:17:02.642277 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:17:02.651281 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:17:02.651281 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:17:02.651281 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:17:02.651281 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m21:17:02.651281 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:17:02.651281 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:17:02.651281 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:17:02.659774 [debug] [Thread-1 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m21:17:02.659774 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:17:02.659774 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.659774 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m21:17:02.659774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:02.659774 [debug] [Thread-2 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m21:17:02.659774 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:17:02.659774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:17:02.659774 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.665561 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_marts"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.659774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:17:02.666353 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.666353 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:17:02.667595 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:17:02.667595 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:17:02.667595 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.667595 [debug] [Thread-1 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "olist"."main_marts"."dim_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.667595 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:17:02.667595 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_marts"."fct_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.667595 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m21:17:02.667595 [debug] [Thread-2 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_marts"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.667595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.667595 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.667595 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m21:17:02.667595 [debug] [Thread-1 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m21:17:02.667595 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:17:02.667595 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m21:17:02.667595 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m21:17:02.667595 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_dim_products_product_id.c8aba288d1'
[0m21:17:02.681512 [debug] [Thread-2 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m21:17:02.681512 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b'
[0m21:17:02.683449 [info ] [Thread-3 (]: 5 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.07s]
[0m21:17:02.683958 [debug] [Thread-1 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: Close
[0m21:17:02.686603 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0'
[0m21:17:02.686603 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m21:17:02.686603 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:17:02.686603 [debug] [Thread-2 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: Close
[0m21:17:02.686603 [info ] [Thread-1 (]: 6 of 25 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.08s]
[0m21:17:02.686603 [info ] [Thread-4 (]: 7 of 25 PASS not_null_fct_orders_customer_id ................................... [[32mPASS[0m in 0.07s]
[0m21:17:02.690307 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:17:02.691984 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:17:02.691074 [info ] [Thread-2 (]: 8 of 25 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.08s]
[0m21:17:02.691984 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:17:02.693375 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:17:02.693375 [info ] [Thread-3 (]: 9 of 25 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m21:17:02.693375 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:17:02.693375 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:17:02.693375 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:17:02.693375 [info ] [Thread-1 (]: 10 of 25 START test not_null_stg_customers_customer_unique_id .................. [RUN]
[0m21:17:02.693375 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:17:02.697569 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:17:02.697569 [info ] [Thread-4 (]: 11 of 25 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m21:17:02.698809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_dim_products_product_id.c8aba288d1, now test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba)
[0m21:17:02.698809 [info ] [Thread-2 (]: 12 of 25 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m21:17:02.704818 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:17:02.704818 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b, now test.olist_analytics.not_null_stg_order_items_order_id.2063801f96)
[0m21:17:02.704818 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:17:02.704818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0, now test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m21:17:02.704818 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:17:02.709153 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:17:02.709153 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:17:02.709153 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:17:02.715901 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:17:02.715901 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:17:02.721141 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:17:02.721141 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:17:02.721141 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:17:02.721141 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:17:02.721141 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:17:02.721141 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:17:02.721141 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:17:02.721141 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:17:02.731767 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:17:02.736958 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:17:02.736958 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m21:17:02.736958 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:17:02.736958 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:17:02.736958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:02.736958 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:17:02.736958 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.736958 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m21:17:02.736958 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:17:02.736958 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m21:17:02.736958 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:17:02.736958 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:17:02.736958 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:17:02.736958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:17:02.746021 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_staging"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.746618 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:17:02.746618 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "olist"."main_staging"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.746618 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.750031 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:17:02.746618 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.746618 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:17:02.750031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.750031 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from "olist"."main_staging"."stg_order_items"
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.753143 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:17:02.753143 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.753143 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m21:17:02.753143 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m21:17:02.753143 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.753143 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba'
[0m21:17:02.753143 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.753143 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:17:02.759207 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m21:17:02.759207 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m21:17:02.759207 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m21:17:02.761849 [info ] [Thread-3 (]: 9 of 25 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.07s]
[0m21:17:02.762442 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m21:17:02.762442 [info ] [Thread-1 (]: 10 of 25 PASS not_null_stg_customers_customer_unique_id ........................ [[32mPASS[0m in 0.06s]
[0m21:17:02.762442 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_items_order_id.2063801f96'
[0m21:17:02.762442 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:17:02.765472 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m21:17:02.765472 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:17:02.765472 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: Close
[0m21:17:02.766630 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:17:02.767529 [info ] [Thread-2 (]: 12 of 25 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.06s]
[0m21:17:02.767529 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:17:02.767529 [info ] [Thread-4 (]: 11 of 25 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.06s]
[0m21:17:02.770254 [info ] [Thread-3 (]: 13 of 25 START test not_null_stg_order_payments_order_id ....................... [RUN]
[0m21:17:02.770254 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:17:02.770254 [info ] [Thread-1 (]: 14 of 25 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m21:17:02.772771 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:17:02.772771 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7)
[0m21:17:02.772771 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:17:02.772771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba, now test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5)
[0m21:17:02.772771 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:17:02.772771 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:17:02.772771 [info ] [Thread-2 (]: 15 of 25 START test not_null_stg_orders_order_id ............................... [RUN]
[0m21:17:02.772771 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:17:02.777391 [info ] [Thread-4 (]: 16 of 25 START test not_null_stg_products_product_id ........................... [RUN]
[0m21:17:02.778707 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:17:02.778707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:17:02.784941 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:17:02.786457 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_items_order_id.2063801f96, now test.olist_analytics.not_null_stg_products_product_id.6373b0acf3)
[0m21:17:02.787201 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:17:02.788510 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:17:02.788510 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:17:02.790623 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:17:02.790623 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:17:02.795283 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:17:02.795283 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:17:02.801862 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:17:02.802867 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:17:02.802867 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:17:02.806158 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:17:02.806158 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:17:02.806158 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:17:02.806158 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:17:02.809408 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: BEGIN
[0m21:17:02.809408 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m21:17:02.809408 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:17:02.809408 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:17:02.809408 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:17:02.809408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:02.809408 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m21:17:02.809408 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:17:02.809408 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m21:17:02.815504 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:17:02.815504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:17:02.816643 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:17:02.817173 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:17:02.817173 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:17:02.817173 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.817173 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_order_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.819970 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.819970 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_staging"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.819970 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:17:02.819970 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:17:02.819970 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.819970 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.819970 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.819970 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "olist"."main_staging"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.819970 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: ROLLBACK
[0m21:17:02.819970 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m21:17:02.819970 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:17:02.819970 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7'
[0m21:17:02.819970 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5'
[0m21:17:02.819970 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.819970 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m21:17:02.819970 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: Close
[0m21:17:02.819970 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m21:17:02.832467 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m21:17:02.833857 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64'
[0m21:17:02.833857 [info ] [Thread-3 (]: 13 of 25 PASS not_null_stg_order_payments_order_id ............................. [[32mPASS[0m in 0.06s]
[0m21:17:02.833857 [info ] [Thread-1 (]: 14 of 25 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.06s]
[0m21:17:02.836112 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_stg_products_product_id.6373b0acf3'
[0m21:17:02.836625 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m21:17:02.836625 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:17:02.836625 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:17:02.838376 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: Close
[0m21:17:02.838827 [info ] [Thread-2 (]: 15 of 25 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.06s]
[0m21:17:02.839441 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:17:02.840263 [debug] [Thread-1 (]: Began running node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:17:02.840263 [info ] [Thread-4 (]: 16 of 25 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.05s]
[0m21:17:02.840263 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:17:02.840263 [info ] [Thread-3 (]: 17 of 25 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m21:17:02.840263 [info ] [Thread-1 (]: 18 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m21:17:02.840263 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:17:02.840263 [debug] [Thread-2 (]: Began running node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:17:02.840263 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7, now test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315)
[0m21:17:02.840263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5, now test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m21:17:02.846874 [debug] [Thread-4 (]: Began running node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:17:02.847404 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:17:02.847404 [info ] [Thread-2 (]: 19 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m21:17:02.848907 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:17:02.848907 [info ] [Thread-4 (]: 20 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m21:17:02.849991 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:17:02.853957 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m21:17:02.859638 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:17:02.859638 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_products_product_id.6373b0acf3, now test.olist_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m21:17:02.859638 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:17:02.859638 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:17:02.859638 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:17:02.859638 [debug] [Thread-1 (]: Began executing node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:17:02.866565 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:17:02.870077 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:17:02.876286 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:17:02.880307 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:17:02.884887 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:17:02.884887 [debug] [Thread-2 (]: Began executing node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:17:02.886898 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m21:17:02.890887 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:17:02.890887 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:17:02.890887 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:17:02.890887 [debug] [Thread-4 (]: Began executing node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:17:02.890887 [debug] [Thread-1 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m21:17:02.900005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:02.890887 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.898861 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:17:02.890887 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:17:02.900005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.900005 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:17:02.900005 [debug] [Thread-2 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m21:17:02.900005 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:17:02.900005 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:17:02.906338 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "olist"."main_staging"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.906338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:17:02.906338 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m21:17:02.906338 [debug] [Thread-1 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "olist"."main_marts"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "olist"."main_marts"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:17:02.909623 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.909623 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:17:02.909623 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:17:02.909623 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:17:02.909623 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m21:17:02.909623 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.914532 [debug] [Thread-2 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:17:02.915538 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315'
[0m21:17:02.915538 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:17:02.915538 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:17:02.915538 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m21:17:02.918834 [info ] [Thread-3 (]: 17 of 25 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.08s]
[0m21:17:02.922595 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:17:02.922595 [debug] [Thread-3 (]: Began running node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:17:02.924605 [info ] [Thread-3 (]: 21 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m21:17:02.927504 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m21:17:02.928205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315, now test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5)
[0m21:17:02.928205 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m21:17:02.931066 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:17:02.931066 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.unique_dim_products_product_id.ef7b2a9985'
[0m21:17:02.934628 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:17:02.936881 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: Close
[0m21:17:02.936881 [debug] [Thread-3 (]: Began executing node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:17:02.936881 [info ] [Thread-4 (]: 20 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.08s]
[0m21:17:02.942293 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:17:02.942293 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m21:17:02.942293 [debug] [Thread-2 (]: SQL status: OK in 0.028 seconds
[0m21:17:02.942293 [debug] [Thread-4 (]: Finished running node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:17:02.945718 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:17:02.945718 [debug] [Thread-4 (]: Began running node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:17:02.945718 [debug] [Thread-1 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m21:17:02.945718 [debug] [Thread-2 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m21:17:02.945718 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m21:17:02.950689 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4'
[0m21:17:02.945718 [info ] [Thread-4 (]: 22 of 25 START test unique_stg_customers_customer_id ........................... [RUN]
[0m21:17:02.950689 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd'
[0m21:17:02.954007 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:17:02.954007 [debug] [Thread-1 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m21:17:02.954007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_dim_products_product_id.ef7b2a9985, now test.olist_analytics.unique_stg_customers_customer_id.c7614daada)
[0m21:17:02.954007 [debug] [Thread-2 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m21:17:02.954007 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:17:02.954007 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:17:02.954007 [info ] [Thread-1 (]: 18 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.11s]
[0m21:17:02.954007 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:17:02.954007 [info ] [Thread-2 (]: 19 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.10s]
[0m21:17:02.960482 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:17:02.960482 [debug] [Thread-1 (]: Finished running node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:17:02.960482 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:17:02.960482 [debug] [Thread-2 (]: Finished running node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:17:02.965602 [debug] [Thread-1 (]: Began running node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:17:02.968049 [debug] [Thread-2 (]: Began running node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:17:02.968557 [debug] [Thread-4 (]: Began executing node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:17:02.968557 [info ] [Thread-1 (]: 23 of 25 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:17:02.970964 [info ] [Thread-2 (]: 24 of 25 START test unique_stg_products_product_id ............................. [RUN]
[0m21:17:02.974630 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:17:02.974630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.olist_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m21:17:02.974630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.olist_analytics.unique_stg_products_product_id.7d950a1467)
[0m21:17:02.974630 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:17:02.974630 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:17:02.974630 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:17:02.984314 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:17:02.986900 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:17:02.986900 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m21:17:02.986900 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:17:02.986900 [debug] [Thread-1 (]: Began executing node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:17:02.990924 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m21:17:02.992803 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:17:02.993557 [debug] [Thread-2 (]: Began executing node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:17:02.993557 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:17:02.993557 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5'
[0m21:17:02.993557 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:17:02.999734 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:17:02.999734 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: Close
[0m21:17:03.001376 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:17:03.001376 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:17:03.001376 [info ] [Thread-3 (]: 21 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.07s]
[0m21:17:03.003934 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:17:03.004616 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:17:03.004616 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m21:17:03.004616 [debug] [Thread-3 (]: Finished running node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:17:03.004616 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: BEGIN
[0m21:17:03.004616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:03.007393 [debug] [Thread-3 (]: Began running node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:17:03.007393 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:17:03.007393 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:17:03.009498 [info ] [Thread-3 (]: 25 of 25 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m21:17:03.009498 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:17:03.009498 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:17:03.011179 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5, now test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m21:17:03.011179 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:17:03.011179 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:17:03.011179 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:17:03.011179 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:17:03.015800 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:17:03.017814 [debug] [Thread-3 (]: Began executing node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:17:03.020854 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:17:03.020854 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:17:03.020854 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m21:17:03.020854 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:17:03.020854 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m21:17:03.020854 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:17:03.020854 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:17:03.020854 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.unique_stg_customers_customer_id.c7614daada'
[0m21:17:03.020854 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m21:17:03.031226 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:17:03.031226 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: Close
[0m21:17:03.033907 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m21:17:03.033907 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:17:03.037136 [info ] [Thread-4 (]: 22 of 25 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.08s]
[0m21:17:03.037696 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.unique_stg_products_product_id.7d950a1467'
[0m21:17:03.037696 [debug] [Thread-4 (]: Finished running node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:17:03.037696 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m21:17:03.037696 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: Close
[0m21:17:03.037696 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m21:17:03.037696 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:17:03.037696 [info ] [Thread-2 (]: 24 of 25 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.06s]
[0m21:17:03.037696 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.unique_stg_orders_order_id.e3b841c71a'
[0m21:17:03.046541 [debug] [Thread-2 (]: Finished running node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:17:03.046541 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m21:17:03.047679 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m21:17:03.047679 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8'
[0m21:17:03.049679 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m21:17:03.047679 [info ] [Thread-1 (]: 23 of 25 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.07s]
[0m21:17:03.049679 [info ] [Thread-3 (]: 25 of 25 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.04s]
[0m21:17:03.049679 [debug] [Thread-1 (]: Finished running node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:17:03.049679 [debug] [Thread-3 (]: Finished running node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:17:03.054182 [debug] [MainThread]: Using duckdb connection "master"
[0m21:17:03.054182 [debug] [MainThread]: On master: BEGIN
[0m21:17:03.054182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:17:03.054182 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:17:03.054182 [debug] [MainThread]: On master: COMMIT
[0m21:17:03.054182 [debug] [MainThread]: Using duckdb connection "master"
[0m21:17:03.054182 [debug] [MainThread]: On master: COMMIT
[0m21:17:03.054182 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:17:03.054182 [debug] [MainThread]: On master: Close
[0m21:17:03.054182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:03.059026 [debug] [MainThread]: Connection 'list_olist_main_staging' was properly closed.
[0m21:17:03.059026 [debug] [MainThread]: Connection 'list_olist_main_marts' was properly closed.
[0m21:17:03.059026 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m21:17:03.059026 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m21:17:03.059026 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m21:17:03.059026 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m21:17:03.059026 [info ] [MainThread]: 
[0m21:17:03.062217 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m21:17:03.062873 [debug] [MainThread]: Command end result
[0m21:17:03.090963 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:17:03.090963 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:17:03.098737 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\run_results.json
[0m21:17:03.098737 [info ] [MainThread]: 
[0m21:17:03.098737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:03.102023 [info ] [MainThread]: 
[0m21:17:03.102023 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m21:17:03.103225 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:17:03.103225 [debug] [MainThread]: Command `dbt test` succeeded at 21:17:03.103225 after 2.58 seconds
[0m21:17:03.103225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CD1C5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150CCF31550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150C671CF10>]}
[0m21:17:03.103225 [debug] [MainThread]: Flushing usage events
[0m21:17:04.287068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:23:43.903167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD1650F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD1650F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD1650F190>]}


============================== 21:23:43.906237 | b419d85a-29c1-44fd-a68f-51c147aacb86 ==============================
[0m21:23:43.906237 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:23:43.906237 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:23:44.073520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD165D5850>]}
[0m21:23:44.115375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD12D24AD0>]}
[0m21:23:44.115375 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:23:44.291244 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m21:23:44.387307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:23:44.387307 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:23:44.387307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:23:44.421751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD17B19990>]}
[0m21:23:44.486992 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:23:44.486992 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:23:44.543856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD12FAE1D0>]}
[0m21:23:44.545114 [info ] [MainThread]: Found 12 models, 25 data tests, 9 sources, 586 macros
[0m21:23:44.546119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD17B255D0>]}
[0m21:23:44.548217 [info ] [MainThread]: 
[0m21:23:44.549119 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:23:44.549119 [info ] [MainThread]: 
[0m21:23:44.550119 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:23:44.553918 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m21:23:44.562489 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m21:23:44.596869 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m21:23:44.596869 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m21:23:44.596869 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"olist"'
    
  
  
[0m21:23:44.596869 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"olist"'
    
  
  
[0m21:23:44.596869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:44.596869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:44.619563 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:23:44.619563 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m21:23:44.619563 [debug] [ThreadPool]: On list_olist: Close
[0m21:23:44.619563 [debug] [ThreadPool]: On list_olist: Close
[0m21:23:44.619563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_main_staging)
[0m21:23:44.619563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_main_marts)
[0m21:23:44.619563 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "main_staging"
"
[0m21:23:44.619563 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "main_marts"
"
[0m21:23:44.629861 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:23:44.631866 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:23:44.632766 [debug] [ThreadPool]: On create_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='olist'
        and type='sqlite'
    
  
[0m21:23:44.632766 [debug] [ThreadPool]: On create_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='olist'
        and type='sqlite'
    
  
[0m21:23:44.633275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:44.633900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:44.634920 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:23:44.634920 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:23:44.634920 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:23:44.636559 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:23:44.637597 [debug] [ThreadPool]: On create_olist_main_staging: BEGIN
[0m21:23:44.637597 [debug] [ThreadPool]: On create_olist_main_marts: BEGIN
[0m21:23:44.638577 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:44.638577 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:44.639630 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:23:44.639630 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:23:44.639630 [debug] [ThreadPool]: On create_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_staging"} */

    
    
        create schema if not exists "olist"."main_staging"
    
[0m21:23:44.640629 [debug] [ThreadPool]: On create_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_marts"} */

    
    
        create schema if not exists "olist"."main_marts"
    
[0m21:23:44.640629 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:44.641629 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:44.641629 [debug] [ThreadPool]: On create_olist_main_staging: COMMIT
[0m21:23:44.642629 [debug] [ThreadPool]: On create_olist_main_marts: COMMIT
[0m21:23:44.642629 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:23:44.643628 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:23:44.644632 [debug] [ThreadPool]: On create_olist_main_staging: COMMIT
[0m21:23:44.645246 [debug] [ThreadPool]: On create_olist_main_marts: COMMIT
[0m21:23:44.645246 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:44.646252 [debug] [ThreadPool]: On create_olist_main_staging: Close
[0m21:23:44.646252 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:23:44.646252 [debug] [ThreadPool]: On create_olist_main_marts: Close
[0m21:23:44.648277 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_staging'
[0m21:23:44.652820 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:23:44.652820 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_marts'
[0m21:23:44.653802 [debug] [ThreadPool]: On list_olist_main_staging: BEGIN
[0m21:23:44.654839 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:23:44.655828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:44.655828 [debug] [ThreadPool]: On list_olist_main_marts: BEGIN
[0m21:23:44.656804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:44.656804 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:23:44.656804 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:23:44.657804 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:23:44.657804 [debug] [ThreadPool]: On list_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'olist'
  
[0m21:23:44.657804 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:23:44.657804 [debug] [ThreadPool]: On list_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_marts"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'olist'
  
[0m21:23:44.665407 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:23:44.665407 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:23:44.665407 [debug] [ThreadPool]: On list_olist_main_staging: ROLLBACK
[0m21:23:44.665407 [debug] [ThreadPool]: On list_olist_main_marts: ROLLBACK
[0m21:23:44.665407 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_staging'
[0m21:23:44.665407 [debug] [ThreadPool]: On list_olist_main_staging: Close
[0m21:23:44.665407 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_marts'
[0m21:23:44.665407 [debug] [ThreadPool]: On list_olist_main_marts: Close
[0m21:23:44.665407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD18050AD0>]}
[0m21:23:44.665407 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:44.676795 [debug] [MainThread]: On master: BEGIN
[0m21:23:44.677506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:44.677872 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:23:44.677872 [debug] [MainThread]: On master: COMMIT
[0m21:23:44.677872 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:44.677872 [debug] [MainThread]: On master: COMMIT
[0m21:23:44.677872 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:23:44.677872 [debug] [MainThread]: On master: Close
[0m21:23:44.677872 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m21:23:44.684128 [debug] [Thread-2 (]: Began running node model.olist_analytics.stg_geolocation
[0m21:23:44.684128 [debug] [Thread-3 (]: Began running node model.olist_analytics.stg_order_items
[0m21:23:44.684128 [debug] [Thread-4 (]: Began running node model.olist_analytics.stg_order_payments
[0m21:23:44.685602 [info ] [Thread-1 (]: 1 of 12 START sql view model main_staging.stg_customers ........................ [RUN]
[0m21:23:44.685602 [info ] [Thread-2 (]: 2 of 12 START sql view model main_staging.stg_geolocation ...................... [RUN]
[0m21:23:44.686606 [info ] [Thread-3 (]: 3 of 12 START sql view model main_staging.stg_order_items ...................... [RUN]
[0m21:23:44.686606 [info ] [Thread-4 (]: 4 of 12 START sql view model main_staging.stg_order_payments ................... [RUN]
[0m21:23:44.687612 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_customers'
[0m21:23:44.687612 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_geolocation'
[0m21:23:44.688612 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_order_items'
[0m21:23:44.688612 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_order_payments'
[0m21:23:44.689612 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m21:23:44.689612 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m21:23:44.689612 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.stg_order_items
[0m21:23:44.690613 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m21:23:44.694643 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m21:23:44.699938 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m21:23:44.701915 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m21:23:44.703920 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m21:23:44.703920 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m21:23:44.703920 [debug] [Thread-2 (]: Began executing node model.olist_analytics.stg_geolocation
[0m21:23:44.703920 [debug] [Thread-3 (]: Began executing node model.olist_analytics.stg_order_items
[0m21:23:44.719603 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m21:23:44.730208 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m21:23:44.730208 [debug] [Thread-4 (]: Began executing node model.olist_analytics.stg_order_payments
[0m21:23:44.734298 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m21:23:44.734298 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:23:44.734298 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:23:44.737121 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m21:23:44.737121 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: BEGIN
[0m21:23:44.737121 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:23:44.737121 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: BEGIN
[0m21:23:44.737121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:23:44.737121 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:23:44.737121 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: BEGIN
[0m21:23:44.737121 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:23:44.743853 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:23:44.745457 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: BEGIN
[0m21:23:44.745971 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:23:44.747008 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:23:44.747549 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:23:44.747549 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:23:44.747549 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.747549 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:23:44.747549 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */

  
  create view "olist"."main_staging"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_customers"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );

[0m21:23:44.747549 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:23:44.747549 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.747549 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */

  
  create view "olist"."main_staging"."stg_geolocation__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_geolocation"
),

renamed as (
    select
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed
  );

[0m21:23:44.751961 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:23:44.751961 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */

  
  create view "olist"."main_staging"."stg_order_items__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_items"
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_limit_at,
        price,
        freight_value
    from source
)

select * from renamed
  );

[0m21:23:44.751961 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:23:44.751961 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:23:44.751961 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:23:44.751961 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */

  
  create view "olist"."main_staging"."stg_order_payments__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_payments"
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed
  );

[0m21:23:44.751961 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.751961 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */
alter view "olist"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:23:44.760750 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:23:44.765649 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:23:44.765649 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:23:44.765649 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */
alter view "olist"."main_staging"."stg_geolocation" rename to "stg_geolocation__dbt_backup"
[0m21:23:44.765649 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.765649 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */
alter view "olist"."main_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m21:23:44.765649 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:23:44.765649 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:23:44.765649 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.765649 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */
alter view "olist"."main_staging"."stg_order_payments" rename to "stg_order_payments__dbt_backup"
[0m21:23:44.765649 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.765649 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */
alter view "olist"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:23:44.776062 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:23:44.779767 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:23:44.780740 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:23:44.780740 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:23:44.780740 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */
alter view "olist"."main_staging"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m21:23:44.781774 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */
alter view "olist"."main_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m21:23:44.783763 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:23:44.790937 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: COMMIT
[0m21:23:44.792622 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:23:44.792622 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.793628 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */
alter view "olist"."main_staging"."stg_order_payments__dbt_tmp" rename to "stg_order_payments"
[0m21:23:44.793628 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:23:44.795638 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: COMMIT
[0m21:23:44.797736 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: COMMIT
[0m21:23:44.797736 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: COMMIT
[0m21:23:44.798634 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.798634 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:23:44.799682 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:23:44.800633 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: COMMIT
[0m21:23:44.801633 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: COMMIT
[0m21:23:44.802900 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: COMMIT
[0m21:23:44.802900 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:23:44.802900 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:23:44.803905 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: COMMIT
[0m21:23:44.804905 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.807921 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:23:44.807921 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:23:44.812045 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:23:44.812045 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:23:44.813107 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */

      drop view if exists "olist"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m21:23:44.815105 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:23:44.815609 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */

      drop view if exists "olist"."main_staging"."stg_order_items__dbt_backup" cascade
    
[0m21:23:44.817618 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:23:44.817618 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */

      drop view if exists "olist"."main_staging"."stg_geolocation__dbt_backup" cascade
    
[0m21:23:44.818618 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */

      drop view if exists "olist"."main_staging"."stg_order_payments__dbt_backup" cascade
    
[0m21:23:44.819101 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.821738 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: Close
[0m21:23:44.821738 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:23:44.821738 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:23:44.822721 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:23:44.824748 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: Close
[0m21:23:44.824748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD17725E10>]}
[0m21:23:44.825721 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: Close
[0m21:23:44.827345 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: Close
[0m21:23:44.827958 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD1810E0D0>]}
[0m21:23:44.828998 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.14s]
[0m21:23:44.828998 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD18029590>]}
[0m21:23:44.829891 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD18014390>]}
[0m21:23:44.830249 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m21:23:44.830249 [info ] [Thread-2 (]: 2 of 12 OK created sql view model main_staging.stg_geolocation ................. [[32mOK[0m in 0.14s]
[0m21:23:44.830249 [info ] [Thread-3 (]: 3 of 12 OK created sql view model main_staging.stg_order_items ................. [[32mOK[0m in 0.14s]
[0m21:23:44.830249 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m21:23:44.830249 [info ] [Thread-4 (]: 4 of 12 OK created sql view model main_staging.stg_order_payments .............. [[32mOK[0m in 0.14s]
[0m21:23:44.830249 [debug] [Thread-2 (]: Finished running node model.olist_analytics.stg_geolocation
[0m21:23:44.834204 [debug] [Thread-3 (]: Finished running node model.olist_analytics.stg_order_items
[0m21:23:44.835311 [debug] [Thread-4 (]: Finished running node model.olist_analytics.stg_order_payments
[0m21:23:44.834783 [info ] [Thread-1 (]: 5 of 12 START sql view model main_staging.stg_order_reviews .................... [RUN]
[0m21:23:44.835311 [debug] [Thread-2 (]: Began running node model.olist_analytics.stg_orders
[0m21:23:44.835311 [debug] [Thread-3 (]: Began running node model.olist_analytics.stg_product_category_translation
[0m21:23:44.835311 [debug] [Thread-4 (]: Began running node model.olist_analytics.stg_products
[0m21:23:44.836815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_order_reviews)
[0m21:23:44.836815 [info ] [Thread-2 (]: 6 of 12 START sql view model main_staging.stg_orders ........................... [RUN]
[0m21:23:44.837822 [info ] [Thread-3 (]: 7 of 12 START sql view model main_staging.stg_product_category_translation ..... [RUN]
[0m21:23:44.837822 [info ] [Thread-4 (]: 8 of 12 START sql view model main_staging.stg_products ......................... [RUN]
[0m21:23:44.838820 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m21:23:44.838820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_orders)
[0m21:23:44.838820 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_product_category_translation)
[0m21:23:44.839820 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_products)
[0m21:23:44.840844 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m21:23:44.840844 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.stg_orders
[0m21:23:44.840844 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.stg_product_category_translation
[0m21:23:44.840844 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.stg_products
[0m21:23:44.846517 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m21:23:44.849007 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_translation"
[0m21:23:44.849577 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m21:23:44.852415 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m21:23:44.852415 [debug] [Thread-2 (]: Began executing node model.olist_analytics.stg_orders
[0m21:23:44.852415 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m21:23:44.852415 [debug] [Thread-3 (]: Began executing node model.olist_analytics.stg_product_category_translation
[0m21:23:44.852415 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m21:23:44.859272 [debug] [Thread-4 (]: Began executing node model.olist_analytics.stg_products
[0m21:23:44.862717 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_translation"
[0m21:23:44.863019 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:23:44.866633 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m21:23:44.867089 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:23:44.867089 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: BEGIN
[0m21:23:44.868022 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:23:44.868022 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: BEGIN
[0m21:23:44.868022 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:23:44.868022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:44.868022 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: BEGIN
[0m21:23:44.868022 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:44.868022 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: BEGIN
[0m21:23:44.868022 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:44.868022 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.868022 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:44.868022 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.868022 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.868022 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:23:44.868022 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:23:44.868022 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.868022 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:23:44.868022 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */

  
  create view "olist"."main_staging"."stg_order_reviews__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_reviews"
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        review_creation_date as review_created_at,
        review_answer_timestamp as review_answered_at
    from source
)

select * from renamed
  );

[0m21:23:44.868022 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */

  
  create view "olist"."main_staging"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as order_purchase_at,
        order_approved_at,
        order_delivered_carrier_date as order_delivered_carrier_at,
        order_delivered_customer_date as order_delivered_customer_at,
        order_estimated_delivery_date as order_estimated_delivery_at
    from source
)

select * from renamed
  );

[0m21:23:44.868022 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:23:44.868022 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */

  
  create view "olist"."main_staging"."stg_product_category_translation__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_product_category_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );

[0m21:23:44.868022 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:23:44.868022 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */

  
  create view "olist"."main_staging"."stg_products__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_products"
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as product_name_length,
        product_description_lenght as product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from source
)

select * from renamed
  );

[0m21:23:44.876953 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.879407 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:23:44.879407 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:23:44.879407 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:23:44.879407 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:23:44.884314 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */
alter view "olist"."main_staging"."stg_order_reviews" rename to "stg_order_reviews__dbt_backup"
[0m21:23:44.884314 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:23:44.886913 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */
alter view "olist"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:23:44.886913 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:23:44.886913 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */
alter view "olist"."main_staging"."stg_product_category_translation" rename to "stg_product_category_translation__dbt_backup"
[0m21:23:44.886913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.886913 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */
alter view "olist"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m21:23:44.886913 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.893638 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:23:44.893638 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:23:44.896232 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:23:44.896232 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:23:44.896232 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */
alter view "olist"."main_staging"."stg_order_reviews__dbt_tmp" rename to "stg_order_reviews"
[0m21:23:44.896232 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:23:44.896232 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */
alter view "olist"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:23:44.902768 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:23:44.902768 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */
alter view "olist"."main_staging"."stg_product_category_translation__dbt_tmp" rename to "stg_product_category_translation"
[0m21:23:44.902768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.902768 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */
alter view "olist"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:23:44.902768 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.902768 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: COMMIT
[0m21:23:44.902768 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.902768 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:23:44.902768 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: COMMIT
[0m21:23:44.902768 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:23:44.902768 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: COMMIT
[0m21:23:44.910797 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: COMMIT
[0m21:23:44.913164 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:23:44.914091 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: COMMIT
[0m21:23:44.914598 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:23:44.914598 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:23:44.915603 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: COMMIT
[0m21:23:44.915603 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: COMMIT
[0m21:23:44.915603 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: COMMIT
[0m21:23:44.915603 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.917085 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.919088 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:23:44.920087 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.920087 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:23:44.922105 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:23:44.922105 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */

      drop view if exists "olist"."main_staging"."stg_order_reviews__dbt_backup" cascade
    
[0m21:23:44.924089 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:23:44.925575 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:23:44.926574 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */

      drop view if exists "olist"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m21:23:44.927572 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */

      drop view if exists "olist"."main_staging"."stg_products__dbt_backup" cascade
    
[0m21:23:44.927572 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */

      drop view if exists "olist"."main_staging"."stg_product_category_translation__dbt_backup" cascade
    
[0m21:23:44.928574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.930116 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: Close
[0m21:23:44.930116 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.930116 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.931116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD1778D590>]}
[0m21:23:44.931116 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.932143 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: Close
[0m21:23:44.932143 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: Close
[0m21:23:44.933651 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main_staging.stg_order_reviews ............... [[32mOK[0m in 0.09s]
[0m21:23:44.934657 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: Close
[0m21:23:44.935334 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD17FF3210>]}
[0m21:23:44.935334 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD181CBE90>]}
[0m21:23:44.935334 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m21:23:44.937011 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD192BB750>]}
[0m21:23:44.937011 [info ] [Thread-2 (]: 6 of 12 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.10s]
[0m21:23:44.938137 [info ] [Thread-4 (]: 8 of 12 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.10s]
[0m21:23:44.939076 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m21:23:44.939076 [info ] [Thread-3 (]: 7 of 12 OK created sql view model main_staging.stg_product_category_translation  [[32mOK[0m in 0.10s]
[0m21:23:44.940148 [debug] [Thread-2 (]: Finished running node model.olist_analytics.stg_orders
[0m21:23:44.940148 [debug] [Thread-4 (]: Finished running node model.olist_analytics.stg_products
[0m21:23:44.941079 [info ] [Thread-1 (]: 9 of 12 START sql view model main_staging.stg_sellers .......................... [RUN]
[0m21:23:44.941079 [debug] [Thread-3 (]: Finished running node model.olist_analytics.stg_product_category_translation
[0m21:23:44.942053 [debug] [Thread-2 (]: Began running node model.olist_analytics.dim_customers
[0m21:23:44.942053 [debug] [Thread-4 (]: Began running node model.olist_analytics.fct_orders
[0m21:23:44.942865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_sellers)
[0m21:23:44.943227 [debug] [Thread-3 (]: Began running node model.olist_analytics.dim_products
[0m21:23:44.944440 [info ] [Thread-2 (]: 10 of 12 START sql table model main_marts.dim_customers ........................ [RUN]
[0m21:23:44.945444 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m21:23:44.944440 [info ] [Thread-4 (]: 11 of 12 START sql table model main_marts.fct_orders ........................... [RUN]
[0m21:23:44.946116 [info ] [Thread-3 (]: 12 of 12 START sql table model main_marts.dim_products ......................... [RUN]
[0m21:23:44.946116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.dim_customers)
[0m21:23:44.948758 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m21:23:44.949760 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.fct_orders)
[0m21:23:44.949760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_translation, now model.olist_analytics.dim_products)
[0m21:23:44.950824 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.dim_customers
[0m21:23:44.950824 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.fct_orders
[0m21:23:44.950824 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.dim_products
[0m21:23:44.951793 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m21:23:44.953470 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m21:23:44.953470 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m21:23:44.959431 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m21:23:44.962398 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m21:23:44.962971 [debug] [Thread-2 (]: Began executing node model.olist_analytics.dim_customers
[0m21:23:44.962971 [debug] [Thread-4 (]: Began executing node model.olist_analytics.fct_orders
[0m21:23:44.976969 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m21:23:44.980884 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m21:23:44.981794 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:23:44.981794 [debug] [Thread-3 (]: Began executing node model.olist_analytics.dim_products
[0m21:23:44.983239 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: BEGIN
[0m21:23:44.983239 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:23:44.985856 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m21:23:44.986854 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:23:44.986854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:44.986854 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: BEGIN
[0m21:23:44.987924 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: BEGIN
[0m21:23:44.987924 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:23:44.987924 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.987924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:44.987924 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:44.987924 [debug] [Thread-3 (]: On model.olist_analytics.dim_products: BEGIN
[0m21:23:44.987924 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:23:44.987924 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.987924 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.987924 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:44.987924 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */

  
  create view "olist"."main_staging"."stg_sellers__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_sellers"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed
  );

[0m21:23:44.987924 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:23:44.987924 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:23:44.993489 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:23:44.994498 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    
    

    create  table
      "olist"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      with orders as (
    select * from "olist"."main_staging"."stg_orders"
),

order_items as (
    select * from "olist"."main_staging"."stg_order_items"
),

order_payments as (
    select * from "olist"."main_staging"."stg_order_payments"
),

-- Aggregating items per order
order_items_agg as (
    select
        order_id,
        count(order_item_id) as total_items,
        sum(price) as total_item_value,
        sum(freight_value) as total_freight_value
    from order_items
    group by 1
),

-- Aggregating payments per order
order_payments_agg as (
    select
        order_id,
        sum(payment_value) as total_payment_value,
        string_agg(distinct payment_type, ', ') as payment_types
    from order_payments
    group by 1
),

final as (
    select
        o.order_id,
        o.customer_id,
        o.order_status,
        o.order_purchase_at,
        o.order_approved_at,
        o.order_delivered_carrier_at,
        o.order_delivered_customer_at,
        o.order_estimated_delivery_at,
        
        -- Metrics from items
        coalesce(i.total_items, 0) as number_of_items,
        coalesce(i.total_item_value, 0) as item_value,
        coalesce(i.total_freight_value, 0) as freight_value,
        
        -- Metrics from payments
        coalesce(p.total_payment_value, 0) as total_amount,
        p.payment_types,
        
        -- Calculated fields
        (o.order_delivered_customer_at - o.order_purchase_at) as delivery_time_interval,
        case 
            when o.order_delivered_customer_at > o.order_estimated_delivery_at then true 
            else false 
        end as is_delayed
        
    from orders o
    left join order_items_agg i on o.order_id = i.order_id
    left join order_payments_agg p on o.order_id = p.order_id
)

select * from final
    );
  
  
[0m21:23:44.995499 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:44.996210 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    
    

    create  table
      "olist"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      with customers as (
    select * from "olist"."main_staging"."stg_customers"
),

geolocation as (
    select * from "olist"."main_staging"."stg_geolocation"
),

-- We might want to join exact location data later, but for now 
-- a simple dimension table from staging is a good start.
final as (
    select
        customer_id,
        customer_unique_id,
        zip_code,
        city,
        state
    from customers
)

select * from final
    );
  
  
[0m21:23:44.996210 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:23:44.996747 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:23:44.996747 [debug] [Thread-3 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    
    

    create  table
      "olist"."main_marts"."dim_products__dbt_tmp"
  
    as (
      with products as (
    select * from "olist"."main_staging"."stg_products"
),

category_translation as (
    select * from "olist"."main_staging"."stg_product_category_translation"
),

final as (
    select
        p.product_id,
        p.product_category_name,
        t.product_category_name_english,
        
        -- Coalesce english name if available, otherwise fallback to original
        coalesce(t.product_category_name_english, p.product_category_name) as category_name,
        
        p.product_name_length,
        p.product_description_length,
        p.product_photos_qty,
        p.product_weight_g,
        p.product_length_cm,
        p.product_height_cm,
        p.product_width_cm
    from products p
    left join category_translation t 
        on p.product_category_name = t.product_category_name
)

select * from final
    );
  
  
[0m21:23:44.996747 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */
alter view "olist"."main_staging"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m21:23:44.996747 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:23:44.996747 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:23:45.007292 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */
alter view "olist"."main_staging"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m21:23:45.007292 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:45.013247 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: COMMIT
[0m21:23:45.013247 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:23:45.015257 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: COMMIT
[0m21:23:45.019189 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:23:45.019189 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:23:45.019189 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */

      drop view if exists "olist"."main_staging"."stg_sellers__dbt_backup" cascade
    
[0m21:23:45.019189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:23:45.019189 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: Close
[0m21:23:45.026888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD18019C10>]}
[0m21:23:45.027457 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main_staging.stg_sellers ..................... [[32mOK[0m in 0.08s]
[0m21:23:45.029470 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m21:23:45.030467 [debug] [Thread-3 (]: SQL status: OK in 0.029 seconds
[0m21:23:45.034984 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:23:45.036489 [debug] [Thread-3 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_products'
  
[0m21:23:45.040495 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:23:45.042505 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:23:45.044254 [debug] [Thread-3 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_products'
  
[0m21:23:45.053045 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m21:23:45.053045 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:23:45.053045 [debug] [Thread-3 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */
alter table "olist"."main_marts"."dim_products" rename to "dim_products__dbt_backup"
[0m21:23:45.053045 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:23:45.062185 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:23:45.063186 [debug] [Thread-3 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */
alter table "olist"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m21:23:45.063186 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m21:23:45.065185 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:23:45.065185 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_customers'
  
[0m21:23:45.066305 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:23:45.071311 [debug] [Thread-3 (]: On model.olist_analytics.dim_products: COMMIT
[0m21:23:45.071311 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:23:45.072312 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:23:45.073311 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:23:45.073311 [debug] [Thread-3 (]: On model.olist_analytics.dim_products: COMMIT
[0m21:23:45.074336 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_customers'
  
[0m21:23:45.077943 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:23:45.080957 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:23:45.080957 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */
alter table "olist"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m21:23:45.081939 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:23:45.084982 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:23:45.084982 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */
alter table "olist"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m21:23:45.086487 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:23:45.088497 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: COMMIT
[0m21:23:45.089496 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:23:45.089496 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m21:23:45.090065 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: COMMIT
[0m21:23:45.092060 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:23:45.094478 [debug] [Thread-3 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

      drop table if exists "olist"."main_marts"."dim_products__dbt_backup" cascade
    
[0m21:23:45.115201 [debug] [Thread-2 (]: SQL status: OK in 0.026 seconds
[0m21:23:45.115201 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m21:23:45.115201 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:23:45.115201 [debug] [Thread-3 (]: On model.olist_analytics.dim_products: Close
[0m21:23:45.115201 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

      drop table if exists "olist"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m21:23:45.115201 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD192E4310>]}
[0m21:23:45.115201 [info ] [Thread-3 (]: 12 of 12 OK created sql table model main_marts.dim_products .................... [[32mOK[0m in 0.17s]
[0m21:23:45.115201 [debug] [Thread-3 (]: Finished running node model.olist_analytics.dim_products
[0m21:23:45.126847 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:23:45.128895 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: Close
[0m21:23:45.128895 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD1819FB50>]}
[0m21:23:45.129892 [info ] [Thread-2 (]: 10 of 12 OK created sql table model main_marts.dim_customers ................... [[32mOK[0m in 0.18s]
[0m21:23:45.130465 [debug] [Thread-2 (]: Finished running node model.olist_analytics.dim_customers
[0m21:23:45.155094 [debug] [Thread-4 (]: SQL status: OK in 0.158 seconds
[0m21:23:45.156080 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:23:45.156080 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_orders'
  
[0m21:23:45.157037 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:23:45.158037 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:23:45.158037 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_orders'
  
[0m21:23:45.159035 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:23:45.162105 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:23:45.162937 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */
alter table "olist"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m21:23:45.162937 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:23:45.165544 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:23:45.166579 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */
alter table "olist"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m21:23:45.166579 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:23:45.168579 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: COMMIT
[0m21:23:45.168579 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:23:45.168579 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: COMMIT
[0m21:23:45.195987 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m21:23:45.195987 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:23:45.209440 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

      drop table if exists "olist"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m21:23:45.419069 [debug] [Thread-4 (]: SQL status: OK in 0.213 seconds
[0m21:23:45.419069 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: Close
[0m21:23:45.419069 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b419d85a-29c1-44fd-a68f-51c147aacb86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD193AFC90>]}
[0m21:23:45.419069 [info ] [Thread-4 (]: 11 of 12 OK created sql table model main_marts.fct_orders ...................... [[32mOK[0m in 0.47s]
[0m21:23:45.425931 [debug] [Thread-4 (]: Finished running node model.olist_analytics.fct_orders
[0m21:23:45.428118 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:45.428118 [debug] [MainThread]: On master: BEGIN
[0m21:23:45.428118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:23:45.430702 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:23:45.430702 [debug] [MainThread]: On master: COMMIT
[0m21:23:45.430702 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:45.432720 [debug] [MainThread]: On master: COMMIT
[0m21:23:45.434284 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:23:45.434790 [debug] [MainThread]: On master: Close
[0m21:23:45.434790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:45.434790 [debug] [MainThread]: Connection 'create_olist_main_marts' was properly closed.
[0m21:23:45.434790 [debug] [MainThread]: Connection 'create_olist_main_staging' was properly closed.
[0m21:23:45.436797 [debug] [MainThread]: Connection 'list_olist_main_staging' was properly closed.
[0m21:23:45.436797 [debug] [MainThread]: Connection 'list_olist_main_marts' was properly closed.
[0m21:23:45.436797 [debug] [MainThread]: Connection 'model.olist_analytics.stg_sellers' was properly closed.
[0m21:23:45.436797 [debug] [MainThread]: Connection 'model.olist_analytics.dim_customers' was properly closed.
[0m21:23:45.436797 [debug] [MainThread]: Connection 'model.olist_analytics.dim_products' was properly closed.
[0m21:23:45.436797 [debug] [MainThread]: Connection 'model.olist_analytics.fct_orders' was properly closed.
[0m21:23:45.436797 [info ] [MainThread]: 
[0m21:23:45.438820 [info ] [MainThread]: Finished running 3 table models, 9 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m21:23:45.440611 [debug] [MainThread]: Command end result
[0m21:23:45.463111 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:23:45.465620 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:23:45.465620 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\run_results.json
[0m21:23:45.465620 [info ] [MainThread]: 
[0m21:23:45.465620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:45.465620 [info ] [MainThread]: 
[0m21:23:45.465620 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m21:23:45.465620 [debug] [MainThread]: Command `dbt run` succeeded at 21:23:45.465620 after 1.64 seconds
[0m21:23:45.465620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD1650C390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD1650ED10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD161BEA90>]}
[0m21:23:45.465620 [debug] [MainThread]: Flushing usage events
[0m21:23:47.265685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:23:48.715721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A7FAF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A7FAECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A7FAC390>]}


============================== 21:23:48.723491 | bda22def-b365-4974-8e72-eb9f24964f82 ==============================
[0m21:23:48.723491 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:23:48.725228 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:23:48.889101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bda22def-b365-4974-8e72-eb9f24964f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A8054ED0>]}
[0m21:23:48.933120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bda22def-b365-4974-8e72-eb9f24964f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A47C4B50>]}
[0m21:23:48.934640 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:23:49.093421 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m21:23:49.193363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:23:49.193363 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:23:49.193363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:23:49.234247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bda22def-b365-4974-8e72-eb9f24964f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A8082A10>]}
[0m21:23:49.293873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:23:49.293873 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:23:49.356173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bda22def-b365-4974-8e72-eb9f24964f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A9459790>]}
[0m21:23:49.357206 [info ] [MainThread]: Found 12 models, 25 data tests, 9 sources, 586 macros
[0m21:23:49.357918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bda22def-b365-4974-8e72-eb9f24964f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A9636E90>]}
[0m21:23:49.360430 [info ] [MainThread]: 
[0m21:23:49.360430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:23:49.360430 [info ] [MainThread]: 
[0m21:23:49.360430 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:23:49.365569 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_marts'
[0m21:23:49.371910 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_staging'
[0m21:23:49.411791 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:23:49.411791 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:23:49.411791 [debug] [ThreadPool]: On list_olist_main_marts: BEGIN
[0m21:23:49.411791 [debug] [ThreadPool]: On list_olist_main_staging: BEGIN
[0m21:23:49.411791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:49.411791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:49.426658 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m21:23:49.426658 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:23:49.427664 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:23:49.427664 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:23:49.428664 [debug] [ThreadPool]: On list_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_marts"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'olist'
  
[0m21:23:49.428664 [debug] [ThreadPool]: On list_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'olist'
  
[0m21:23:49.438964 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:23:49.439964 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:23:49.440964 [debug] [ThreadPool]: On list_olist_main_staging: ROLLBACK
[0m21:23:49.442555 [debug] [ThreadPool]: On list_olist_main_marts: ROLLBACK
[0m21:23:49.443575 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_staging'
[0m21:23:49.443575 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_marts'
[0m21:23:49.444580 [debug] [ThreadPool]: On list_olist_main_staging: Close
[0m21:23:49.444580 [debug] [ThreadPool]: On list_olist_main_marts: Close
[0m21:23:49.446578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bda22def-b365-4974-8e72-eb9f24964f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A928E410>]}
[0m21:23:49.446578 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:49.447580 [debug] [MainThread]: On master: BEGIN
[0m21:23:49.447580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:49.447580 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:23:49.448579 [debug] [MainThread]: On master: COMMIT
[0m21:23:49.448579 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:49.449603 [debug] [MainThread]: On master: COMMIT
[0m21:23:49.449603 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:23:49.449603 [debug] [MainThread]: On master: Close
[0m21:23:49.452581 [debug] [Thread-1 (]: Began running node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:23:49.453581 [debug] [Thread-2 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:23:49.453581 [debug] [Thread-3 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:23:49.453581 [debug] [Thread-4 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:23:49.454579 [info ] [Thread-1 (]: 1 of 25 START test accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m21:23:49.454579 [info ] [Thread-2 (]: 2 of 25 START test dbt_utils_expression_is_true_fct_orders_item_value___0 ...... [RUN]
[0m21:23:49.455580 [info ] [Thread-3 (]: 3 of 25 START test dbt_utils_expression_is_true_stg_order_items_price___0 ...... [RUN]
[0m21:23:49.455580 [info ] [Thread-4 (]: 4 of 25 START test dbt_utils_expression_is_true_stg_order_payments_payment_value___0  [RUN]
[0m21:23:49.456580 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460'
[0m21:23:49.456580 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655'
[0m21:23:49.456580 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09'
[0m21:23:49.457580 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81'
[0m21:23:49.457580 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:23:49.459086 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:23:49.459815 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:23:49.460229 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:23:49.465234 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:23:49.478663 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:23:49.483915 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:23:49.486850 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:23:49.486850 [debug] [Thread-1 (]: Began executing node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:23:49.486850 [debug] [Thread-3 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:23:49.486850 [debug] [Thread-2 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:23:49.502153 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:23:49.502153 [debug] [Thread-4 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:23:49.506204 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:23:49.506204 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:23:49.509872 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:23:49.510881 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:23:49.511880 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:23:49.513989 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: BEGIN
[0m21:23:49.515501 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:23:49.515501 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: BEGIN
[0m21:23:49.515501 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:23:49.517513 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:23:49.517513 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: BEGIN
[0m21:23:49.519523 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:23:49.519523 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: BEGIN
[0m21:23:49.521533 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:23:49.521533 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:23:49.523541 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:23:49.523541 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:23:49.523541 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:23:49.527048 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:23:49.527753 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:23:49.529108 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:23:49.529108 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "olist"."main_staging"."stg_orders"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
      
    ) dbt_internal_test
[0m21:23:49.529108 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:23:49.529108 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:23:49.532630 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_staging"."stg_order_items"

where not(price >= 0)


  
  
      
    ) dbt_internal_test
[0m21:23:49.532630 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_staging"."stg_order_payments"

where not(payment_value >= 0)


  
  
      
    ) dbt_internal_test
[0m21:23:49.534640 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_marts"."fct_orders"

where not(item_value >= 0)


  
  
      
    ) dbt_internal_test
[0m21:23:49.536739 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.536739 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.536739 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.540763 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: ROLLBACK
[0m21:23:49.544310 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: ROLLBACK
[0m21:23:49.545826 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m21:23:49.547829 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: ROLLBACK
[0m21:23:49.548384 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09'
[0m21:23:49.549396 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81'
[0m21:23:49.550397 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: ROLLBACK
[0m21:23:49.551441 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655'
[0m21:23:49.551441 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: Close
[0m21:23:49.552393 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: Close
[0m21:23:49.552393 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460'
[0m21:23:49.553397 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: Close
[0m21:23:49.554394 [info ] [Thread-3 (]: 3 of 25 PASS dbt_utils_expression_is_true_stg_order_items_price___0 ............ [[32mPASS[0m in 0.10s]
[0m21:23:49.555392 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: Close
[0m21:23:49.554394 [info ] [Thread-4 (]: 4 of 25 PASS dbt_utils_expression_is_true_stg_order_payments_payment_value___0 . [[32mPASS[0m in 0.10s]
[0m21:23:49.555392 [info ] [Thread-2 (]: 2 of 25 PASS dbt_utils_expression_is_true_fct_orders_item_value___0 ............ [[32mPASS[0m in 0.10s]
[0m21:23:49.556391 [debug] [Thread-3 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:23:49.557394 [info ] [Thread-1 (]: 1 of 25 PASS accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 0.10s]
[0m21:23:49.558392 [debug] [Thread-4 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:23:49.560915 [debug] [Thread-2 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:23:49.561528 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:23:49.562541 [debug] [Thread-1 (]: Finished running node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:23:49.563540 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:23:49.564576 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:23:49.564576 [info ] [Thread-3 (]: 5 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m21:23:49.566081 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:23:49.566669 [info ] [Thread-4 (]: 6 of 25 START test not_null_dim_products_product_id ............................ [RUN]
[0m21:23:49.566669 [info ] [Thread-2 (]: 7 of 25 START test not_null_fct_orders_customer_id ............................. [RUN]
[0m21:23:49.566669 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09, now test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m21:23:49.567709 [info ] [Thread-1 (]: 8 of 25 START test not_null_fct_orders_order_id ................................ [RUN]
[0m21:23:49.567709 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81, now test.olist_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m21:23:49.568712 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655, now test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b)
[0m21:23:49.568712 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:23:49.569758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460, now test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0)
[0m21:23:49.569758 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:23:49.569758 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:23:49.575339 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:23:49.575965 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:23:49.579032 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:23:49.582033 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:23:49.585593 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:23:49.586574 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:23:49.587083 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:23:49.587083 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:23:49.589113 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:23:49.592655 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:23:49.593724 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:23:49.595463 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:23:49.595463 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:23:49.595463 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:23:49.595463 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:23:49.595463 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:23:49.595463 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m21:23:49.595463 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:23:49.595463 [debug] [Thread-4 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m21:23:49.595463 [debug] [Thread-2 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m21:23:49.595463 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:49.595463 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m21:23:49.595463 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:49.595463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:49.595463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:49.595463 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.595463 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.595463 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.595463 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.595463 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:23:49.595463 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:23:49.595463 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:23:49.595463 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:23:49.595463 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_marts"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.595463 [debug] [Thread-4 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "olist"."main_marts"."dim_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.595463 [debug] [Thread-2 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_marts"."fct_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.595463 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_marts"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.610340 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.610340 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.610340 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.610340 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m21:23:49.610340 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.610340 [debug] [Thread-4 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m21:23:49.615287 [debug] [Thread-2 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m21:23:49.615287 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m21:23:49.615287 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m21:23:49.615287 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_dim_products_product_id.c8aba288d1'
[0m21:23:49.615287 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b'
[0m21:23:49.615287 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m21:23:49.615287 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0'
[0m21:23:49.615287 [debug] [Thread-4 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: Close
[0m21:23:49.615287 [debug] [Thread-2 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m21:23:49.615287 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: Close
[0m21:23:49.615287 [info ] [Thread-3 (]: 5 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.05s]
[0m21:23:49.615287 [info ] [Thread-4 (]: 6 of 25 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.05s]
[0m21:23:49.615287 [info ] [Thread-2 (]: 7 of 25 PASS not_null_fct_orders_customer_id ................................... [[32mPASS[0m in 0.05s]
[0m21:23:49.615287 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:23:49.615287 [info ] [Thread-1 (]: 8 of 25 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.05s]
[0m21:23:49.615287 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:23:49.615287 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:23:49.615287 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:23:49.615287 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:23:49.615287 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:23:49.624949 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:23:49.625507 [info ] [Thread-3 (]: 9 of 25 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m21:23:49.625991 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:23:49.626374 [info ] [Thread-4 (]: 10 of 25 START test not_null_stg_customers_customer_unique_id .................. [RUN]
[0m21:23:49.626374 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:23:49.626374 [info ] [Thread-2 (]: 11 of 25 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m21:23:49.626374 [info ] [Thread-1 (]: 12 of 25 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m21:23:49.626374 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_dim_products_product_id.c8aba288d1, now test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba)
[0m21:23:49.629823 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:23:49.629823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b, now test.olist_analytics.not_null_stg_order_items_order_id.2063801f96)
[0m21:23:49.630829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0, now test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m21:23:49.630829 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:23:49.634334 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:23:49.634334 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:23:49.634334 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:23:49.636910 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:23:49.636910 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:23:49.642731 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:23:49.644320 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:23:49.645945 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:23:49.647952 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:23:49.648875 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:23:49.650889 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:23:49.650889 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:23:49.651886 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:23:49.651886 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:23:49.651886 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:23:49.656595 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:23:49.656595 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:23:49.656595 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:23:49.656595 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m21:23:49.656595 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:49.656595 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:23:49.656595 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m21:23:49.659654 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:49.659654 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.659654 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m21:23:49.659654 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:49.662160 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:23:49.662160 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:23:49.662160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:49.663666 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_staging"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.663666 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.663666 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:23:49.663666 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.665181 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:23:49.665181 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "olist"."main_staging"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.666187 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.666187 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:23:49.666187 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.667188 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:23:49.667188 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.667188 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from "olist"."main_staging"."stg_order_items"
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.667188 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m21:23:49.667188 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.667188 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m21:23:49.667188 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:23:49.667188 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m21:23:49.667188 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.667188 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba'
[0m21:23:49.667188 [info ] [Thread-3 (]: 9 of 25 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.04s]
[0m21:23:49.667188 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_items_order_id.2063801f96'
[0m21:23:49.667188 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m21:23:49.667188 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m21:23:49.676489 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:23:49.676489 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: Close
[0m21:23:49.676489 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m21:23:49.676489 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:23:49.676489 [info ] [Thread-4 (]: 10 of 25 PASS not_null_stg_customers_customer_unique_id ........................ [[32mPASS[0m in 0.05s]
[0m21:23:49.676489 [info ] [Thread-2 (]: 11 of 25 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.05s]
[0m21:23:49.676489 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m21:23:49.676489 [info ] [Thread-3 (]: 13 of 25 START test not_null_stg_order_payments_order_id ....................... [RUN]
[0m21:23:49.680755 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:23:49.680755 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:23:49.681760 [info ] [Thread-1 (]: 12 of 25 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.05s]
[0m21:23:49.681760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7)
[0m21:23:49.682783 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:23:49.682783 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:23:49.683759 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:23:49.683759 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:23:49.683759 [info ] [Thread-4 (]: 14 of 25 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m21:23:49.684800 [info ] [Thread-2 (]: 15 of 25 START test not_null_stg_orders_order_id ............................... [RUN]
[0m21:23:49.684800 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:23:49.686429 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:23:49.686429 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba, now test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5)
[0m21:23:49.686429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_items_order_id.2063801f96, now test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:23:49.686429 [info ] [Thread-1 (]: 16 of 25 START test not_null_stg_products_product_id ........................... [RUN]
[0m21:23:49.686429 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:23:49.686429 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:23:49.690865 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:23:49.691529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.olist_analytics.not_null_stg_products_product_id.6373b0acf3)
[0m21:23:49.695048 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:23:49.696086 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:23:49.696086 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:23:49.696086 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:23:49.696086 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:23:49.696086 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:23:49.696086 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:23:49.696086 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:23:49.696086 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:23:49.696086 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:23:49.709264 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:23:49.709665 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: BEGIN
[0m21:23:49.714144 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:23:49.714144 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:23:49.714144 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:49.714144 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:23:49.715653 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m21:23:49.715653 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:23:49.715653 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.715653 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m21:23:49.715653 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:49.715653 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m21:23:49.717661 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:23:49.717661 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:49.717661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:49.717661 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.717661 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_order_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.719674 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.719674 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:23:49.719674 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.719674 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:23:49.719674 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_staging"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.721693 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.721693 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:23:49.721693 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.723710 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: ROLLBACK
[0m21:23:49.723710 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.723710 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "olist"."main_staging"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.723710 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7'
[0m21:23:49.725217 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.726531 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m21:23:49.728095 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: Close
[0m21:23:49.729114 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m21:23:49.729114 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.730107 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5'
[0m21:23:49.731106 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64'
[0m21:23:49.730107 [info ] [Thread-3 (]: 13 of 25 PASS not_null_stg_order_payments_order_id ............................. [[32mPASS[0m in 0.05s]
[0m21:23:49.731106 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m21:23:49.731106 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m21:23:49.731106 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m21:23:49.731106 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:23:49.733829 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_stg_products_product_id.6373b0acf3'
[0m21:23:49.733829 [info ] [Thread-4 (]: 14 of 25 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.05s]
[0m21:23:49.733829 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:23:49.733829 [info ] [Thread-2 (]: 15 of 25 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.05s]
[0m21:23:49.733829 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: Close
[0m21:23:49.736421 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:23:49.736421 [info ] [Thread-3 (]: 17 of 25 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m21:23:49.736421 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:23:49.736421 [info ] [Thread-1 (]: 16 of 25 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.04s]
[0m21:23:49.737950 [debug] [Thread-4 (]: Began running node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:23:49.737950 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7, now test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315)
[0m21:23:49.738966 [debug] [Thread-2 (]: Began running node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:23:49.738966 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:23:49.739961 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:23:49.738966 [info ] [Thread-4 (]: 18 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m21:23:49.739961 [info ] [Thread-2 (]: 19 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m21:23:49.739961 [debug] [Thread-1 (]: Began running node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:23:49.743016 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:23:49.743016 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5, now test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m21:23:49.743016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m21:23:49.743016 [info ] [Thread-1 (]: 20 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m21:23:49.743016 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:23:49.743016 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:23:49.743016 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:23:49.743016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_products_product_id.6373b0acf3, now test.olist_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m21:23:49.743016 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:23:49.758797 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:23:49.761588 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:23:49.761588 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:23:49.762605 [debug] [Thread-4 (]: Began executing node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:23:49.765702 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:23:49.765702 [debug] [Thread-2 (]: Began executing node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:23:49.765702 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:23:49.765702 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:23:49.765702 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:23:49.765702 [debug] [Thread-1 (]: Began executing node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:23:49.765702 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m21:23:49.765702 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:23:49.765702 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:23:49.765702 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:49.765702 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:23:49.765702 [debug] [Thread-4 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m21:23:49.776945 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:23:49.776945 [debug] [Thread-2 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m21:23:49.776945 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:23:49.776945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:49.776945 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m21:23:49.778924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:49.778924 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:23:49.779932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:49.779932 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.780974 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.780974 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "olist"."main_staging"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.780974 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:23:49.781931 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.781931 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:23:49.782929 [debug] [Thread-4 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "olist"."main_marts"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "olist"."main_marts"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:23:49.782929 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.783949 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:23:49.783949 [debug] [Thread-2 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:23:49.783949 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m21:23:49.783949 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:23:49.786640 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315'
[0m21:23:49.786640 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m21:23:49.786640 [info ] [Thread-3 (]: 17 of 25 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.05s]
[0m21:23:49.786640 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:23:49.786640 [debug] [Thread-3 (]: Began running node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:23:49.786640 [info ] [Thread-3 (]: 21 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m21:23:49.786640 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315, now test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5)
[0m21:23:49.792669 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:23:49.793185 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:23:49.795820 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:23:49.795820 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m21:23:49.795820 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.unique_dim_products_product_id.ef7b2a9985'
[0m21:23:49.795820 [debug] [Thread-3 (]: Began executing node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:23:49.802589 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: Close
[0m21:23:49.802589 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:23:49.802589 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m21:23:49.802589 [info ] [Thread-1 (]: 20 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.06s]
[0m21:23:49.809844 [debug] [Thread-2 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m21:23:49.802589 [debug] [Thread-1 (]: Finished running node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:23:49.809844 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:23:49.809844 [debug] [Thread-4 (]: SQL status: OK in 0.027 seconds
[0m21:23:49.811670 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd'
[0m21:23:49.811670 [debug] [Thread-1 (]: Began running node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:23:49.812685 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m21:23:49.813676 [debug] [Thread-2 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m21:23:49.815183 [debug] [Thread-4 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m21:23:49.813676 [info ] [Thread-1 (]: 22 of 25 START test unique_stg_customers_customer_id ........................... [RUN]
[0m21:23:49.815934 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:49.816521 [info ] [Thread-2 (]: 19 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.07s]
[0m21:23:49.817025 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4'
[0m21:23:49.817025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_dim_products_product_id.ef7b2a9985, now test.olist_analytics.unique_stg_customers_customer_id.c7614daada)
[0m21:23:49.818075 [debug] [Thread-2 (]: Finished running node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:23:49.818075 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:23:49.819122 [debug] [Thread-4 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m21:23:49.819122 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:23:49.819122 [debug] [Thread-2 (]: Began running node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:23:49.820119 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:23:49.821083 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:23:49.820119 [info ] [Thread-4 (]: 18 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.08s]
[0m21:23:49.821083 [info ] [Thread-2 (]: 23 of 25 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:23:49.821083 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:23:49.825389 [debug] [Thread-4 (]: Finished running node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:23:49.825389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.olist_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m21:23:49.825389 [debug] [Thread-1 (]: Began executing node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:23:49.826398 [debug] [Thread-4 (]: Began running node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:23:49.827399 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:23:49.829430 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:23:49.830395 [info ] [Thread-4 (]: 24 of 25 START test unique_stg_products_product_id ............................. [RUN]
[0m21:23:49.832438 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:23:49.833974 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.olist_analytics.unique_stg_products_product_id.7d950a1467)
[0m21:23:49.834987 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:23:49.834987 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:23:49.836492 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:23:49.836492 [debug] [Thread-2 (]: Began executing node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:23:49.841499 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:23:49.841499 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m21:23:49.842500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:49.842904 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:23:49.842904 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m21:23:49.842904 [debug] [Thread-4 (]: Began executing node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:23:49.842904 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:23:49.842904 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5'
[0m21:23:49.842904 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:23:49.842904 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:23:49.842904 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:23:49.842904 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: Close
[0m21:23:49.842904 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m21:23:49.842904 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:23:49.842904 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:23:49.842904 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:23:49.842904 [info ] [Thread-3 (]: 21 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.06s]
[0m21:23:49.842904 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: BEGIN
[0m21:23:49.855459 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:23:49.856467 [debug] [Thread-3 (]: Finished running node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:23:49.857468 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:23:49.857468 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:23:49.858976 [debug] [Thread-3 (]: Began running node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:23:49.859987 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:23:49.860985 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:23:49.861985 [info ] [Thread-3 (]: 25 of 25 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m21:23:49.861985 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:23:49.863526 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5, now test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m21:23:49.864533 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:23:49.864533 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:23:49.871472 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:23:49.871472 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m21:23:49.874482 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:23:49.875666 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m21:23:49.876382 [debug] [Thread-3 (]: Began executing node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:23:49.876382 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.unique_stg_customers_customer_id.c7614daada'
[0m21:23:49.876382 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m21:23:49.876382 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:23:49.876382 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m21:23:49.883897 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: Close
[0m21:23:49.883897 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.unique_stg_products_product_id.7d950a1467'
[0m21:23:49.885948 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m21:23:49.886458 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:23:49.886458 [info ] [Thread-1 (]: 22 of 25 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.07s]
[0m21:23:49.886458 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: Close
[0m21:23:49.886458 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.unique_stg_orders_order_id.e3b841c71a'
[0m21:23:49.888294 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m21:23:49.888294 [debug] [Thread-1 (]: Finished running node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:23:49.889085 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m21:23:49.889085 [info ] [Thread-4 (]: 24 of 25 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.06s]
[0m21:23:49.890091 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:23:49.891091 [debug] [Thread-4 (]: Finished running node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:23:49.890091 [info ] [Thread-2 (]: 23 of 25 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.06s]
[0m21:23:49.892091 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:23:49.892091 [debug] [Thread-2 (]: Finished running node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:23:49.893093 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:23:49.893093 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:23:49.896101 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:23:49.898120 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m21:23:49.898120 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8'
[0m21:23:49.898120 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m21:23:49.899100 [info ] [Thread-3 (]: 25 of 25 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.04s]
[0m21:23:49.900099 [debug] [Thread-3 (]: Finished running node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:23:49.901102 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:49.901102 [debug] [MainThread]: On master: BEGIN
[0m21:23:49.902100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:23:49.902100 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:23:49.902100 [debug] [MainThread]: On master: COMMIT
[0m21:23:49.903119 [debug] [MainThread]: Using duckdb connection "master"
[0m21:23:49.903119 [debug] [MainThread]: On master: COMMIT
[0m21:23:49.903119 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:23:49.904100 [debug] [MainThread]: On master: Close
[0m21:23:49.904100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:49.904100 [debug] [MainThread]: Connection 'list_olist_main_marts' was properly closed.
[0m21:23:49.905140 [debug] [MainThread]: Connection 'list_olist_main_staging' was properly closed.
[0m21:23:49.905140 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m21:23:49.905140 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m21:23:49.905140 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m21:23:49.906101 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m21:23:49.906101 [info ] [MainThread]: 
[0m21:23:49.906101 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m21:23:49.909135 [debug] [MainThread]: Command end result
[0m21:23:49.931070 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:23:49.933077 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:23:49.938583 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\run_results.json
[0m21:23:49.939583 [info ] [MainThread]: 
[0m21:23:49.939583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:49.940582 [info ] [MainThread]: 
[0m21:23:49.941167 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m21:23:49.941167 [debug] [MainThread]: Command `dbt test` succeeded at 21:23:49.941167 after 1.28 seconds
[0m21:23:49.941167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A7D55BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A7C5EA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9A14FCF10>]}
[0m21:23:49.942427 [debug] [MainThread]: Flushing usage events
[0m21:23:51.294909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:17.486881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F558F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F55C6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F558EA10>]}


============================== 21:26:17.490870 | fab7004d-64b2-4dc9-aa52-9fc50630e334 ==============================
[0m21:26:17.490870 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:26:17.490870 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:26:17.656869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F565F890>]}
[0m21:26:17.702197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F1DA4D50>]}
[0m21:26:17.704192 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:26:17.899879 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m21:26:17.986766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:26:17.986766 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:26:17.986766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:26:18.020433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F6889ED0>]}
[0m21:26:18.091601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:26:18.094700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:26:18.136562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F202F850>]}
[0m21:26:18.136562 [info ] [MainThread]: Found 12 models, 25 data tests, 9 sources, 586 macros
[0m21:26:18.136562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F202FED0>]}
[0m21:26:18.150270 [info ] [MainThread]: 
[0m21:26:18.150270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:18.150270 [info ] [MainThread]: 
[0m21:26:18.150270 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:26:18.156616 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m21:26:18.156616 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m21:26:18.203938 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m21:26:18.203938 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m21:26:18.203938 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"olist"'
    
  
  
[0m21:26:18.203938 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"olist"'
    
  
  
[0m21:26:18.203938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:18.203938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:18.220192 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:26:18.220192 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m21:26:18.221195 [debug] [ThreadPool]: On list_olist: Close
[0m21:26:18.222289 [debug] [ThreadPool]: On list_olist: Close
[0m21:26:18.223946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_main_marts)
[0m21:26:18.223946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_main_staging)
[0m21:26:18.223946 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "main_marts"
"
[0m21:26:18.224980 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "main_staging"
"
[0m21:26:18.229048 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:26:18.231556 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:26:18.231556 [debug] [ThreadPool]: On create_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='olist'
        and type='sqlite'
    
  
[0m21:26:18.232191 [debug] [ThreadPool]: On create_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='olist'
        and type='sqlite'
    
  
[0m21:26:18.232191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:18.234309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:18.235681 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:26:18.235681 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:26:18.236698 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:26:18.237704 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:26:18.237704 [debug] [ThreadPool]: On create_olist_main_marts: BEGIN
[0m21:26:18.238727 [debug] [ThreadPool]: On create_olist_main_staging: BEGIN
[0m21:26:18.238727 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:18.238727 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:18.239705 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:26:18.239705 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:26:18.239705 [debug] [ThreadPool]: On create_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_marts"} */

    
    
        create schema if not exists "olist"."main_marts"
    
[0m21:26:18.240702 [debug] [ThreadPool]: On create_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_staging"} */

    
    
        create schema if not exists "olist"."main_staging"
    
[0m21:26:18.240702 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:18.241703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:18.241703 [debug] [ThreadPool]: On create_olist_main_marts: COMMIT
[0m21:26:18.242591 [debug] [ThreadPool]: On create_olist_main_staging: COMMIT
[0m21:26:18.243302 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:26:18.243302 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:26:18.243302 [debug] [ThreadPool]: On create_olist_main_marts: COMMIT
[0m21:26:18.244315 [debug] [ThreadPool]: On create_olist_main_staging: COMMIT
[0m21:26:18.244315 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:18.245320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:18.245320 [debug] [ThreadPool]: On create_olist_main_marts: Close
[0m21:26:18.245320 [debug] [ThreadPool]: On create_olist_main_staging: Close
[0m21:26:18.247414 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_marts'
[0m21:26:18.247414 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_staging'
[0m21:26:18.252003 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:26:18.252003 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:26:18.252003 [debug] [ThreadPool]: On list_olist_main_marts: BEGIN
[0m21:26:18.252003 [debug] [ThreadPool]: On list_olist_main_staging: BEGIN
[0m21:26:18.252003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:18.252003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:18.252003 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:26:18.252003 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:26:18.252003 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:26:18.252003 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:26:18.252003 [debug] [ThreadPool]: On list_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_marts"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'olist'
  
[0m21:26:18.252003 [debug] [ThreadPool]: On list_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'olist'
  
[0m21:26:18.268161 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:26:18.268161 [debug] [ThreadPool]: On list_olist_main_marts: ROLLBACK
[0m21:26:18.268161 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:26:18.272778 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_marts'
[0m21:26:18.272778 [debug] [ThreadPool]: On list_olist_main_marts: Close
[0m21:26:18.273782 [debug] [ThreadPool]: On list_olist_main_staging: ROLLBACK
[0m21:26:18.274784 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_staging'
[0m21:26:18.275789 [debug] [ThreadPool]: On list_olist_main_staging: Close
[0m21:26:18.276800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F6FAECD0>]}
[0m21:26:18.276800 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:18.278023 [debug] [MainThread]: On master: BEGIN
[0m21:26:18.278023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:18.278826 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:26:18.279170 [debug] [MainThread]: On master: COMMIT
[0m21:26:18.279170 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:18.279170 [debug] [MainThread]: On master: COMMIT
[0m21:26:18.279170 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:26:18.279170 [debug] [MainThread]: On master: Close
[0m21:26:18.285783 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m21:26:18.286352 [debug] [Thread-2 (]: Began running node model.olist_analytics.stg_geolocation
[0m21:26:18.286352 [debug] [Thread-3 (]: Began running node model.olist_analytics.stg_order_items
[0m21:26:18.286865 [debug] [Thread-4 (]: Began running node model.olist_analytics.stg_order_payments
[0m21:26:18.287398 [info ] [Thread-1 (]: 1 of 12 START sql view model main_staging.stg_customers ........................ [RUN]
[0m21:26:18.287398 [info ] [Thread-2 (]: 2 of 12 START sql view model main_staging.stg_geolocation ...................... [RUN]
[0m21:26:18.287398 [info ] [Thread-3 (]: 3 of 12 START sql view model main_staging.stg_order_items ...................... [RUN]
[0m21:26:18.287398 [info ] [Thread-4 (]: 4 of 12 START sql view model main_staging.stg_order_payments ................... [RUN]
[0m21:26:18.287398 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_customers'
[0m21:26:18.287398 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_geolocation'
[0m21:26:18.287398 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_order_items'
[0m21:26:18.287398 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_order_payments'
[0m21:26:18.287398 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m21:26:18.287398 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m21:26:18.287398 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.stg_order_items
[0m21:26:18.287398 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m21:26:18.296583 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m21:26:18.300017 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m21:26:18.303011 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m21:26:18.305125 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m21:26:18.306011 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m21:26:18.306011 [debug] [Thread-2 (]: Began executing node model.olist_analytics.stg_geolocation
[0m21:26:18.307011 [debug] [Thread-3 (]: Began executing node model.olist_analytics.stg_order_items
[0m21:26:18.307011 [debug] [Thread-4 (]: Began executing node model.olist_analytics.stg_order_payments
[0m21:26:18.318367 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m21:26:18.318367 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m21:26:18.335314 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m21:26:18.336845 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m21:26:18.336845 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:26:18.336845 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:26:18.336845 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: BEGIN
[0m21:26:18.336845 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:26:18.336845 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:26:18.336845 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: BEGIN
[0m21:26:18.336845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:26:18.336845 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: BEGIN
[0m21:26:18.336845 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: BEGIN
[0m21:26:18.336845 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:26:18.336845 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.336845 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:26:18.336845 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:26:18.336845 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.336845 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:26:18.336845 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.336845 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.336845 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:26:18.336845 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */

  
  create view "olist"."main_staging"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_customers"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );

[0m21:26:18.349487 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:26:18.349487 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:26:18.350493 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */

  
  create view "olist"."main_staging"."stg_order_items__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_items"
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_limit_at,
        price,
        freight_value
    from source
)

select * from renamed
  );

[0m21:26:18.351494 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */

  
  create view "olist"."main_staging"."stg_geolocation__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_geolocation"
),

renamed as (
    select
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed
  );

[0m21:26:18.351494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.351494 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */

  
  create view "olist"."main_staging"."stg_order_payments__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_payments"
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed
  );

[0m21:26:18.356828 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:26:18.357810 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:26:18.357810 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:26:18.357810 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */
alter view "olist"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:26:18.357810 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.361021 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:26:18.363020 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:26:18.366213 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:26:18.366213 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:26:18.367236 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */
alter view "olist"."main_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m21:26:18.367236 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */
alter view "olist"."main_staging"."stg_geolocation" rename to "stg_geolocation__dbt_backup"
[0m21:26:18.368223 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */
alter view "olist"."main_staging"."stg_order_payments" rename to "stg_order_payments__dbt_backup"
[0m21:26:18.370235 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:26:18.371068 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.372171 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.372171 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.373171 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */
alter view "olist"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:26:18.375172 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:26:18.377830 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:26:18.379960 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:26:18.381046 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */
alter view "olist"."main_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m21:26:18.381046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.382098 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */
alter view "olist"."main_staging"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m21:26:18.383121 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */
alter view "olist"."main_staging"."stg_order_payments__dbt_tmp" rename to "stg_order_payments"
[0m21:26:18.384271 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.387391 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: COMMIT
[0m21:26:18.393330 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.393330 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.393330 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: COMMIT
[0m21:26:18.393330 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:26:18.396535 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: COMMIT
[0m21:26:18.396535 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: COMMIT
[0m21:26:18.396535 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:26:18.398998 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: COMMIT
[0m21:26:18.400003 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:26:18.400003 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:26:18.401003 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: COMMIT
[0m21:26:18.401003 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: COMMIT
[0m21:26:18.402002 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: COMMIT
[0m21:26:18.404019 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:26:18.405002 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.406003 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.406003 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.409542 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:26:18.411578 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:26:18.413557 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:26:18.415554 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:26:18.416732 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */

      drop view if exists "olist"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m21:26:18.417331 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */

      drop view if exists "olist"."main_staging"."stg_order_items__dbt_backup" cascade
    
[0m21:26:18.417840 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */

      drop view if exists "olist"."main_staging"."stg_geolocation__dbt_backup" cascade
    
[0m21:26:18.418268 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */

      drop view if exists "olist"."main_staging"."stg_order_payments__dbt_backup" cascade
    
[0m21:26:18.419274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.421274 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: Close
[0m21:26:18.421274 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.422273 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:26:18.422273 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:26:18.424311 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: Close
[0m21:26:18.424311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F563E650>]}
[0m21:26:18.425274 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: Close
[0m21:26:18.426271 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: Close
[0m21:26:18.426271 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F675FFD0>]}
[0m21:26:18.427271 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.13s]
[0m21:26:18.428273 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F68226D0>]}
[0m21:26:18.428489 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F82ABE50>]}
[0m21:26:18.429624 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m21:26:18.428489 [info ] [Thread-2 (]: 2 of 12 OK created sql view model main_staging.stg_geolocation ................. [[32mOK[0m in 0.14s]
[0m21:26:18.429624 [info ] [Thread-3 (]: 3 of 12 OK created sql view model main_staging.stg_order_items ................. [[32mOK[0m in 0.14s]
[0m21:26:18.430619 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m21:26:18.430619 [info ] [Thread-4 (]: 4 of 12 OK created sql view model main_staging.stg_order_payments .............. [[32mOK[0m in 0.14s]
[0m21:26:18.431581 [debug] [Thread-2 (]: Finished running node model.olist_analytics.stg_geolocation
[0m21:26:18.431581 [debug] [Thread-3 (]: Finished running node model.olist_analytics.stg_order_items
[0m21:26:18.432507 [info ] [Thread-1 (]: 5 of 12 START sql view model main_staging.stg_order_reviews .................... [RUN]
[0m21:26:18.432507 [debug] [Thread-4 (]: Finished running node model.olist_analytics.stg_order_payments
[0m21:26:18.434187 [debug] [Thread-2 (]: Began running node model.olist_analytics.stg_orders
[0m21:26:18.434558 [debug] [Thread-3 (]: Began running node model.olist_analytics.stg_product_category_translation
[0m21:26:18.435197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_order_reviews)
[0m21:26:18.435197 [debug] [Thread-4 (]: Began running node model.olist_analytics.stg_products
[0m21:26:18.435197 [info ] [Thread-2 (]: 6 of 12 START sql view model main_staging.stg_orders ........................... [RUN]
[0m21:26:18.435197 [info ] [Thread-3 (]: 7 of 12 START sql view model main_staging.stg_product_category_translation ..... [RUN]
[0m21:26:18.436752 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m21:26:18.436752 [info ] [Thread-4 (]: 8 of 12 START sql view model main_staging.stg_products ......................... [RUN]
[0m21:26:18.437795 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_orders)
[0m21:26:18.437795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_product_category_translation)
[0m21:26:18.439781 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m21:26:18.439781 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_products)
[0m21:26:18.439781 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.stg_orders
[0m21:26:18.439781 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.stg_product_category_translation
[0m21:26:18.439781 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.stg_products
[0m21:26:18.439781 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m21:26:18.439781 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m21:26:18.439781 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_translation"
[0m21:26:18.450370 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m21:26:18.453307 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m21:26:18.454276 [debug] [Thread-2 (]: Began executing node model.olist_analytics.stg_orders
[0m21:26:18.455277 [debug] [Thread-3 (]: Began executing node model.olist_analytics.stg_product_category_translation
[0m21:26:18.457296 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m21:26:18.457296 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:26:18.457296 [debug] [Thread-4 (]: Began executing node model.olist_analytics.stg_products
[0m21:26:18.459420 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_translation"
[0m21:26:18.459420 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: BEGIN
[0m21:26:18.459420 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:26:18.459420 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m21:26:18.465422 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:26:18.465422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:18.466634 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: BEGIN
[0m21:26:18.467196 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: BEGIN
[0m21:26:18.468494 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:26:18.468494 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:26:18.468494 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:18.469634 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:18.469634 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: BEGIN
[0m21:26:18.469634 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:26:18.471136 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.471136 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.471136 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:26:18.472141 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */

  
  create view "olist"."main_staging"."stg_order_reviews__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_reviews"
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        review_creation_date as review_created_at,
        review_answer_timestamp as review_answered_at
    from source
)

select * from renamed
  );

[0m21:26:18.472141 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:26:18.472141 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:26:18.473141 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.474142 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */

  
  create view "olist"."main_staging"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as order_purchase_at,
        order_approved_at,
        order_delivered_carrier_date as order_delivered_carrier_at,
        order_delivered_customer_date as order_delivered_customer_at,
        order_estimated_delivery_date as order_estimated_delivery_at
    from source
)

select * from renamed
  );

[0m21:26:18.474142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.474760 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */

  
  create view "olist"."main_staging"."stg_product_category_translation__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_product_category_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );

[0m21:26:18.474760 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:26:18.476772 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:26:18.476772 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:26:18.476772 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */

  
  create view "olist"."main_staging"."stg_products__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_products"
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as product_name_length,
        product_description_lenght as product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from source
)

select * from renamed
  );

[0m21:26:18.478779 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.478779 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */
alter view "olist"."main_staging"."stg_order_reviews" rename to "stg_order_reviews__dbt_backup"
[0m21:26:18.480789 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:26:18.484636 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:26:18.485191 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:26:18.485995 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */
alter view "olist"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:26:18.485995 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.485995 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */
alter view "olist"."main_staging"."stg_product_category_translation" rename to "stg_product_category_translation__dbt_backup"
[0m21:26:18.489017 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:26:18.491027 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:26:18.491027 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:26:18.493037 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */
alter view "olist"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m21:26:18.493037 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.493037 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */
alter view "olist"."main_staging"."stg_order_reviews__dbt_tmp" rename to "stg_order_reviews"
[0m21:26:18.495046 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:26:18.497052 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:26:18.497052 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.499032 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */
alter view "olist"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:26:18.500354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.500958 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */
alter view "olist"."main_staging"."stg_product_category_translation__dbt_tmp" rename to "stg_product_category_translation"
[0m21:26:18.502649 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:26:18.504665 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: COMMIT
[0m21:26:18.504665 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.504665 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */
alter view "olist"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:26:18.504665 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.506675 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:26:18.506675 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: COMMIT
[0m21:26:18.509191 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: COMMIT
[0m21:26:18.509191 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.509191 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: COMMIT
[0m21:26:18.509191 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:26:18.509191 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:26:18.511442 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: COMMIT
[0m21:26:18.511442 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: COMMIT
[0m21:26:18.513452 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: COMMIT
[0m21:26:18.513452 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:26:18.513452 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: COMMIT
[0m21:26:18.515512 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:26:18.516152 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.517161 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.519257 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:26:18.520090 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:26:18.520090 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:26:18.520090 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:26:18.520090 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */

      drop view if exists "olist"."main_staging"."stg_order_reviews__dbt_backup" cascade
    
[0m21:26:18.520090 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:26:18.520090 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */

      drop view if exists "olist"."main_staging"."stg_product_category_translation__dbt_backup" cascade
    
[0m21:26:18.520090 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */

      drop view if exists "olist"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m21:26:18.520090 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */

      drop view if exists "olist"."main_staging"."stg_products__dbt_backup" cascade
    
[0m21:26:18.520090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.520090 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: Close
[0m21:26:18.520090 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.520090 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.520090 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.520090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F7251B50>]}
[0m21:26:18.520090 [debug] [Thread-3 (]: On model.olist_analytics.stg_product_category_translation: Close
[0m21:26:18.532311 [debug] [Thread-2 (]: On model.olist_analytics.stg_orders: Close
[0m21:26:18.534957 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: Close
[0m21:26:18.534957 [info ] [Thread-1 (]: 5 of 12 OK created sql view model main_staging.stg_order_reviews ............... [[32mOK[0m in 0.09s]
[0m21:26:18.536480 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F72218D0>]}
[0m21:26:18.536480 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F83A73D0>]}
[0m21:26:18.537525 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F83A7BD0>]}
[0m21:26:18.537525 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m21:26:18.538488 [info ] [Thread-3 (]: 7 of 12 OK created sql view model main_staging.stg_product_category_translation  [[32mOK[0m in 0.10s]
[0m21:26:18.538488 [info ] [Thread-2 (]: 6 of 12 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.10s]
[0m21:26:18.539488 [info ] [Thread-4 (]: 8 of 12 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.10s]
[0m21:26:18.539488 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m21:26:18.540487 [debug] [Thread-3 (]: Finished running node model.olist_analytics.stg_product_category_translation
[0m21:26:18.540487 [debug] [Thread-2 (]: Finished running node model.olist_analytics.stg_orders
[0m21:26:18.541487 [debug] [Thread-4 (]: Finished running node model.olist_analytics.stg_products
[0m21:26:18.541487 [debug] [Thread-3 (]: Began running node model.olist_analytics.dim_customers
[0m21:26:18.541487 [info ] [Thread-1 (]: 9 of 12 START sql view model main_staging.stg_sellers .......................... [RUN]
[0m21:26:18.542489 [debug] [Thread-4 (]: Began running node model.olist_analytics.fct_orders
[0m21:26:18.542489 [debug] [Thread-2 (]: Began running node model.olist_analytics.dim_products
[0m21:26:18.543517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_sellers)
[0m21:26:18.543517 [info ] [Thread-3 (]: 10 of 12 START sql table model main_marts.dim_customers ........................ [RUN]
[0m21:26:18.543517 [info ] [Thread-4 (]: 11 of 12 START sql table model main_marts.fct_orders ........................... [RUN]
[0m21:26:18.544531 [info ] [Thread-2 (]: 12 of 12 START sql table model main_marts.dim_products ......................... [RUN]
[0m21:26:18.545139 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m21:26:18.545838 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_translation, now model.olist_analytics.dim_customers)
[0m21:26:18.545838 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.fct_orders)
[0m21:26:18.546884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.dim_products)
[0m21:26:18.548864 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m21:26:18.550030 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.dim_customers
[0m21:26:18.550030 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.fct_orders
[0m21:26:18.551356 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.dim_products
[0m21:26:18.554251 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m21:26:18.557243 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m21:26:18.557243 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m21:26:18.559368 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m21:26:18.560086 [debug] [Thread-3 (]: Began executing node model.olist_analytics.dim_customers
[0m21:26:18.560086 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m21:26:18.560086 [debug] [Thread-4 (]: Began executing node model.olist_analytics.fct_orders
[0m21:26:18.568267 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m21:26:18.568267 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m21:26:18.568267 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:26:18.568267 [debug] [Thread-2 (]: Began executing node model.olist_analytics.dim_products
[0m21:26:18.582385 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:26:18.568267 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:26:18.582385 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: BEGIN
[0m21:26:18.585006 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m21:26:18.586576 [debug] [Thread-3 (]: On model.olist_analytics.dim_customers: BEGIN
[0m21:26:18.587592 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: BEGIN
[0m21:26:18.588050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:18.589307 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:18.590324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:26:18.590324 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:26:18.591324 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:26:18.591324 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.592323 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.592323 [debug] [Thread-2 (]: On model.olist_analytics.dim_products: BEGIN
[0m21:26:18.592323 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:26:18.592323 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:26:18.592323 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:26:18.592323 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:18.592323 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */

  
  create view "olist"."main_staging"."stg_sellers__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_sellers"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed
  );

[0m21:26:18.592323 [debug] [Thread-3 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    
    

    create  table
      "olist"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      with customers as (
    select * from "olist"."main_staging"."stg_customers"
),

geolocation as (
    select * from "olist"."main_staging"."stg_geolocation"
),

-- We might want to join exact location data later, but for now 
-- a simple dimension table from staging is a good start.
final as (
    select
        customer_id,
        customer_unique_id,
        zip_code,
        city,
        state
    from customers
)

select * from final
    );
  
  
[0m21:26:18.592323 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    
    

    create  table
      "olist"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      with orders as (
    select * from "olist"."main_staging"."stg_orders"
),

order_items as (
    select * from "olist"."main_staging"."stg_order_items"
),

order_payments as (
    select * from "olist"."main_staging"."stg_order_payments"
),

-- Aggregating items per order
order_items_agg as (
    select
        order_id,
        count(order_item_id) as total_items,
        sum(price) as total_item_value,
        sum(freight_value) as total_freight_value
    from order_items
    group by 1
),

-- Aggregating payments per order
order_payments_agg as (
    select
        order_id,
        sum(payment_value) as total_payment_value,
        string_agg(distinct payment_type, ', ') as payment_types
    from order_payments
    group by 1
),

final as (
    select
        o.order_id,
        o.customer_id,
        o.order_status,
        o.order_purchase_at,
        o.order_approved_at,
        o.order_delivered_carrier_at,
        o.order_delivered_customer_at,
        o.order_estimated_delivery_at,
        
        -- Metrics from items
        coalesce(i.total_items, 0) as number_of_items,
        coalesce(i.total_item_value, 0) as item_value,
        coalesce(i.total_freight_value, 0) as freight_value,
        
        -- Metrics from payments
        coalesce(p.total_payment_value, 0) as total_amount,
        p.payment_types,
        
        -- Calculated fields
        (o.order_delivered_customer_at - o.order_purchase_at) as delivery_time_interval,
        case 
            when o.order_delivered_customer_at > o.order_estimated_delivery_at then true 
            else false 
        end as is_delayed
        
    from orders o
    left join order_items_agg i on o.order_id = i.order_id
    left join order_payments_agg p on o.order_id = p.order_id
)

select * from final
    );
  
  
[0m21:26:18.592323 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.592323 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.592323 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:26:18.599561 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:26:18.600568 [debug] [Thread-2 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    
    

    create  table
      "olist"."main_marts"."dim_products__dbt_tmp"
  
    as (
      with products as (
    select * from "olist"."main_staging"."stg_products"
),

category_translation as (
    select * from "olist"."main_staging"."stg_product_category_translation"
),

final as (
    select
        p.product_id,
        p.product_category_name,
        t.product_category_name_english,
        
        -- Coalesce english name if available, otherwise fallback to original
        coalesce(t.product_category_name_english, p.product_category_name) as category_name,
        
        p.product_name_length,
        p.product_description_length,
        p.product_photos_qty,
        p.product_weight_g,
        p.product_length_cm,
        p.product_height_cm,
        p.product_width_cm
    from products p
    left join category_translation t 
        on p.product_category_name = t.product_category_name
)

select * from final
    );
  
  
[0m21:26:18.601568 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */
alter view "olist"."main_staging"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m21:26:18.602122 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.606145 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:26:18.606145 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */
alter view "olist"."main_staging"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m21:26:18.608155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.611264 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: COMMIT
[0m21:26:18.613272 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:26:18.613272 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: COMMIT
[0m21:26:18.619165 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:26:18.623291 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:26:18.623291 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */

      drop view if exists "olist"."main_staging"."stg_sellers__dbt_backup" cascade
    
[0m21:26:18.625298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.625298 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: Close
[0m21:26:18.625298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F8318B50>]}
[0m21:26:18.625298 [info ] [Thread-1 (]: 9 of 12 OK created sql view model main_staging.stg_sellers ..................... [[32mOK[0m in 0.08s]
[0m21:26:18.625298 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m21:26:18.634253 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m21:26:18.641072 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:26:18.641072 [debug] [Thread-2 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_products'
  
[0m21:26:18.646929 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:26:18.650558 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:26:18.650558 [debug] [Thread-2 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_products'
  
[0m21:26:18.652439 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:18.652439 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:26:18.652439 [debug] [Thread-2 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */
alter table "olist"."main_marts"."dim_products" rename to "dim_products__dbt_backup"
[0m21:26:18.659422 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.659422 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:26:18.659422 [debug] [Thread-2 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */
alter table "olist"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m21:26:18.659422 [debug] [Thread-3 (]: SQL status: OK in 0.067 seconds
[0m21:26:18.659422 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.665556 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:26:18.670885 [debug] [Thread-2 (]: On model.olist_analytics.dim_products: COMMIT
[0m21:26:18.671887 [debug] [Thread-3 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_customers'
  
[0m21:26:18.672889 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:26:18.673885 [debug] [Thread-2 (]: On model.olist_analytics.dim_products: COMMIT
[0m21:26:18.674883 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.675884 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:26:18.676887 [debug] [Thread-3 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_customers'
  
[0m21:26:18.677883 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.681899 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:26:18.682891 [debug] [Thread-3 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */
alter table "olist"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m21:26:18.684398 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.686613 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:26:18.687619 [debug] [Thread-3 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */
alter table "olist"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m21:26:18.687619 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.689619 [debug] [Thread-3 (]: On model.olist_analytics.dim_customers: COMMIT
[0m21:26:18.689619 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m21:26:18.690619 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:26:18.692618 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:26:18.692618 [debug] [Thread-3 (]: On model.olist_analytics.dim_customers: COMMIT
[0m21:26:18.693618 [debug] [Thread-2 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

      drop table if exists "olist"."main_marts"."dim_products__dbt_backup" cascade
    
[0m21:26:18.720841 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m21:26:18.720841 [debug] [Thread-2 (]: SQL status: OK in 0.027 seconds
[0m21:26:18.723269 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:26:18.725306 [debug] [Thread-2 (]: On model.olist_analytics.dim_products: Close
[0m21:26:18.725306 [debug] [Thread-3 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

      drop table if exists "olist"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m21:26:18.726269 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F83E1BD0>]}
[0m21:26:18.726920 [info ] [Thread-2 (]: 12 of 12 OK created sql table model main_marts.dim_products .................... [[32mOK[0m in 0.18s]
[0m21:26:18.727976 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:18.729143 [debug] [Thread-2 (]: Finished running node model.olist_analytics.dim_products
[0m21:26:18.729143 [debug] [Thread-3 (]: On model.olist_analytics.dim_customers: Close
[0m21:26:18.732246 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F82DD090>]}
[0m21:26:18.733752 [info ] [Thread-3 (]: 10 of 12 OK created sql table model main_marts.dim_customers ................... [[32mOK[0m in 0.19s]
[0m21:26:18.734758 [debug] [Thread-3 (]: Finished running node model.olist_analytics.dim_customers
[0m21:26:18.755847 [debug] [Thread-4 (]: SQL status: OK in 0.160 seconds
[0m21:26:18.756839 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:26:18.757839 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_orders'
  
[0m21:26:18.757839 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.759583 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:26:18.759583 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_orders'
  
[0m21:26:18.759583 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.759583 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:26:18.759583 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */
alter table "olist"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m21:26:18.759583 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.767312 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:26:18.767312 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */
alter table "olist"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m21:26:18.768620 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:26:18.768620 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: COMMIT
[0m21:26:18.768620 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:26:18.768620 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: COMMIT
[0m21:26:18.805757 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m21:26:18.807774 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:26:18.807774 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

      drop table if exists "olist"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m21:26:19.011679 [debug] [Thread-4 (]: SQL status: OK in 0.203 seconds
[0m21:26:19.013179 [debug] [Thread-4 (]: On model.olist_analytics.fct_orders: Close
[0m21:26:19.013788 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab7004d-64b2-4dc9-aa52-9fc50630e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F842FB10>]}
[0m21:26:19.013788 [info ] [Thread-4 (]: 11 of 12 OK created sql table model main_marts.fct_orders ...................... [[32mOK[0m in 0.47s]
[0m21:26:19.015299 [debug] [Thread-4 (]: Finished running node model.olist_analytics.fct_orders
[0m21:26:19.017209 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:19.017209 [debug] [MainThread]: On master: BEGIN
[0m21:26:19.018241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:19.018629 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:26:19.018629 [debug] [MainThread]: On master: COMMIT
[0m21:26:19.018629 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:19.018629 [debug] [MainThread]: On master: COMMIT
[0m21:26:19.018629 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:26:19.018629 [debug] [MainThread]: On master: Close
[0m21:26:19.018629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:19.018629 [debug] [MainThread]: Connection 'create_olist_main_staging' was properly closed.
[0m21:26:19.018629 [debug] [MainThread]: Connection 'create_olist_main_marts' was properly closed.
[0m21:26:19.018629 [debug] [MainThread]: Connection 'list_olist_main_marts' was properly closed.
[0m21:26:19.018629 [debug] [MainThread]: Connection 'list_olist_main_staging' was properly closed.
[0m21:26:19.018629 [debug] [MainThread]: Connection 'model.olist_analytics.stg_sellers' was properly closed.
[0m21:26:19.018629 [debug] [MainThread]: Connection 'model.olist_analytics.dim_products' was properly closed.
[0m21:26:19.018629 [debug] [MainThread]: Connection 'model.olist_analytics.dim_customers' was properly closed.
[0m21:26:19.018629 [debug] [MainThread]: Connection 'model.olist_analytics.fct_orders' was properly closed.
[0m21:26:19.018629 [info ] [MainThread]: 
[0m21:26:19.018629 [info ] [MainThread]: Finished running 3 table models, 9 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m21:26:19.024967 [debug] [MainThread]: Command end result
[0m21:26:19.036717 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:26:19.050214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:26:19.051222 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\run_results.json
[0m21:26:19.051222 [info ] [MainThread]: 
[0m21:26:19.051222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:19.051222 [info ] [MainThread]: 
[0m21:26:19.051222 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m21:26:19.051222 [debug] [MainThread]: Command `dbt run` succeeded at 21:26:19.051222 after 1.63 seconds
[0m21:26:19.051222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8F523EA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EEB4CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8EE8AA750>]}
[0m21:26:19.051222 [debug] [MainThread]: Flushing usage events
[0m21:26:20.725757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:22.184190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306296EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230627115D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306295F710>]}


============================== 21:26:22.186756 | 88d6d6f8-d842-432b-bf1c-7c25cb8d04dc ==============================
[0m21:26:22.186756 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:26:22.186756 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:26:22.351240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88d6d6f8-d842-432b-bf1c-7c25cb8d04dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023062A1A0D0>]}
[0m21:26:22.392647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88d6d6f8-d842-432b-bf1c-7c25cb8d04dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002305F194550>]}
[0m21:26:22.396125 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:26:22.563395 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m21:26:22.659214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:26:22.659214 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:26:22.660402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:26:22.692256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88d6d6f8-d842-432b-bf1c-7c25cb8d04dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306194A050>]}
[0m21:26:22.749456 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:26:22.749456 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:26:22.809503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88d6d6f8-d842-432b-bf1c-7c25cb8d04dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306194A8D0>]}
[0m21:26:22.809503 [info ] [MainThread]: Found 12 models, 25 data tests, 9 sources, 586 macros
[0m21:26:22.813955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88d6d6f8-d842-432b-bf1c-7c25cb8d04dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023063A6A410>]}
[0m21:26:22.815645 [info ] [MainThread]: 
[0m21:26:22.815645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:22.815645 [info ] [MainThread]: 
[0m21:26:22.815645 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:26:22.815645 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_marts'
[0m21:26:22.830440 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_staging'
[0m21:26:22.867899 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:26:22.867899 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:26:22.867899 [debug] [ThreadPool]: On list_olist_main_marts: BEGIN
[0m21:26:22.867899 [debug] [ThreadPool]: On list_olist_main_staging: BEGIN
[0m21:26:22.867899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:22.867899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:22.882528 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:26:22.884314 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:26:22.884849 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:26:22.885384 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:26:22.885384 [debug] [ThreadPool]: On list_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_marts"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'olist'
  
[0m21:26:22.885384 [debug] [ThreadPool]: On list_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'olist'
  
[0m21:26:22.896615 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:26:22.896615 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:26:22.898616 [debug] [ThreadPool]: On list_olist_main_marts: ROLLBACK
[0m21:26:22.899939 [debug] [ThreadPool]: On list_olist_main_staging: ROLLBACK
[0m21:26:22.900595 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_marts'
[0m21:26:22.900595 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_staging'
[0m21:26:22.900595 [debug] [ThreadPool]: On list_olist_main_marts: Close
[0m21:26:22.900595 [debug] [ThreadPool]: On list_olist_main_staging: Close
[0m21:26:22.903613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88d6d6f8-d842-432b-bf1c-7c25cb8d04dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230629B9650>]}
[0m21:26:22.903613 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:22.903613 [debug] [MainThread]: On master: BEGIN
[0m21:26:22.904615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:22.904615 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:26:22.905614 [debug] [MainThread]: On master: COMMIT
[0m21:26:22.905614 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:22.905614 [debug] [MainThread]: On master: COMMIT
[0m21:26:22.906630 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:26:22.906630 [debug] [MainThread]: On master: Close
[0m21:26:22.909804 [debug] [Thread-1 (]: Began running node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:26:22.909804 [debug] [Thread-2 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:26:22.910822 [debug] [Thread-3 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:26:22.910822 [debug] [Thread-4 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:26:22.910822 [info ] [Thread-1 (]: 1 of 25 START test accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m21:26:22.911819 [info ] [Thread-2 (]: 2 of 25 START test dbt_utils_expression_is_true_fct_orders_item_value___0 ...... [RUN]
[0m21:26:22.911819 [info ] [Thread-3 (]: 3 of 25 START test dbt_utils_expression_is_true_stg_order_items_price___0 ...... [RUN]
[0m21:26:22.911819 [info ] [Thread-4 (]: 4 of 25 START test dbt_utils_expression_is_true_stg_order_payments_payment_value___0  [RUN]
[0m21:26:22.912820 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460'
[0m21:26:22.913820 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655'
[0m21:26:22.913820 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09'
[0m21:26:22.913820 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81'
[0m21:26:22.913820 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:26:22.915947 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:26:22.915947 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:26:22.915947 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:26:22.930378 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:26:22.936745 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:26:22.936745 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:26:22.944371 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:26:22.944912 [debug] [Thread-1 (]: Began executing node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:26:22.945739 [debug] [Thread-2 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:26:22.946350 [debug] [Thread-3 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:26:22.947267 [debug] [Thread-4 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:26:22.959915 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:26:22.964225 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:26:22.967073 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:26:22.969078 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:26:22.969078 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:26:22.969078 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:26:22.969078 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:26:22.969078 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: BEGIN
[0m21:26:22.969078 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: BEGIN
[0m21:26:22.969078 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:26:22.969078 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: BEGIN
[0m21:26:22.969078 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:26:22.969078 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:26:22.969078 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: BEGIN
[0m21:26:22.969078 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:26:22.969078 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:26:22.969078 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:22.969078 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:26:22.969078 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:26:22.969078 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:26:22.969078 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:26:22.969078 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "olist"."main_staging"."stg_orders"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
      
    ) dbt_internal_test
[0m21:26:22.969078 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:22.969078 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:26:22.969078 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_marts"."fct_orders"

where not(item_value >= 0)


  
  
      
    ) dbt_internal_test
[0m21:26:22.969078 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:26:22.969078 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_staging"."stg_order_items"

where not(price >= 0)


  
  
      
    ) dbt_internal_test
[0m21:26:22.969078 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_staging"."stg_order_payments"

where not(payment_value >= 0)


  
  
      
    ) dbt_internal_test
[0m21:26:22.969078 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:26:22.982688 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:22.983685 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:26:22.984959 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: ROLLBACK
[0m21:26:22.986465 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:26:22.987471 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: ROLLBACK
[0m21:26:22.988472 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: ROLLBACK
[0m21:26:22.989105 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655'
[0m21:26:22.990121 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: ROLLBACK
[0m21:26:22.990121 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09'
[0m21:26:22.991118 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81'
[0m21:26:22.991118 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: Close
[0m21:26:22.992120 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460'
[0m21:26:22.992120 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: Close
[0m21:26:22.992120 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: Close
[0m21:26:22.993119 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: Close
[0m21:26:22.993119 [info ] [Thread-2 (]: 2 of 25 PASS dbt_utils_expression_is_true_fct_orders_item_value___0 ............ [[32mPASS[0m in 0.08s]
[0m21:26:22.994120 [info ] [Thread-3 (]: 3 of 25 PASS dbt_utils_expression_is_true_stg_order_items_price___0 ............ [[32mPASS[0m in 0.08s]
[0m21:26:22.994120 [info ] [Thread-4 (]: 4 of 25 PASS dbt_utils_expression_is_true_stg_order_payments_payment_value___0 . [[32mPASS[0m in 0.08s]
[0m21:26:22.995120 [info ] [Thread-1 (]: 1 of 25 PASS accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 0.08s]
[0m21:26:22.995120 [debug] [Thread-2 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:26:22.996119 [debug] [Thread-3 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:26:22.996119 [debug] [Thread-4 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:26:22.997118 [debug] [Thread-1 (]: Finished running node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:26:22.997118 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:26:22.998294 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:26:22.999300 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:26:22.999300 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:26:23.000299 [info ] [Thread-2 (]: 5 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m21:26:23.000299 [info ] [Thread-3 (]: 6 of 25 START test not_null_dim_products_product_id ............................ [RUN]
[0m21:26:23.001300 [info ] [Thread-4 (]: 7 of 25 START test not_null_fct_orders_customer_id ............................. [RUN]
[0m21:26:23.001300 [info ] [Thread-1 (]: 8 of 25 START test not_null_fct_orders_order_id ................................ [RUN]
[0m21:26:23.002299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655, now test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m21:26:23.002299 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09, now test.olist_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m21:26:23.003298 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81, now test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b)
[0m21:26:23.003793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460, now test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0)
[0m21:26:23.004329 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:26:23.004329 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:26:23.004329 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:26:23.005334 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:26:23.010131 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:26:23.010131 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:26:23.016332 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:26:23.020641 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:26:23.020641 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:26:23.020641 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:26:23.022650 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:26:23.025161 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:26:23.025161 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:26:23.028799 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:26:23.030443 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:26:23.036458 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:26:23.039335 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:26:23.041349 [debug] [Thread-2 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m21:26:23.041349 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:26:23.043359 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:23.043359 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:26:23.045368 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:26:23.045368 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m21:26:23.047377 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:26:23.048139 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m21:26:23.050853 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m21:26:23.051360 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:23.053564 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:26:23.055575 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:26:23.055575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:23.057585 [debug] [Thread-2 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_marts"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.057585 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m21:26:23.059096 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:26:23.059096 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:26:23.061216 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:26:23.061216 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:26:23.061216 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:26:23.061216 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:26:23.061216 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "olist"."main_marts"."dim_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.067268 [debug] [Thread-2 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m21:26:23.069158 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_marts"."fct_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.069691 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_marts"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.070781 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m21:26:23.071308 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:23.072370 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:26:23.072894 [debug] [Thread-2 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m21:26:23.073421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:23.073952 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m21:26:23.075958 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m21:26:23.075958 [info ] [Thread-2 (]: 5 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.07s]
[0m21:26:23.077961 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m21:26:23.078719 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_dim_products_product_id.c8aba288d1'
[0m21:26:23.079791 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b'
[0m21:26:23.080802 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:26:23.081800 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0'
[0m21:26:23.083311 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: Close
[0m21:26:23.083829 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m21:26:23.084863 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:26:23.084863 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: Close
[0m21:26:23.086375 [info ] [Thread-3 (]: 6 of 25 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.08s]
[0m21:26:23.086375 [info ] [Thread-4 (]: 7 of 25 PASS not_null_fct_orders_customer_id ................................... [[32mPASS[0m in 0.08s]
[0m21:26:23.087382 [info ] [Thread-2 (]: 9 of 25 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m21:26:23.088381 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:26:23.087382 [info ] [Thread-1 (]: 8 of 25 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.08s]
[0m21:26:23.088381 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:26:23.089380 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:26:23.089380 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:26:23.090383 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:26:23.091020 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:26:23.091020 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:26:23.092026 [info ] [Thread-3 (]: 10 of 25 START test not_null_stg_customers_customer_unique_id .................. [RUN]
[0m21:26:23.092026 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:26:23.092675 [info ] [Thread-4 (]: 11 of 25 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m21:26:23.096482 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:26:23.097466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_dim_products_product_id.c8aba288d1, now test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba)
[0m21:26:23.097466 [info ] [Thread-1 (]: 12 of 25 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m21:26:23.098467 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b, now test.olist_analytics.not_null_stg_order_items_order_id.2063801f96)
[0m21:26:23.099471 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:26:23.099471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0, now test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m21:26:23.099471 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:26:23.100821 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:26:23.103837 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:26:23.103837 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:26:23.105837 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:26:23.109057 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:26:23.109748 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:26:23.109748 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:26:23.109748 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:26:23.109748 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:26:23.116310 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:26:23.116310 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:26:23.117247 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:26:23.117247 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:26:23.117247 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:26:23.117247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:23.117247 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:26:23.117247 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:26:23.117247 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:26:23.117247 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m21:26:23.117247 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:26:23.117247 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m21:26:23.117247 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m21:26:23.117247 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:23.128516 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:26:23.128516 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:26:23.128516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:23.129554 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_staging"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.129554 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.130538 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.130538 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.131523 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:26:23.132524 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:26:23.132524 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.132524 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:26:23.132524 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "olist"."main_staging"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.134029 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.135033 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:26:23.135033 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from "olist"."main_staging"."stg_order_items"
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.136617 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m21:26:23.136617 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:23.136617 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:26:23.136617 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:26:23.136617 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m21:26:23.136617 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.136617 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m21:26:23.136617 [info ] [Thread-2 (]: 9 of 25 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.05s]
[0m21:26:23.136617 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba'
[0m21:26:23.136617 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m21:26:23.136617 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_items_order_id.2063801f96'
[0m21:26:23.136617 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:26:23.136617 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m21:26:23.136617 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m21:26:23.136617 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: Close
[0m21:26:23.136617 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:26:23.136617 [info ] [Thread-3 (]: 10 of 25 PASS not_null_stg_customers_customer_unique_id ........................ [[32mPASS[0m in 0.04s]
[0m21:26:23.136617 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m21:26:23.146931 [info ] [Thread-4 (]: 11 of 25 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.05s]
[0m21:26:23.147278 [info ] [Thread-2 (]: 13 of 25 START test not_null_stg_order_payments_order_id ....................... [RUN]
[0m21:26:23.148473 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:26:23.149474 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:26:23.149474 [info ] [Thread-1 (]: 12 of 25 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.05s]
[0m21:26:23.150471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7)
[0m21:26:23.151458 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:26:23.151458 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:26:23.152517 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:26:23.152517 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:26:23.152517 [info ] [Thread-3 (]: 14 of 25 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m21:26:23.152517 [info ] [Thread-4 (]: 15 of 25 START test not_null_stg_orders_order_id ............................... [RUN]
[0m21:26:23.154356 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:26:23.157362 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:26:23.157828 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba, now test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5)
[0m21:26:23.157828 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_items_order_id.2063801f96, now test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:26:23.158845 [info ] [Thread-1 (]: 16 of 25 START test not_null_stg_products_product_id ........................... [RUN]
[0m21:26:23.159349 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:26:23.159770 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:26:23.159770 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:26:23.159770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.olist_analytics.not_null_stg_products_product_id.6373b0acf3)
[0m21:26:23.162940 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:26:23.167914 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:26:23.167914 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:26:23.167914 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:26:23.167914 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:26:23.167914 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:26:23.167914 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:26:23.167914 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:26:23.167914 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:26:23.167914 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:26:23.167914 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: BEGIN
[0m21:26:23.167914 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:26:23.167914 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:26:23.167914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:23.167914 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:26:23.183721 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:26:23.184802 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m21:26:23.185776 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m21:26:23.185776 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:26:23.185776 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:23.186775 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:26:23.186775 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:26:23.186775 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:26:23.188093 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.188093 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.188093 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m21:26:23.189114 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_order_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.189114 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:26:23.189114 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:26:23.189114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:23.189114 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_staging"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.189114 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.189114 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:26:23.189114 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.189114 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: ROLLBACK
[0m21:26:23.189114 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.189114 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.189114 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:26:23.189114 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7'
[0m21:26:23.189114 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m21:26:23.189114 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m21:26:23.189114 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "olist"."main_staging"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.189114 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: Close
[0m21:26:23.189114 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5'
[0m21:26:23.198685 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64'
[0m21:26:23.199694 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m21:26:23.199694 [info ] [Thread-2 (]: 13 of 25 PASS not_null_stg_order_payments_order_id ............................. [[32mPASS[0m in 0.05s]
[0m21:26:23.200493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:23.200493 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m21:26:23.200493 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:26:23.200493 [info ] [Thread-3 (]: 14 of 25 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.04s]
[0m21:26:23.200493 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m21:26:23.200493 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:26:23.200493 [info ] [Thread-4 (]: 15 of 25 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.04s]
[0m21:26:23.200493 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:26:23.200493 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_stg_products_product_id.6373b0acf3'
[0m21:26:23.200493 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:26:23.200493 [info ] [Thread-2 (]: 17 of 25 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m21:26:23.206280 [debug] [Thread-3 (]: Began running node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:26:23.206280 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: Close
[0m21:26:23.206280 [debug] [Thread-4 (]: Began running node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:26:23.207285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7, now test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315)
[0m21:26:23.207285 [info ] [Thread-3 (]: 18 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m21:26:23.208284 [info ] [Thread-1 (]: 16 of 25 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.05s]
[0m21:26:23.208284 [info ] [Thread-4 (]: 19 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m21:26:23.208284 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:26:23.209285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5, now test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m21:26:23.209285 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:26:23.209285 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m21:26:23.211450 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:26:23.211450 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:26:23.211450 [debug] [Thread-1 (]: Began running node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:26:23.211450 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:26:23.215469 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:26:23.221813 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:26:23.221813 [info ] [Thread-1 (]: 20 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m21:26:23.226483 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:26:23.228483 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:26:23.228483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_products_product_id.6373b0acf3, now test.olist_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m21:26:23.228483 [debug] [Thread-3 (]: Began executing node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:26:23.228483 [debug] [Thread-4 (]: Began executing node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:26:23.228483 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:26:23.231375 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:26:23.233777 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:26:23.236576 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:26:23.236576 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:26:23.236576 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m21:26:23.236576 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:26:23.236576 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:26:23.236576 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:23.236576 [debug] [Thread-1 (]: Began executing node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:26:23.236576 [debug] [Thread-3 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m21:26:23.236576 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m21:26:23.236576 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:26:23.236576 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:26:23.236576 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:23.236576 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:26:23.236576 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:26:23.246211 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:26:23.246832 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.247508 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "olist"."main_staging"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.247508 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.248621 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m21:26:23.248621 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:26:23.249632 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:26:23.250756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:23.250756 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:26:23.250756 [debug] [Thread-3 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "olist"."main_marts"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "olist"."main_marts"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:26:23.251850 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:26:23.252814 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m21:26:23.253812 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:26:23.253812 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315'
[0m21:26:23.254814 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:26:23.254814 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m21:26:23.255814 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:26:23.255814 [info ] [Thread-2 (]: 17 of 25 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.05s]
[0m21:26:23.255814 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:26:23.255814 [debug] [Thread-2 (]: Began running node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:26:23.255814 [info ] [Thread-2 (]: 21 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m21:26:23.259743 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315, now test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5)
[0m21:26:23.259743 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:26:23.265344 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:26:23.266958 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:26:23.267625 [debug] [Thread-2 (]: Began executing node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:26:23.269694 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m21:26:23.272692 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:26:23.272692 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m21:26:23.272692 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.unique_dim_products_product_id.ef7b2a9985'
[0m21:26:23.272692 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:26:23.272692 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m21:26:23.272692 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: Close
[0m21:26:23.272692 [debug] [Thread-2 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m21:26:23.272692 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd'
[0m21:26:23.272692 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m21:26:23.272692 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:23.272692 [info ] [Thread-1 (]: 20 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m21:26:23.272692 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m21:26:23.280068 [debug] [Thread-1 (]: Finished running node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:26:23.281074 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.283075 [debug] [Thread-3 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m21:26:23.284074 [debug] [Thread-1 (]: Began running node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:26:23.283075 [info ] [Thread-4 (]: 19 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.07s]
[0m21:26:23.284497 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:26:23.284497 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4'
[0m21:26:23.285554 [info ] [Thread-1 (]: 22 of 25 START test unique_stg_customers_customer_id ........................... [RUN]
[0m21:26:23.286553 [debug] [Thread-4 (]: Finished running node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:26:23.286553 [debug] [Thread-2 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:26:23.286553 [debug] [Thread-3 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m21:26:23.287729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_dim_products_product_id.ef7b2a9985, now test.olist_analytics.unique_stg_customers_customer_id.c7614daada)
[0m21:26:23.287729 [debug] [Thread-4 (]: Began running node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:26:23.288427 [info ] [Thread-3 (]: 18 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.08s]
[0m21:26:23.289435 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:26:23.289435 [info ] [Thread-4 (]: 23 of 25 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:26:23.289435 [debug] [Thread-3 (]: Finished running node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:26:23.292434 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:26:23.292434 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.olist_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m21:26:23.292434 [debug] [Thread-3 (]: Began running node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:26:23.292434 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:26:23.292434 [debug] [Thread-1 (]: Began executing node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:26:23.292434 [info ] [Thread-3 (]: 24 of 25 START test unique_stg_products_product_id ............................. [RUN]
[0m21:26:23.301086 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:26:23.302496 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:26:23.305099 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.olist_analytics.unique_stg_products_product_id.7d950a1467)
[0m21:26:23.305624 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m21:26:23.306142 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:26:23.306142 [debug] [Thread-4 (]: Began executing node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:26:23.306142 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:26:23.306142 [debug] [Thread-2 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m21:26:23.309844 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:26:23.309844 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:26:23.309844 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:26:23.309844 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5'
[0m21:26:23.315219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:23.316229 [debug] [Thread-3 (]: Began executing node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:26:23.316810 [debug] [Thread-2 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: Close
[0m21:26:23.316810 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:26:23.316810 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:26:23.316810 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:26:23.316810 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m21:26:23.316810 [info ] [Thread-2 (]: 21 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.06s]
[0m21:26:23.316810 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:26:23.316810 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:26:23.316810 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:26:23.316810 [debug] [Thread-2 (]: Finished running node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:26:23.316810 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:26:23.316810 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: BEGIN
[0m21:26:23.316810 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.316810 [debug] [Thread-2 (]: Began running node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:26:23.316810 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:23.316810 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:26:23.327135 [info ] [Thread-2 (]: 25 of 25 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m21:26:23.327869 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:26:23.328223 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:26:23.328223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5, now test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m21:26:23.328938 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:26:23.329606 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:26:23.329606 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:26:23.332613 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:26:23.335144 [debug] [Thread-2 (]: Began executing node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:26:23.338999 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:26:23.342139 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:26:23.343195 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m21:26:23.343711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:23.343711 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m21:26:23.345572 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:26:23.348059 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:26:23.348740 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:26:23.349910 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.unique_stg_customers_customer_id.c7614daada'
[0m21:26:23.350443 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m21:26:23.350985 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:26:23.351661 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: Close
[0m21:26:23.353688 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m21:26:23.353688 [debug] [Thread-4 (]: SQL status: OK in 0.026 seconds
[0m21:26:23.353688 [info ] [Thread-1 (]: 22 of 25 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.07s]
[0m21:26:23.353688 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.unique_stg_products_product_id.7d950a1467'
[0m21:26:23.353688 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m21:26:23.353688 [debug] [Thread-1 (]: Finished running node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:26:23.359284 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:26:23.359284 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: Close
[0m21:26:23.359994 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.unique_stg_orders_order_id.e3b841c71a'
[0m21:26:23.359994 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m21:26:23.363093 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m21:26:23.359994 [info ] [Thread-3 (]: 24 of 25 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.06s]
[0m21:26:23.363744 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8'
[0m21:26:23.364721 [debug] [Thread-3 (]: Finished running node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:26:23.363744 [info ] [Thread-4 (]: 23 of 25 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.07s]
[0m21:26:23.365365 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m21:26:23.366372 [debug] [Thread-4 (]: Finished running node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:26:23.367372 [info ] [Thread-2 (]: 25 of 25 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.04s]
[0m21:26:23.367372 [debug] [Thread-2 (]: Finished running node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:26:23.368410 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:23.369416 [debug] [MainThread]: On master: BEGIN
[0m21:26:23.369416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:23.370417 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:26:23.370417 [debug] [MainThread]: On master: COMMIT
[0m21:26:23.370417 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:23.371414 [debug] [MainThread]: On master: COMMIT
[0m21:26:23.371414 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:26:23.371414 [debug] [MainThread]: On master: Close
[0m21:26:23.372439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:23.372439 [debug] [MainThread]: Connection 'list_olist_main_marts' was properly closed.
[0m21:26:23.372439 [debug] [MainThread]: Connection 'list_olist_main_staging' was properly closed.
[0m21:26:23.372439 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m21:26:23.373414 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m21:26:23.373414 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m21:26:23.373414 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m21:26:23.374414 [info ] [MainThread]: 
[0m21:26:23.374414 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m21:26:23.376431 [debug] [MainThread]: Command end result
[0m21:26:23.400155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:26:23.402050 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:26:23.402050 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\run_results.json
[0m21:26:23.402050 [info ] [MainThread]: 
[0m21:26:23.409315 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:23.409315 [info ] [MainThread]: 
[0m21:26:23.409315 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m21:26:23.409315 [debug] [MainThread]: Command `dbt test` succeeded at 21:26:23.409315 after 1.29 seconds
[0m21:26:23.409315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230629F7D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230629F7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230629F7D10>]}
[0m21:26:23.409315 [debug] [MainThread]: Flushing usage events
[0m21:26:24.786829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:45.492407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B5FCFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B27CA310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B5FCFD10>]}


============================== 21:29:45.495528 | 81cb620f-da39-433a-ad60-fe86263780f8 ==============================
[0m21:29:45.495528 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:29:45.495528 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:29:45.659424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B60A0B90>]}
[0m21:29:45.695253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B27F4450>]}
[0m21:29:45.695253 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:29:45.873359 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m21:29:45.972354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:45.973338 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:29:45.973338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:46.022714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B75DA110>]}
[0m21:29:46.093009 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:29:46.095413 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:29:46.146652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B2A85B50>]}
[0m21:29:46.146652 [info ] [MainThread]: Found 12 models, 25 data tests, 9 sources, 586 macros
[0m21:29:46.147711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B2A87850>]}
[0m21:29:46.148153 [info ] [MainThread]: 
[0m21:29:46.148153 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:29:46.151900 [info ] [MainThread]: 
[0m21:29:46.151900 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:29:46.156009 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m21:29:46.156993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m21:29:46.209470 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m21:29:46.209470 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m21:29:46.211207 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"olist"'
    
  
  
[0m21:29:46.212213 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"olist"'
    
  
  
[0m21:29:46.212213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:46.213213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:46.226381 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:29:46.226381 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:29:46.227904 [debug] [ThreadPool]: On list_olist: Close
[0m21:29:46.229508 [debug] [ThreadPool]: On list_olist: Close
[0m21:29:46.230514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_main_staging)
[0m21:29:46.231514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_main_marts)
[0m21:29:46.231514 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "main_staging"
"
[0m21:29:46.231514 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "main_marts"
"
[0m21:29:46.236898 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:29:46.239454 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:29:46.239454 [debug] [ThreadPool]: On create_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='olist'
        and type='sqlite'
    
  
[0m21:29:46.239454 [debug] [ThreadPool]: On create_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='olist'
        and type='sqlite'
    
  
[0m21:29:46.239454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:46.239454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:46.239454 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:29:46.239454 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:29:46.239454 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:29:46.239454 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:29:46.244972 [debug] [ThreadPool]: On create_olist_main_staging: BEGIN
[0m21:29:46.245570 [debug] [ThreadPool]: On create_olist_main_marts: BEGIN
[0m21:29:46.246579 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:46.246579 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:46.247583 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:29:46.247583 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:29:46.247583 [debug] [ThreadPool]: On create_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_staging"} */

    
    
        create schema if not exists "olist"."main_staging"
    
[0m21:29:46.248576 [debug] [ThreadPool]: On create_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_main_marts"} */

    
    
        create schema if not exists "olist"."main_marts"
    
[0m21:29:46.249504 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:29:46.250194 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:29:46.250194 [debug] [ThreadPool]: On create_olist_main_staging: COMMIT
[0m21:29:46.250194 [debug] [ThreadPool]: On create_olist_main_marts: COMMIT
[0m21:29:46.250194 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_staging"
[0m21:29:46.250194 [debug] [ThreadPool]: Using duckdb connection "create_olist_main_marts"
[0m21:29:46.250194 [debug] [ThreadPool]: On create_olist_main_staging: COMMIT
[0m21:29:46.250194 [debug] [ThreadPool]: On create_olist_main_marts: COMMIT
[0m21:29:46.250194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:46.250194 [debug] [ThreadPool]: On create_olist_main_staging: Close
[0m21:29:46.250194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:46.250194 [debug] [ThreadPool]: On create_olist_main_marts: Close
[0m21:29:46.250194 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_staging'
[0m21:29:46.250194 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_marts'
[0m21:29:46.261638 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:29:46.263643 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:29:46.265396 [debug] [ThreadPool]: On list_olist_main_staging: BEGIN
[0m21:29:46.265396 [debug] [ThreadPool]: On list_olist_main_marts: BEGIN
[0m21:29:46.265396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:46.265396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:46.265396 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:29:46.265396 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:29:46.265396 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:29:46.265396 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:29:46.265396 [debug] [ThreadPool]: On list_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'olist'
  
[0m21:29:46.265396 [debug] [ThreadPool]: On list_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_marts"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'olist'
  
[0m21:29:46.281107 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:29:46.282084 [debug] [ThreadPool]: On list_olist_main_marts: ROLLBACK
[0m21:29:46.282084 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:29:46.283083 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_marts'
[0m21:29:46.284083 [debug] [ThreadPool]: On list_olist_main_staging: ROLLBACK
[0m21:29:46.284083 [debug] [ThreadPool]: On list_olist_main_marts: Close
[0m21:29:46.285110 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_staging'
[0m21:29:46.286115 [debug] [ThreadPool]: On list_olist_main_staging: Close
[0m21:29:46.288075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B7621610>]}
[0m21:29:46.289105 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:46.289105 [debug] [MainThread]: On master: BEGIN
[0m21:29:46.289105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:46.290079 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:29:46.290079 [debug] [MainThread]: On master: COMMIT
[0m21:29:46.290079 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:46.291079 [debug] [MainThread]: On master: COMMIT
[0m21:29:46.291079 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:29:46.291079 [debug] [MainThread]: On master: Close
[0m21:29:46.295784 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m21:29:46.295784 [debug] [Thread-2 (]: Began running node model.olist_analytics.stg_geolocation
[0m21:29:46.295784 [debug] [Thread-3 (]: Began running node model.olist_analytics.stg_order_items
[0m21:29:46.295784 [debug] [Thread-4 (]: Began running node model.olist_analytics.stg_order_payments
[0m21:29:46.295784 [info ] [Thread-1 (]: 1 of 12 START sql view model main_staging.stg_customers ........................ [RUN]
[0m21:29:46.295784 [info ] [Thread-2 (]: 2 of 12 START sql view model main_staging.stg_geolocation ...................... [RUN]
[0m21:29:46.295784 [info ] [Thread-3 (]: 3 of 12 START sql view model main_staging.stg_order_items ...................... [RUN]
[0m21:29:46.295784 [info ] [Thread-4 (]: 4 of 12 START sql view model main_staging.stg_order_payments ................... [RUN]
[0m21:29:46.295784 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_customers'
[0m21:29:46.300645 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_geolocation'
[0m21:29:46.300645 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_order_items'
[0m21:29:46.300645 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_analytics.stg_order_payments'
[0m21:29:46.302650 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m21:29:46.302650 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m21:29:46.302650 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.stg_order_items
[0m21:29:46.302650 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m21:29:46.309104 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m21:29:46.312236 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m21:29:46.314290 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m21:29:46.316799 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m21:29:46.317799 [debug] [Thread-2 (]: Began executing node model.olist_analytics.stg_geolocation
[0m21:29:46.318800 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m21:29:46.339398 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m21:29:46.339398 [debug] [Thread-3 (]: Began executing node model.olist_analytics.stg_order_items
[0m21:29:46.339398 [debug] [Thread-4 (]: Began executing node model.olist_analytics.stg_order_payments
[0m21:29:46.339398 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m21:29:46.347931 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m21:29:46.347931 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:29:46.347931 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m21:29:46.347931 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: BEGIN
[0m21:29:46.347931 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:29:46.347931 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:29:46.347931 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:29:46.347931 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:29:46.347931 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: BEGIN
[0m21:29:46.347931 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: BEGIN
[0m21:29:46.347931 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: BEGIN
[0m21:29:46.347931 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.347931 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:46.347931 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:29:46.347931 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:29:46.347931 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:29:46.347931 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.347931 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.347931 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.359244 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */

  
  create view "olist"."main_staging"."stg_geolocation__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_geolocation"
),

renamed as (
    select
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed
  );

[0m21:29:46.359244 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:29:46.359244 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:29:46.359244 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:29:46.359244 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */

  
  create view "olist"."main_staging"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_customers"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );

[0m21:29:46.361106 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */

  
  create view "olist"."main_staging"."stg_order_items__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_items"
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_limit_at,
        price,
        freight_value
    from source
)

select * from renamed
  );

[0m21:29:46.361106 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.362112 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */

  
  create view "olist"."main_staging"."stg_order_payments__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_payments"
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed
  );

[0m21:29:46.367596 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:29:46.367596 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:29:46.367596 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m21:29:46.367596 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */
alter view "olist"."main_staging"."stg_geolocation" rename to "stg_geolocation__dbt_backup"
[0m21:29:46.369998 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.370538 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:29:46.370538 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:29:46.370538 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:29:46.378113 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:29:46.370538 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */
alter view "olist"."main_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:29:46.379141 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */
alter view "olist"."main_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m21:29:46.379141 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */
alter view "olist"."main_staging"."stg_order_payments" rename to "stg_order_payments__dbt_backup"
[0m21:29:46.382530 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:29:46.382530 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.382530 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.384035 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */
alter view "olist"."main_staging"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m21:29:46.384035 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.386717 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:29:46.386717 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:29:46.386717 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:29:46.392656 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */
alter view "olist"."main_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:29:46.392656 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:29:46.393444 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */
alter view "olist"."main_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m21:29:46.393444 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */
alter view "olist"."main_staging"."stg_order_payments__dbt_tmp" rename to "stg_order_payments"
[0m21:29:46.399021 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: COMMIT
[0m21:29:46.399021 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m21:29:46.399021 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.399021 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:29:46.399021 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.399021 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: COMMIT
[0m21:29:46.399021 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: COMMIT
[0m21:29:46.399021 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: COMMIT
[0m21:29:46.409225 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: COMMIT
[0m21:29:46.409598 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:29:46.410102 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:29:46.410102 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:29:46.411183 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: COMMIT
[0m21:29:46.411183 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: COMMIT
[0m21:29:46.445737 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: COMMIT
[0m21:29:46.445737 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m21:29:46.451356 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_geolocation"
[0m21:29:46.451356 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:29:46.452367 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:29:46.452367 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */

      drop view if exists "olist"."main_staging"."stg_geolocation__dbt_backup" cascade
    
[0m21:29:46.452986 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m21:29:46.454989 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_customers"
[0m21:29:46.455991 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_order_items"
[0m21:29:46.459681 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_order_payments"
[0m21:29:46.459681 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.460235 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */

      drop view if exists "olist"."main_staging"."stg_customers__dbt_backup" cascade
    
[0m21:29:46.460235 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */

      drop view if exists "olist"."main_staging"."stg_order_items__dbt_backup" cascade
    
[0m21:29:46.461235 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */

      drop view if exists "olist"."main_staging"."stg_order_payments__dbt_backup" cascade
    
[0m21:29:46.463565 [debug] [Thread-2 (]: On model.olist_analytics.stg_geolocation: Close
[0m21:29:46.465616 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.465616 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.465616 [debug] [Thread-3 (]: On model.olist_analytics.stg_order_items: Close
[0m21:29:46.465616 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: Close
[0m21:29:46.465616 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B7ACF750>]}
[0m21:29:46.465616 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:29:46.465616 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B7A7C910>]}
[0m21:29:46.465616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B7BFAB50>]}
[0m21:29:46.465616 [debug] [Thread-4 (]: On model.olist_analytics.stg_order_payments: Close
[0m21:29:46.465616 [info ] [Thread-2 (]: 2 of 12 OK created sql view model main_staging.stg_geolocation ................. [[32mOK[0m in 0.16s]
[0m21:29:46.465616 [info ] [Thread-3 (]: 3 of 12 OK created sql view model main_staging.stg_order_items ................. [[32mOK[0m in 0.16s]
[0m21:29:46.465616 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main_staging.stg_customers ................... [[32mOK[0m in 0.17s]
[0m21:29:46.465616 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B7BAD390>]}
[0m21:29:46.465616 [debug] [Thread-2 (]: Finished running node model.olist_analytics.stg_geolocation
[0m21:29:46.465616 [debug] [Thread-3 (]: Finished running node model.olist_analytics.stg_order_items
[0m21:29:46.465616 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m21:29:46.465616 [debug] [Thread-2 (]: Began running node model.olist_analytics.stg_order_reviews
[0m21:29:46.465616 [info ] [Thread-4 (]: 4 of 12 OK created sql view model main_staging.stg_order_payments .............. [[32mOK[0m in 0.16s]
[0m21:29:46.465616 [debug] [Thread-3 (]: Began running node model.olist_analytics.stg_orders
[0m21:29:46.465616 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_translation
[0m21:29:46.465616 [info ] [Thread-2 (]: 5 of 12 START sql view model main_staging.stg_order_reviews .................... [RUN]
[0m21:29:46.478632 [debug] [Thread-4 (]: Finished running node model.olist_analytics.stg_order_payments
[0m21:29:46.479638 [info ] [Thread-3 (]: 6 of 12 START sql view model main_staging.stg_orders ........................... [RUN]
[0m21:29:46.479638 [info ] [Thread-1 (]: 7 of 12 START sql view model main_staging.stg_product_category_translation ..... [RUN]
[0m21:29:46.480664 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_reviews)
[0m21:29:46.480664 [debug] [Thread-4 (]: Began running node model.olist_analytics.stg_products
[0m21:29:46.481637 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_orders)
[0m21:29:46.481637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_product_category_translation)
[0m21:29:46.481637 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m21:29:46.482637 [info ] [Thread-4 (]: 8 of 12 START sql view model main_staging.stg_products ......................... [RUN]
[0m21:29:46.482637 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.stg_orders
[0m21:29:46.483637 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_translation
[0m21:29:46.485065 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m21:29:46.486590 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_products)
[0m21:29:46.488603 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m21:29:46.490620 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_translation"
[0m21:29:46.491603 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.stg_products
[0m21:29:46.491603 [debug] [Thread-2 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m21:29:46.492603 [debug] [Thread-3 (]: Began executing node model.olist_analytics.stg_orders
[0m21:29:46.497266 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m21:29:46.497266 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_translation
[0m21:29:46.497971 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m21:29:46.497971 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m21:29:46.497971 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_translation"
[0m21:29:46.497971 [debug] [Thread-4 (]: Began executing node model.olist_analytics.stg_products
[0m21:29:46.497971 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:29:46.509029 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m21:29:46.509029 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:29:46.509029 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:29:46.511235 [debug] [Thread-2 (]: On model.olist_analytics.stg_order_reviews: BEGIN
[0m21:29:46.512242 [debug] [Thread-3 (]: On model.olist_analytics.stg_orders: BEGIN
[0m21:29:46.512242 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:29:46.513241 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_translation: BEGIN
[0m21:29:46.513818 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:29:46.515199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:46.515199 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: BEGIN
[0m21:29:46.515199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:46.516241 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:29:46.517206 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:29:46.517206 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:29:46.518204 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.518204 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:29:46.518204 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:29:46.519207 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.519207 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:29:46.519207 [debug] [Thread-2 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */

  
  create view "olist"."main_staging"."stg_order_reviews__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_order_reviews"
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        review_creation_date as review_created_at,
        review_answer_timestamp as review_answered_at
    from source
)

select * from renamed
  );

[0m21:29:46.519207 [debug] [Thread-3 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */

  
  create view "olist"."main_staging"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_orders"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as order_purchase_at,
        order_approved_at,
        order_delivered_carrier_date as order_delivered_carrier_at,
        order_delivered_customer_date as order_delivered_customer_at,
        order_estimated_delivery_date as order_estimated_delivery_at
    from source
)

select * from renamed
  );

[0m21:29:46.519207 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:29:46.519207 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */

  
  create view "olist"."main_staging"."stg_product_category_translation__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_product_category_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );

[0m21:29:46.519207 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */

  
  create view "olist"."main_staging"."stg_products__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_products"
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as product_name_length,
        product_description_lenght as product_description_length,
        product_photos_qty,
        product_weight_g,
        product_length_cm,
        product_height_cm,
        product_width_cm
    from source
)

select * from renamed
  );

[0m21:29:46.519207 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.519207 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.519207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.519207 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.519207 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:29:46.529421 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:29:46.530395 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:29:46.533985 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:29:46.533985 [debug] [Thread-3 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */
alter view "olist"."main_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:29:46.533985 [debug] [Thread-2 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */
alter view "olist"."main_staging"."stg_order_reviews" rename to "stg_order_reviews__dbt_backup"
[0m21:29:46.533985 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */
alter view "olist"."main_staging"."stg_product_category_translation" rename to "stg_product_category_translation__dbt_backup"
[0m21:29:46.533985 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */
alter view "olist"."main_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m21:29:46.536751 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.536751 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.536751 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.536751 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.540435 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:29:46.540435 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:29:46.547097 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:29:46.547485 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:29:46.547485 [debug] [Thread-3 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */
alter view "olist"."main_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:29:46.547485 [debug] [Thread-2 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */
alter view "olist"."main_staging"."stg_order_reviews__dbt_tmp" rename to "stg_order_reviews"
[0m21:29:46.547485 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */
alter view "olist"."main_staging"."stg_product_category_translation__dbt_tmp" rename to "stg_product_category_translation"
[0m21:29:46.547485 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */
alter view "olist"."main_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:29:46.547485 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.547485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.547485 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.547485 [debug] [Thread-3 (]: On model.olist_analytics.stg_orders: COMMIT
[0m21:29:46.547485 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.547485 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_translation: COMMIT
[0m21:29:46.547485 [debug] [Thread-2 (]: On model.olist_analytics.stg_order_reviews: COMMIT
[0m21:29:46.547485 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:29:46.547485 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: COMMIT
[0m21:29:46.559221 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:29:46.559221 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:29:46.559221 [debug] [Thread-3 (]: On model.olist_analytics.stg_orders: COMMIT
[0m21:29:46.559221 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:29:46.561131 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_translation: COMMIT
[0m21:29:46.561131 [debug] [Thread-2 (]: On model.olist_analytics.stg_order_reviews: COMMIT
[0m21:29:46.563137 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: COMMIT
[0m21:29:46.595012 [debug] [Thread-3 (]: SQL status: OK in 0.032 seconds
[0m21:29:46.595478 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m21:29:46.595478 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m21:29:46.597859 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_orders"
[0m21:29:46.597859 [debug] [Thread-4 (]: SQL status: OK in 0.034 seconds
[0m21:29:46.600401 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.stg_product_category_translation"
[0m21:29:46.602379 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.stg_order_reviews"
[0m21:29:46.602379 [debug] [Thread-3 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */

      drop view if exists "olist"."main_staging"."stg_orders__dbt_backup" cascade
    
[0m21:29:46.604379 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.stg_products"
[0m21:29:46.604379 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_translation: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_translation"} */

      drop view if exists "olist"."main_staging"."stg_product_category_translation__dbt_backup" cascade
    
[0m21:29:46.605412 [debug] [Thread-2 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */

      drop view if exists "olist"."main_staging"."stg_order_reviews__dbt_backup" cascade
    
[0m21:29:46.606378 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */

      drop view if exists "olist"."main_staging"."stg_products__dbt_backup" cascade
    
[0m21:29:46.606378 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.608380 [debug] [Thread-3 (]: On model.olist_analytics.stg_orders: Close
[0m21:29:46.608380 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.608380 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.609378 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B8D17A50>]}
[0m21:29:46.609882 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.610924 [debug] [Thread-2 (]: On model.olist_analytics.stg_order_reviews: Close
[0m21:29:46.612254 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_translation: Close
[0m21:29:46.613859 [info ] [Thread-3 (]: 6 of 12 OK created sql view model main_staging.stg_orders ...................... [[32mOK[0m in 0.13s]
[0m21:29:46.615478 [debug] [Thread-4 (]: On model.olist_analytics.stg_products: Close
[0m21:29:46.616487 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B8D2A5D0>]}
[0m21:29:46.616487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B8D2A7D0>]}
[0m21:29:46.617486 [debug] [Thread-3 (]: Finished running node model.olist_analytics.stg_orders
[0m21:29:46.618486 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B7B00F50>]}
[0m21:29:46.619492 [info ] [Thread-2 (]: 5 of 12 OK created sql view model main_staging.stg_order_reviews ............... [[32mOK[0m in 0.14s]
[0m21:29:46.621494 [debug] [Thread-3 (]: Began running node model.olist_analytics.stg_sellers
[0m21:29:46.620493 [info ] [Thread-1 (]: 7 of 12 OK created sql view model main_staging.stg_product_category_translation  [[32mOK[0m in 0.13s]
[0m21:29:46.621494 [info ] [Thread-4 (]: 8 of 12 OK created sql view model main_staging.stg_products .................... [[32mOK[0m in 0.13s]
[0m21:29:46.622498 [debug] [Thread-2 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m21:29:46.623492 [info ] [Thread-3 (]: 9 of 12 START sql view model main_staging.stg_sellers .......................... [RUN]
[0m21:29:46.623492 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_translation
[0m21:29:46.624492 [debug] [Thread-4 (]: Finished running node model.olist_analytics.stg_products
[0m21:29:46.624492 [debug] [Thread-2 (]: Began running node model.olist_analytics.dim_customers
[0m21:29:46.625492 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_sellers)
[0m21:29:46.625492 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_orders
[0m21:29:46.626494 [debug] [Thread-4 (]: Began running node model.olist_analytics.dim_products
[0m21:29:46.626494 [info ] [Thread-2 (]: 10 of 12 START sql table model main_marts.dim_customers ........................ [RUN]
[0m21:29:46.627495 [debug] [Thread-3 (]: Began compiling node model.olist_analytics.stg_sellers
[0m21:29:46.628496 [info ] [Thread-1 (]: 11 of 12 START sql table model main_marts.fct_orders ........................... [RUN]
[0m21:29:46.630115 [info ] [Thread-4 (]: 12 of 12 START sql table model main_marts.dim_products ......................... [RUN]
[0m21:29:46.631133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.dim_customers)
[0m21:29:46.633134 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m21:29:46.634133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_translation, now model.olist_analytics.fct_orders)
[0m21:29:46.635291 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.dim_products)
[0m21:29:46.635291 [debug] [Thread-2 (]: Began compiling node model.olist_analytics.dim_customers
[0m21:29:46.636798 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_orders
[0m21:29:46.636798 [debug] [Thread-4 (]: Began compiling node model.olist_analytics.dim_products
[0m21:29:46.636798 [debug] [Thread-3 (]: Began executing node model.olist_analytics.stg_sellers
[0m21:29:46.640356 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m21:29:46.643389 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m21:29:46.647010 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m21:29:46.650550 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m21:29:46.651550 [debug] [Thread-2 (]: Began executing node model.olist_analytics.dim_customers
[0m21:29:46.651550 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_orders
[0m21:29:46.651550 [debug] [Thread-4 (]: Began executing node model.olist_analytics.dim_products
[0m21:29:46.667569 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m21:29:46.668548 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:29:46.669552 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m21:29:46.669552 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m21:29:46.669552 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: BEGIN
[0m21:29:46.669552 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:29:46.669552 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:29:46.669552 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:46.669552 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:29:46.669552 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: BEGIN
[0m21:29:46.669552 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: BEGIN
[0m21:29:46.669552 [debug] [Thread-4 (]: On model.olist_analytics.dim_products: BEGIN
[0m21:29:46.677720 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.678306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:29:46.679319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:46.679319 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:29:46.680313 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:29:46.680723 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.680723 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:29:46.680723 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:29:46.680723 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */

  
  create view "olist"."main_staging"."stg_sellers__dbt_tmp" as (
    with source as (
    select * from "olist"."main"."bronze_sellers"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed
  );

[0m21:29:46.683875 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:29:46.683875 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:29:46.683875 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:29:46.683875 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    
    

    create  table
      "olist"."main_marts"."dim_customers__dbt_tmp"
  
    as (
      with customers as (
    select * from "olist"."main_staging"."stg_customers"
),

geolocation as (
    select * from "olist"."main_staging"."stg_geolocation"
),

-- We might want to join exact location data later, but for now 
-- a simple dimension table from staging is a good start.
final as (
    select
        customer_id,
        customer_unique_id,
        zip_code,
        city,
        state
    from customers
)

select * from final
    );
  
  
[0m21:29:46.683875 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.683875 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    
    

    create  table
      "olist"."main_marts"."fct_orders__dbt_tmp"
  
    as (
      with orders as (
    select * from "olist"."main_staging"."stg_orders"
),

order_items as (
    select * from "olist"."main_staging"."stg_order_items"
),

order_payments as (
    select * from "olist"."main_staging"."stg_order_payments"
),

-- Aggregating items per order
order_items_agg as (
    select
        order_id,
        count(order_item_id) as total_items,
        sum(price) as total_item_value,
        sum(freight_value) as total_freight_value
    from order_items
    group by 1
),

-- Aggregating payments per order
order_payments_agg as (
    select
        order_id,
        sum(payment_value) as total_payment_value,
        string_agg(distinct payment_type, ', ') as payment_types
    from order_payments
    group by 1
),

final as (
    select
        o.order_id,
        o.customer_id,
        o.order_status,
        o.order_purchase_at,
        o.order_approved_at,
        o.order_delivered_carrier_at,
        o.order_delivered_customer_at,
        o.order_estimated_delivery_at,
        
        -- Metrics from items
        coalesce(i.total_items, 0) as number_of_items,
        coalesce(i.total_item_value, 0) as item_value,
        coalesce(i.total_freight_value, 0) as freight_value,
        
        -- Metrics from payments
        coalesce(p.total_payment_value, 0) as total_amount,
        p.payment_types,
        
        -- Calculated fields
        (o.order_delivered_customer_at - o.order_purchase_at) as delivery_time_interval,
        case 
            when o.order_delivered_customer_at > o.order_estimated_delivery_at then true 
            else false 
        end as is_delayed
        
    from orders o
    left join order_items_agg i on o.order_id = i.order_id
    left join order_payments_agg p on o.order_id = p.order_id
)

select * from final
    );
  
  
[0m21:29:46.686578 [debug] [Thread-4 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    
    

    create  table
      "olist"."main_marts"."dim_products__dbt_tmp"
  
    as (
      with products as (
    select * from "olist"."main_staging"."stg_products"
),

category_translation as (
    select * from "olist"."main_staging"."stg_product_category_translation"
),

final as (
    select
        p.product_id,
        p.product_category_name,
        t.product_category_name_english,
        
        -- Coalesce english name if available, otherwise fallback to original
        coalesce(t.product_category_name_english, p.product_category_name) as category_name,
        
        p.product_name_length,
        p.product_description_length,
        p.product_photos_qty,
        p.product_weight_g,
        p.product_length_cm,
        p.product_height_cm,
        p.product_width_cm
    from products p
    left join category_translation t 
        on p.product_category_name = t.product_category_name
)

select * from final
    );
  
  
[0m21:29:46.686578 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:29:46.686578 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */
alter view "olist"."main_staging"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m21:29:46.686578 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.695125 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:29:46.696134 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */
alter view "olist"."main_staging"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m21:29:46.697691 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.698586 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: COMMIT
[0m21:29:46.698586 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:29:46.698586 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: COMMIT
[0m21:29:46.719931 [debug] [Thread-4 (]: SQL status: OK in 0.029 seconds
[0m21:29:46.729446 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:29:46.730449 [debug] [Thread-4 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_products'
  
[0m21:29:46.736464 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m21:29:46.737473 [debug] [Thread-3 (]: SQL status: OK in 0.035 seconds
[0m21:29:46.739473 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:29:46.743584 [debug] [Thread-3 (]: Using duckdb connection "model.olist_analytics.stg_sellers"
[0m21:29:46.745596 [debug] [Thread-4 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_products'
  
[0m21:29:46.746591 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */

      drop view if exists "olist"."main_staging"."stg_sellers__dbt_backup" cascade
    
[0m21:29:46.749583 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.750615 [debug] [Thread-3 (]: On model.olist_analytics.stg_sellers: Close
[0m21:29:46.751907 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B7087850>]}
[0m21:29:46.751907 [info ] [Thread-3 (]: 9 of 12 OK created sql view model main_staging.stg_sellers ..................... [[32mOK[0m in 0.13s]
[0m21:29:46.753066 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m21:29:46.754067 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m21:29:46.755065 [debug] [Thread-3 (]: Finished running node model.olist_analytics.stg_sellers
[0m21:29:46.756067 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:29:46.759957 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:29:46.759957 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_customers'
  
[0m21:29:46.761967 [debug] [Thread-4 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */
alter table "olist"."main_marts"."dim_products" rename to "dim_products__dbt_backup"
[0m21:29:46.762963 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.767482 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:29:46.768375 [debug] [Thread-4 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */
alter table "olist"."main_marts"."dim_products__dbt_tmp" rename to "dim_products"
[0m21:29:46.770407 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m21:29:46.770407 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.771405 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:29:46.776410 [debug] [Thread-4 (]: On model.olist_analytics.dim_products: COMMIT
[0m21:29:46.777408 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'dim_customers'
  
[0m21:29:46.778411 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:29:46.779408 [debug] [Thread-4 (]: On model.olist_analytics.dim_products: COMMIT
[0m21:29:46.780407 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.784486 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:29:46.784486 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */
alter table "olist"."main_marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m21:29:46.785493 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.789011 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:29:46.790010 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */
alter table "olist"."main_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m21:29:46.790010 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.792010 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: COMMIT
[0m21:29:46.792010 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:29:46.793011 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: COMMIT
[0m21:29:46.797013 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m21:29:46.799019 [debug] [Thread-4 (]: Using duckdb connection "model.olist_analytics.dim_products"
[0m21:29:46.800016 [debug] [Thread-4 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

      drop table if exists "olist"."main_marts"."dim_products__dbt_backup" cascade
    
[0m21:29:46.820732 [debug] [Thread-2 (]: SQL status: OK in 0.027 seconds
[0m21:29:46.820732 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m21:29:46.822738 [debug] [Thread-2 (]: Using duckdb connection "model.olist_analytics.dim_customers"
[0m21:29:46.824764 [debug] [Thread-4 (]: On model.olist_analytics.dim_products: Close
[0m21:29:46.825732 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

      drop table if exists "olist"."main_marts"."dim_customers__dbt_backup" cascade
    
[0m21:29:46.825732 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B7A7A750>]}
[0m21:29:46.826731 [info ] [Thread-4 (]: 12 of 12 OK created sql table model main_marts.dim_products .................... [[32mOK[0m in 0.19s]
[0m21:29:46.827688 [debug] [Thread-4 (]: Finished running node model.olist_analytics.dim_products
[0m21:29:46.828769 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:29:46.830537 [debug] [Thread-2 (]: On model.olist_analytics.dim_customers: Close
[0m21:29:46.831043 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B71D8810>]}
[0m21:29:46.832049 [info ] [Thread-2 (]: 10 of 12 OK created sql table model main_marts.dim_customers ................... [[32mOK[0m in 0.20s]
[0m21:29:46.833049 [debug] [Thread-2 (]: Finished running node model.olist_analytics.dim_customers
[0m21:29:46.853493 [debug] [Thread-1 (]: SQL status: OK in 0.163 seconds
[0m21:29:46.854532 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:29:46.855037 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_orders'
  
[0m21:29:46.855037 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:46.855037 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:29:46.855037 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_orders'
  
[0m21:29:46.855037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.860172 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:29:46.861060 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */
alter table "olist"."main_marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m21:29:46.862066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.864067 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:29:46.865573 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */
alter table "olist"."main_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m21:29:46.865573 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:46.867581 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: COMMIT
[0m21:29:46.867581 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:29:46.868580 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: COMMIT
[0m21:29:46.901134 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m21:29:46.904100 [debug] [Thread-1 (]: Using duckdb connection "model.olist_analytics.fct_orders"
[0m21:29:46.905105 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

      drop table if exists "olist"."main_marts"."fct_orders__dbt_backup" cascade
    
[0m21:29:47.123347 [debug] [Thread-1 (]: SQL status: OK in 0.218 seconds
[0m21:29:47.125365 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: Close
[0m21:29:47.125365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81cb620f-da39-433a-ad60-fe86263780f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B8E6DD10>]}
[0m21:29:47.125365 [info ] [Thread-1 (]: 11 of 12 OK created sql table model main_marts.fct_orders ...................... [[32mOK[0m in 0.49s]
[0m21:29:47.126884 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_orders
[0m21:29:47.128531 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:47.128531 [debug] [MainThread]: On master: BEGIN
[0m21:29:47.128531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:47.128531 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:29:47.128531 [debug] [MainThread]: On master: COMMIT
[0m21:29:47.128531 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:47.128531 [debug] [MainThread]: On master: COMMIT
[0m21:29:47.128531 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:29:47.128531 [debug] [MainThread]: On master: Close
[0m21:29:47.128531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:47.128531 [debug] [MainThread]: Connection 'create_olist_main_marts' was properly closed.
[0m21:29:47.133947 [debug] [MainThread]: Connection 'create_olist_main_staging' was properly closed.
[0m21:29:47.133947 [debug] [MainThread]: Connection 'list_olist_main_staging' was properly closed.
[0m21:29:47.133947 [debug] [MainThread]: Connection 'list_olist_main_marts' was properly closed.
[0m21:29:47.133947 [debug] [MainThread]: Connection 'model.olist_analytics.fct_orders' was properly closed.
[0m21:29:47.133947 [debug] [MainThread]: Connection 'model.olist_analytics.dim_customers' was properly closed.
[0m21:29:47.133947 [debug] [MainThread]: Connection 'model.olist_analytics.stg_sellers' was properly closed.
[0m21:29:47.133947 [debug] [MainThread]: Connection 'model.olist_analytics.dim_products' was properly closed.
[0m21:29:47.133947 [info ] [MainThread]: 
[0m21:29:47.133947 [info ] [MainThread]: Finished running 3 table models, 9 view models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m21:29:47.137845 [debug] [MainThread]: Command end result
[0m21:29:47.161286 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:29:47.164418 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:29:47.165425 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\run_results.json
[0m21:29:47.165425 [info ] [MainThread]: 
[0m21:29:47.165425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:47.165425 [info ] [MainThread]: 
[0m21:29:47.165425 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m21:29:47.165425 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:47.165425 after 1.75 seconds
[0m21:29:47.165425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B6057F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B6057B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266B5D71690>]}
[0m21:29:47.165425 [debug] [MainThread]: Flushing usage events
[0m21:29:48.647029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:50.115450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296ABEDF550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296ABF12CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296ABEDF810>]}


============================== 21:29:50.115450 | 842ca3b4-0eb5-4423-99a7-6abdfb4790b7 ==============================
[0m21:29:50.115450 [info ] [MainThread]: Running with dbt=1.11.5
[0m21:29:50.115450 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\E.Gagan\\OneDrive\\Documents\\DATA ENGINEERING\\dbt_project\\logs'}
[0m21:29:50.290905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '842ca3b4-0eb5-4423-99a7-6abdfb4790b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296ABEFAA10>]}
[0m21:29:50.337897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '842ca3b4-0eb5-4423-99a7-6abdfb4790b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296A86F4890>]}
[0m21:29:50.338880 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:29:50.516717 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m21:29:50.616585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:50.617574 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:29:50.617574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:50.651351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '842ca3b4-0eb5-4423-99a7-6abdfb4790b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296AD4CEE10>]}
[0m21:29:50.716541 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:29:50.718904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:29:50.777958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '842ca3b4-0eb5-4423-99a7-6abdfb4790b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296AD41F090>]}
[0m21:29:50.779029 [info ] [MainThread]: Found 12 models, 25 data tests, 9 sources, 586 macros
[0m21:29:50.779029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '842ca3b4-0eb5-4423-99a7-6abdfb4790b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296AD5C8650>]}
[0m21:29:50.781125 [info ] [MainThread]: 
[0m21:29:50.782122 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:29:50.782122 [info ] [MainThread]: 
[0m21:29:50.783122 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:29:50.787220 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_marts'
[0m21:29:50.792228 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_main_staging'
[0m21:29:50.836548 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:29:50.836548 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:29:50.836548 [debug] [ThreadPool]: On list_olist_main_marts: BEGIN
[0m21:29:50.836548 [debug] [ThreadPool]: On list_olist_main_staging: BEGIN
[0m21:29:50.836548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:50.836548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:50.845919 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:29:50.845919 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:29:50.845919 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_marts"
[0m21:29:50.845919 [debug] [ThreadPool]: Using duckdb connection "list_olist_main_staging"
[0m21:29:50.845919 [debug] [ThreadPool]: On list_olist_main_marts: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_marts"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'olist'
  
[0m21:29:50.845919 [debug] [ThreadPool]: On list_olist_main_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_main_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'olist'
  
[0m21:29:50.864868 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:29:50.865379 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:29:50.866322 [debug] [ThreadPool]: On list_olist_main_staging: ROLLBACK
[0m21:29:50.867356 [debug] [ThreadPool]: On list_olist_main_marts: ROLLBACK
[0m21:29:50.868361 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_staging'
[0m21:29:50.868361 [debug] [ThreadPool]: On list_olist_main_staging: Close
[0m21:29:50.869366 [debug] [ThreadPool]: Failed to rollback 'list_olist_main_marts'
[0m21:29:50.870671 [debug] [ThreadPool]: On list_olist_main_marts: Close
[0m21:29:50.871682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '842ca3b4-0eb5-4423-99a7-6abdfb4790b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296ABF292D0>]}
[0m21:29:50.871682 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:50.871682 [debug] [MainThread]: On master: BEGIN
[0m21:29:50.872681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:50.872681 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:29:50.872681 [debug] [MainThread]: On master: COMMIT
[0m21:29:50.873698 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:50.873698 [debug] [MainThread]: On master: COMMIT
[0m21:29:50.873698 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:29:50.874681 [debug] [MainThread]: On master: Close
[0m21:29:50.878778 [debug] [Thread-1 (]: Began running node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:29:50.878778 [debug] [Thread-2 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:29:50.879682 [debug] [Thread-3 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:29:50.879682 [debug] [Thread-4 (]: Began running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:29:50.879682 [info ] [Thread-1 (]: 1 of 25 START test accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m21:29:50.880687 [info ] [Thread-2 (]: 2 of 25 START test dbt_utils_expression_is_true_fct_orders_item_value___0 ...... [RUN]
[0m21:29:50.880687 [info ] [Thread-3 (]: 3 of 25 START test dbt_utils_expression_is_true_stg_order_items_price___0 ...... [RUN]
[0m21:29:50.881682 [info ] [Thread-4 (]: 4 of 25 START test dbt_utils_expression_is_true_stg_order_payments_payment_value___0  [RUN]
[0m21:29:50.881682 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460'
[0m21:29:50.882682 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655'
[0m21:29:50.882682 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09'
[0m21:29:50.882682 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81'
[0m21:29:50.882682 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:29:50.884219 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:29:50.884219 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:29:50.884219 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:29:50.898631 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:29:50.901614 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:29:50.907457 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:29:50.912330 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:29:50.912330 [debug] [Thread-1 (]: Began executing node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:29:50.915124 [debug] [Thread-2 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:29:50.921658 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:29:50.927027 [debug] [Thread-3 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:29:50.927607 [debug] [Thread-4 (]: Began executing node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:29:50.929715 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:29:50.931576 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:29:50.934111 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:29:50.934111 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:29:50.934111 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:29:50.936760 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:29:50.936760 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: BEGIN
[0m21:29:50.936760 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: BEGIN
[0m21:29:50.936760 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:29:50.936760 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: BEGIN
[0m21:29:50.936760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:29:50.936760 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:29:50.936760 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: BEGIN
[0m21:29:50.936760 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:29:50.936760 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:50.936760 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:29:50.936760 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:29:50.936760 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:29:50.936760 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m21:29:50.936760 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"
[0m21:29:50.936760 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"
[0m21:29:50.936760 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:29:50.936760 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "olist"."main_staging"."stg_orders"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
      
    ) dbt_internal_test
[0m21:29:50.943649 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_marts"."fct_orders"

where not(item_value >= 0)


  
  
      
    ) dbt_internal_test
[0m21:29:50.944657 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_staging"."stg_order_items"

where not(price >= 0)


  
  
      
    ) dbt_internal_test
[0m21:29:50.944657 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"
[0m21:29:50.946162 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "olist"."main_staging"."stg_order_payments"

where not(payment_value >= 0)


  
  
      
    ) dbt_internal_test
[0m21:29:50.946162 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:29:50.946162 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:50.950427 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: ROLLBACK
[0m21:29:50.950427 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:29:50.950427 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:29:50.952414 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: ROLLBACK
[0m21:29:50.952648 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655'
[0m21:29:50.953660 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: ROLLBACK
[0m21:29:50.954657 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: ROLLBACK
[0m21:29:50.954657 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09'
[0m21:29:50.955657 [debug] [Thread-2 (]: On test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655: Close
[0m21:29:50.955657 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460'
[0m21:29:50.956658 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81'
[0m21:29:50.956658 [debug] [Thread-3 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09: Close
[0m21:29:50.957664 [debug] [Thread-1 (]: On test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: Close
[0m21:29:50.956658 [info ] [Thread-2 (]: 2 of 25 PASS dbt_utils_expression_is_true_fct_orders_item_value___0 ............ [[32mPASS[0m in 0.07s]
[0m21:29:50.957664 [debug] [Thread-4 (]: On test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81: Close
[0m21:29:50.957664 [info ] [Thread-3 (]: 3 of 25 PASS dbt_utils_expression_is_true_stg_order_items_price___0 ............ [[32mPASS[0m in 0.07s]
[0m21:29:50.959168 [info ] [Thread-1 (]: 1 of 25 PASS accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 0.08s]
[0m21:29:50.959897 [debug] [Thread-2 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655
[0m21:29:50.960905 [debug] [Thread-3 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09
[0m21:29:50.960905 [info ] [Thread-4 (]: 4 of 25 PASS dbt_utils_expression_is_true_stg_order_payments_payment_value___0 . [[32mPASS[0m in 0.08s]
[0m21:29:50.961906 [debug] [Thread-1 (]: Finished running node test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m21:29:50.961906 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:29:50.962906 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:29:50.962906 [debug] [Thread-4 (]: Finished running node test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81
[0m21:29:50.963906 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:29:50.963906 [info ] [Thread-2 (]: 5 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m21:29:50.965414 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:29:50.963906 [info ] [Thread-3 (]: 6 of 25 START test not_null_dim_products_product_id ............................ [RUN]
[0m21:29:50.965414 [info ] [Thread-1 (]: 7 of 25 START test not_null_fct_orders_customer_id ............................. [RUN]
[0m21:29:50.966424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_fct_orders_item_value___0.77db270655, now test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m21:29:50.966424 [info ] [Thread-4 (]: 8 of 25 START test not_null_fct_orders_order_id ................................ [RUN]
[0m21:29:50.966424 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_stg_order_items_price___0.b172e58a09, now test.olist_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m21:29:50.967425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460, now test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b)
[0m21:29:50.967425 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:29:50.968423 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.dbt_utils_expression_is_true_stg_order_payments_payment_value___0.7ab5186a81, now test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0)
[0m21:29:50.968423 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:29:50.968423 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:29:50.973470 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:29:50.973470 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:29:50.976447 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:29:50.981116 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:29:50.984958 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:29:50.984958 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:29:50.984958 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:29:50.986462 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:29:50.987467 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:29:50.987467 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:29:50.987467 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:29:50.987467 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:29:50.996440 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:29:50.996945 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:29:50.998082 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:29:50.998082 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:29:50.998082 [debug] [Thread-2 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m21:29:50.999082 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m21:29:50.999082 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:29:50.999082 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m21:29:51.000082 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:29:51.000082 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:51.000082 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m21:29:51.001103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.002082 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.002082 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.002082 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:29:51.002082 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.002082 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:29:51.002082 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m21:29:51.002082 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.002082 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:29:51.002082 [debug] [Thread-2 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_marts"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.002082 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "olist"."main_marts"."dim_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.002082 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m21:29:51.002082 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_marts"."fct_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.002082 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_marts"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.002082 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:29:51.002082 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:51.002082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:51.002082 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:29:51.002082 [debug] [Thread-2 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m21:29:51.010331 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m21:29:51.011339 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m21:29:51.012757 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m21:29:51.012757 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m21:29:51.012757 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_dim_products_product_id.c8aba288d1'
[0m21:29:51.012757 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b'
[0m21:29:51.012757 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0'
[0m21:29:51.015464 [debug] [Thread-2 (]: On test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m21:29:51.015464 [debug] [Thread-3 (]: On test.olist_analytics.not_null_dim_products_product_id.c8aba288d1: Close
[0m21:29:51.015464 [debug] [Thread-1 (]: On test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m21:29:51.015464 [debug] [Thread-4 (]: On test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0: Close
[0m21:29:51.015464 [info ] [Thread-2 (]: 5 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.05s]
[0m21:29:51.015464 [info ] [Thread-3 (]: 6 of 25 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.05s]
[0m21:29:51.015464 [info ] [Thread-1 (]: 7 of 25 PASS not_null_fct_orders_customer_id ................................... [[32mPASS[0m in 0.05s]
[0m21:29:51.015464 [info ] [Thread-4 (]: 8 of 25 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.05s]
[0m21:29:51.015464 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:29:51.015464 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_dim_products_product_id.c8aba288d1
[0m21:29:51.015464 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m21:29:51.015464 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m21:29:51.015464 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:29:51.015464 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:29:51.015464 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:29:51.015464 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:29:51.015464 [info ] [Thread-2 (]: 9 of 25 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m21:29:51.015464 [info ] [Thread-3 (]: 10 of 25 START test not_null_stg_customers_customer_unique_id .................. [RUN]
[0m21:29:51.015464 [info ] [Thread-1 (]: 11 of 25 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m21:29:51.023843 [info ] [Thread-4 (]: 12 of 25 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m21:29:51.023843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:29:51.024850 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_dim_products_product_id.c8aba288d1, now test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba)
[0m21:29:51.024850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_fct_orders_customer_id.16fe324f7b, now test.olist_analytics.not_null_stg_order_items_order_id.2063801f96)
[0m21:29:51.025869 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_fct_orders_order_id.4e687af8d0, now test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m21:29:51.025869 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:29:51.025869 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:29:51.026872 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:29:51.027442 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:29:51.029312 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:29:51.033845 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:29:51.036463 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:29:51.036463 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:29:51.036463 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:29:51.036463 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:29:51.036463 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:29:51.036463 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:29:51.043651 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:29:51.046245 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:29:51.049330 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:29:51.051349 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:29:51.051349 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:29:51.051349 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:29:51.051349 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:29:51.051349 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:29:51.051349 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:29:51.051349 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m21:29:51.051349 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m21:29:51.051349 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:29:51.051349 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m21:29:51.051349 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:51.051349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.051349 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:29:51.051349 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.051349 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.051349 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.051349 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.051349 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:29:51.051349 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"
[0m21:29:51.059003 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"
[0m21:29:51.059003 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m21:29:51.059598 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_staging"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.060279 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "olist"."main_staging"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.060279 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_order_items"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.061287 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from "olist"."main_staging"."stg_order_items"
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.062285 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:51.063234 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.063234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:51.063234 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m21:29:51.065250 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:29:51.065250 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:29:51.065250 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m21:29:51.065250 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba'
[0m21:29:51.065250 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m21:29:51.065250 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m21:29:51.065250 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_items_order_id.2063801f96'
[0m21:29:51.065250 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m21:29:51.065250 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m21:29:51.065250 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:29:51.065250 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_order_items_order_id.2063801f96: Close
[0m21:29:51.065250 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m21:29:51.065250 [info ] [Thread-3 (]: 10 of 25 PASS not_null_stg_customers_customer_unique_id ........................ [[32mPASS[0m in 0.04s]
[0m21:29:51.065250 [info ] [Thread-2 (]: 9 of 25 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.04s]
[0m21:29:51.065250 [info ] [Thread-1 (]: 11 of 25 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.04s]
[0m21:29:51.065250 [info ] [Thread-4 (]: 12 of 25 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.04s]
[0m21:29:51.065250 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba
[0m21:29:51.065250 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:29:51.065250 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_stg_order_items_order_id.2063801f96
[0m21:29:51.065250 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m21:29:51.065250 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:29:51.065250 [debug] [Thread-2 (]: Began running node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:29:51.065250 [debug] [Thread-1 (]: Began running node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:29:51.065250 [debug] [Thread-4 (]: Began running node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:29:51.076959 [info ] [Thread-3 (]: 13 of 25 START test not_null_stg_order_payments_order_id ....................... [RUN]
[0m21:29:51.077966 [info ] [Thread-2 (]: 14 of 25 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m21:29:51.077966 [info ] [Thread-1 (]: 15 of 25 START test not_null_stg_orders_order_id ............................... [RUN]
[0m21:29:51.079621 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_customers_customer_unique_id.7144461cba, now test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7)
[0m21:29:51.079621 [info ] [Thread-4 (]: 16 of 25 START test not_null_stg_products_product_id ........................... [RUN]
[0m21:29:51.080673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5)
[0m21:29:51.080673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_items_order_id.2063801f96, now test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:29:51.081672 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:29:51.081672 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.olist_analytics.not_null_stg_products_product_id.6373b0acf3)
[0m21:29:51.081672 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:29:51.082699 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:29:51.084729 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:29:51.084729 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:29:51.086763 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:29:51.086763 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:29:51.095615 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:29:51.096316 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:29:51.096731 [debug] [Thread-2 (]: Began executing node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:29:51.098758 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:29:51.100732 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:29:51.101731 [debug] [Thread-1 (]: Began executing node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:29:51.101731 [debug] [Thread-4 (]: Began executing node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:29:51.101731 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:29:51.101731 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:29:51.101731 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:29:51.101731 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:29:51.101731 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: BEGIN
[0m21:29:51.101731 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:29:51.108954 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m21:29:51.108954 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:51.108954 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:29:51.108954 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m21:29:51.110255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:29:51.110255 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.111262 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m21:29:51.111838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.113065 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:29:51.113065 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"
[0m21:29:51.114146 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:29:51.114146 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:29:51.115115 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:29:51.115115 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_order_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.115115 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.116204 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "olist"."main_staging"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.116204 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:29:51.117204 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m21:29:51.117204 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:51.117204 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "olist"."main_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.118204 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:29:51.118204 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "olist"."main_staging"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.118204 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: ROLLBACK
[0m21:29:51.118204 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m21:29:51.118204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:51.118204 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7'
[0m21:29:51.118204 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5'
[0m21:29:51.118204 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:29:51.118204 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m21:29:51.118204 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7: Close
[0m21:29:51.118204 [debug] [Thread-2 (]: On test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m21:29:51.118204 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m21:29:51.118204 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64'
[0m21:29:51.118204 [info ] [Thread-3 (]: 13 of 25 PASS not_null_stg_order_payments_order_id ............................. [[32mPASS[0m in 0.04s]
[0m21:29:51.118204 [info ] [Thread-2 (]: 14 of 25 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.04s]
[0m21:29:51.126899 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.not_null_stg_products_product_id.6373b0acf3'
[0m21:29:51.127906 [debug] [Thread-1 (]: On test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m21:29:51.128488 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7
[0m21:29:51.128488 [debug] [Thread-2 (]: Finished running node test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:29:51.129496 [debug] [Thread-4 (]: On test.olist_analytics.not_null_stg_products_product_id.6373b0acf3: Close
[0m21:29:51.129496 [info ] [Thread-1 (]: 15 of 25 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.05s]
[0m21:29:51.129496 [debug] [Thread-3 (]: Began running node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:29:51.129496 [debug] [Thread-2 (]: Began running node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:29:51.129496 [debug] [Thread-1 (]: Finished running node test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m21:29:51.129496 [info ] [Thread-4 (]: 16 of 25 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.05s]
[0m21:29:51.132944 [info ] [Thread-3 (]: 17 of 25 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m21:29:51.132944 [info ] [Thread-2 (]: 18 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m21:29:51.132944 [debug] [Thread-1 (]: Began running node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:29:51.133949 [debug] [Thread-4 (]: Finished running node test.olist_analytics.not_null_stg_products_product_id.6373b0acf3
[0m21:29:51.133949 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_order_payments_order_id.de5ce0ffc7, now test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315)
[0m21:29:51.134954 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_orders_customer_id.af79d5e4b5, now test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m21:29:51.134954 [info ] [Thread-1 (]: 19 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m21:29:51.134954 [debug] [Thread-4 (]: Began running node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:29:51.134954 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:29:51.136458 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:29:51.136458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m21:29:51.136458 [info ] [Thread-4 (]: 20 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m21:29:51.138465 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:29:51.146711 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:29:51.146711 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:29:51.148027 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_products_product_id.6373b0acf3, now test.olist_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m21:29:51.149004 [debug] [Thread-3 (]: Began executing node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:29:51.152019 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:29:51.152019 [debug] [Thread-2 (]: Began executing node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:29:51.152019 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:29:51.152019 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:29:51.152019 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:29:51.152019 [debug] [Thread-1 (]: Began executing node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:29:51.160916 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:29:51.162822 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:29:51.162822 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:29:51.164630 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:29:51.165630 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m21:29:51.165630 [debug] [Thread-2 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m21:29:51.165630 [debug] [Thread-4 (]: Began executing node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:29:51.165630 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:51.165630 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:29:51.165630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:29:51.165630 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:29:51.169992 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m21:29:51.169992 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:29:51.169992 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:29:51.169992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.169992 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:29:51.169992 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"
[0m21:29:51.169992 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m21:29:51.169992 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m21:29:51.169992 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.169992 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "olist"."main_staging"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.169992 [debug] [Thread-2 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "olist"."main_marts"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "olist"."main_marts"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.169992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:29:51.169992 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:29:51.169992 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:29:51.169992 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.169992 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:29:51.177928 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m21:29:51.177928 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m21:29:51.178513 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315'
[0m21:29:51.179521 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:29:51.179521 [debug] [Thread-3 (]: On test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m21:29:51.181776 [info ] [Thread-3 (]: 17 of 25 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.05s]
[0m21:29:51.181776 [debug] [Thread-3 (]: Finished running node test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315
[0m21:29:51.183781 [debug] [Thread-3 (]: Began running node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:29:51.184467 [info ] [Thread-3 (]: 21 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m21:29:51.184467 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.not_null_stg_sellers_seller_id.35d0bce315, now test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5)
[0m21:29:51.184467 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:29:51.188481 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:29:51.190489 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m21:29:51.190489 [debug] [Thread-3 (]: Began executing node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:29:51.190489 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m21:29:51.196992 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:29:51.197329 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m21:29:51.198365 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.unique_dim_products_product_id.ef7b2a9985'
[0m21:29:51.199364 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m21:29:51.200394 [debug] [Thread-4 (]: On test.olist_analytics.unique_dim_products_product_id.ef7b2a9985: Close
[0m21:29:51.200394 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:29:51.200394 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd'
[0m21:29:51.200394 [debug] [Thread-2 (]: SQL status: OK in 0.027 seconds
[0m21:29:51.200394 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m21:29:51.200394 [info ] [Thread-4 (]: 20 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.05s]
[0m21:29:51.200394 [debug] [Thread-1 (]: On test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m21:29:51.203766 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:51.203766 [debug] [Thread-4 (]: Finished running node test.olist_analytics.unique_dim_products_product_id.ef7b2a9985
[0m21:29:51.204772 [debug] [Thread-2 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m21:29:51.205791 [info ] [Thread-1 (]: 19 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.07s]
[0m21:29:51.205791 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:29:51.206773 [debug] [Thread-4 (]: Began running node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:29:51.206773 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4'
[0m21:29:51.207773 [debug] [Thread-1 (]: Finished running node test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:29:51.207773 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m21:29:51.207773 [info ] [Thread-4 (]: 22 of 25 START test unique_stg_customers_customer_id ........................... [RUN]
[0m21:29:51.209279 [debug] [Thread-2 (]: On test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m21:29:51.209279 [debug] [Thread-1 (]: Began running node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:29:51.209279 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "olist"."main_marts"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:29:51.210246 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_dim_products_product_id.ef7b2a9985, now test.olist_analytics.unique_stg_customers_customer_id.c7614daada)
[0m21:29:51.211255 [info ] [Thread-2 (]: 18 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.08s]
[0m21:29:51.211255 [info ] [Thread-1 (]: 23 of 25 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:29:51.212936 [debug] [Thread-4 (]: Began compiling node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:29:51.213993 [debug] [Thread-2 (]: Finished running node test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m21:29:51.213993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.olist_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m21:29:51.217506 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:29:51.218507 [debug] [Thread-2 (]: Began running node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:29:51.218507 [debug] [Thread-1 (]: Began compiling node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:29:51.223089 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:29:51.218507 [info ] [Thread-2 (]: 24 of 25 START test unique_stg_products_product_id ............................. [RUN]
[0m21:29:51.223089 [debug] [Thread-4 (]: Began executing node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:29:51.224087 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.olist_analytics.unique_stg_products_product_id.7d950a1467)
[0m21:29:51.227513 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:29:51.228521 [debug] [Thread-1 (]: Began executing node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:29:51.228521 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m21:29:51.229299 [debug] [Thread-2 (]: Began compiling node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:29:51.229299 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:29:51.229299 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:29:51.234029 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:29:51.234029 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m21:29:51.236674 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:29:51.236674 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:29:51.236674 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5'
[0m21:29:51.236674 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:29:51.236674 [debug] [Thread-2 (]: Began executing node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:29:51.236674 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m21:29:51.236674 [debug] [Thread-3 (]: On test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5: Close
[0m21:29:51.236674 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:29:51.236674 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:29:51.236674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.236674 [debug] [Thread-4 (]: Using duckdb connection "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"
[0m21:29:51.236674 [info ] [Thread-3 (]: 21 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.05s]
[0m21:29:51.244161 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:29:51.245172 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:29:51.245172 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:29:51.245172 [debug] [Thread-3 (]: Finished running node test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m21:29:51.246168 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: BEGIN
[0m21:29:51.249076 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:29:51.246546 [debug] [Thread-1 (]: Using duckdb connection "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m21:29:51.246546 [debug] [Thread-3 (]: Began running node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:29:51.249076 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:29:51.251090 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:29:51.253107 [debug] [Thread-2 (]: Using duckdb connection "test.olist_analytics.unique_stg_products_product_id.7d950a1467"
[0m21:29:51.251090 [info ] [Thread-3 (]: 25 of 25 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m21:29:51.253107 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:29:51.255119 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_analytics.unique_fct_orders_order_id.523ddb6ce5, now test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m21:29:51.255119 [debug] [Thread-3 (]: Began compiling node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:29:51.262827 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:29:51.263838 [debug] [Thread-3 (]: Began executing node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:29:51.267947 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:29:51.269959 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m21:29:51.271970 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m21:29:51.273979 [debug] [Thread-2 (]: Failed to rollback 'test.olist_analytics.unique_stg_products_product_id.7d950a1467'
[0m21:29:51.273979 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:29:51.276940 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m21:29:51.276940 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:51.273979 [debug] [Thread-2 (]: On test.olist_analytics.unique_stg_products_product_id.7d950a1467: Close
[0m21:29:51.280042 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:29:51.280042 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m21:29:51.282169 [info ] [Thread-2 (]: 24 of 25 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.06s]
[0m21:29:51.282169 [debug] [Thread-3 (]: Using duckdb connection "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m21:29:51.285685 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:29:51.286892 [debug] [Thread-2 (]: Finished running node test.olist_analytics.unique_stg_products_product_id.7d950a1467
[0m21:29:51.286892 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "olist"."main_staging"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:29:51.286892 [debug] [Thread-4 (]: Failed to rollback 'test.olist_analytics.unique_stg_customers_customer_id.c7614daada'
[0m21:29:51.286892 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m21:29:51.286892 [debug] [Thread-4 (]: On test.olist_analytics.unique_stg_customers_customer_id.c7614daada: Close
[0m21:29:51.286892 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m21:29:51.294138 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:29:51.295273 [info ] [Thread-4 (]: 22 of 25 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.08s]
[0m21:29:51.295273 [debug] [Thread-1 (]: Failed to rollback 'test.olist_analytics.unique_stg_orders_order_id.e3b841c71a'
[0m21:29:51.297292 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m21:29:51.297292 [debug] [Thread-4 (]: Finished running node test.olist_analytics.unique_stg_customers_customer_id.c7614daada
[0m21:29:51.298277 [debug] [Thread-1 (]: On test.olist_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m21:29:51.298277 [debug] [Thread-3 (]: Failed to rollback 'test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8'
[0m21:29:51.299277 [info ] [Thread-1 (]: 23 of 25 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.09s]
[0m21:29:51.300275 [debug] [Thread-3 (]: On test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m21:29:51.301276 [debug] [Thread-1 (]: Finished running node test.olist_analytics.unique_stg_orders_order_id.e3b841c71a
[0m21:29:51.302277 [info ] [Thread-3 (]: 25 of 25 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.05s]
[0m21:29:51.303276 [debug] [Thread-3 (]: Finished running node test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8
[0m21:29:51.304716 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:51.304716 [debug] [MainThread]: On master: BEGIN
[0m21:29:51.304716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:51.307254 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:29:51.307254 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.307254 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:51.309263 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.310225 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:29:51.310225 [debug] [MainThread]: On master: Close
[0m21:29:51.311232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:51.311232 [debug] [MainThread]: Connection 'list_olist_main_marts' was properly closed.
[0m21:29:51.311232 [debug] [MainThread]: Connection 'list_olist_main_staging' was properly closed.
[0m21:29:51.312232 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m21:29:51.312908 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m21:29:51.312908 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m21:29:51.312908 [debug] [MainThread]: Connection 'test.olist_analytics.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m21:29:51.312908 [info ] [MainThread]: 
[0m21:29:51.314031 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m21:29:51.316593 [debug] [MainThread]: Command end result
[0m21:29:51.336671 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\manifest.json
[0m21:29:51.336671 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\semantic_manifest.json
[0m21:29:51.346344 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\E.Gagan\OneDrive\Documents\DATA ENGINEERING\dbt_project\target\run_results.json
[0m21:29:51.346344 [info ] [MainThread]: 
[0m21:29:51.346344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:51.346344 [info ] [MainThread]: 
[0m21:29:51.346344 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m21:29:51.346344 [debug] [MainThread]: Command `dbt test` succeeded at 21:29:51.346344 after 1.29 seconds
[0m21:29:51.346344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296ABF67B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296ABF67A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296ABC858D0>]}
[0m21:29:51.346344 [debug] [MainThread]: Flushing usage events
[0m21:29:53.076931 [debug] [MainThread]: An error was encountered while trying to flush usage events
